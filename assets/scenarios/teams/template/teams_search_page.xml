<?xml version="1.0"?>
<pnp:Provisioning xmlns:pnp="http://schemas.dev.office.com/PnP/2020/02/ProvisioningSchema">
  <pnp:Preferences Author="aequos Team" Version="1.0" Generator="Human being :-)">
      <pnp:Parameters>
          <pnp:Parameter Key="SchemaExtensionName"></pnp:Parameter>
          <pnp:Parameter Key="GroupTypeTermSetPath"></pnp:Parameter>
          <pnp:Parameter Key="GroupDepartmentTermSetPath"></pnp:Parameter>
      </pnp:Parameters>
  </pnp:Preferences>
  <pnp:Templates ID="CONTAINER-TEMPLATE-MDV">
    <pnp:ProvisioningTemplate ID="MDV-TEAMS-SEARCHPAGE-TEMPLATE" Version="1" BaseSiteTemplate="SITEPAGEPUBLISHING#0" Scope="RootSite">
      <pnp:ClientSidePages>
        <pnp:ClientSidePage PromoteAsNewsArticle="false" PromoteAsTemplate="false" Overwrite="true" Layout="Home" EnableComments="false" Title="aequos MDV Teams search center DEMO" ThumbnailUrl="" PageName="teams-search-mdv.aspx">
          <pnp:Header Type="Default" LayoutType="FullWidthImage" TextAlignment="Center" ShowTopicHeader="false" ShowPublishDate="false" TopicHeader="" AlternativeText="" Authors="[]" AuthorByLine="[]" AuthorByLineId="-1" />
          <pnp:Sections>
            <pnp:Section Order="1" Type="OneColumnVerticalSection" VerticalSectionEmphasis="Soft">
              <pnp:Controls>
                <pnp:CanvasControl WebPartType="Custom" JsonControlData="{&quot;id&quot;: &quot;544c1372-7e5a-49ec-8db6-812f76c375f2&quot;, &quot;instanceId&quot;: &quot;d25cdd6b-2e4a-4d55-9e18-a6edb399685c&quot;, &quot;title&quot;: &quot;aequos - Search Box&quot;, &quot;description&quot;: &quot;Allows users to search data source results using query text&quot;, &quot;dataVersion&quot;: &quot;1.0&quot;, &quot;properties&quot;: {&quot;licensingEndPointUrl&quot;:&quot;https://aequosmdvdev.azurewebsites.net/api/licenses/check&quot;,&quot;documentationLink&quot;:&quot;https://aequos-solutions.github.io/modern-data-visualizer&quot;,&quot;openBehavior&quot;:&quot;Self&quot;,&quot;queryPathBehavior&quot;:&quot;URLFragment&quot;,&quot;suggestionProviderConfiguration&quot;:[{&quot;key&quot;:&quot;SharePointStaticSuggestions&quot;,&quot;description&quot;:&quot;Retrieve SharePoint static user defined search suggestions&quot;,&quot;enabled&quot;:false,&quot;name&quot;:&quot;SharePoint Static search suggestions&quot;},{&quot;key&quot;:&quot;CustomSuggestionsProvider&quot;,&quot;description&quot;:&quot;A demo custom suggestions provider from the extensibility library&quot;,&quot;enabled&quot;:false,&quot;name&quot;:&quot;Custom Suggestions Provider&quot;}],&quot;numberOfSuggestionsPerGroup&quot;:10,&quot;providerProperties&quot;:{},&quot;extensibilityLibraryConfiguration&quot;:[{&quot;name&quot;:&quot;Default extensibility library&quot;,&quot;enabled&quot;:true,&quot;id&quot;:&quot;dc4f961b-dbe0-44b4-982d-5776bf99d015&quot;}]}, &quot;serverProcessedContent&quot;: {&quot;htmlStrings&quot;:{},&quot;searchablePlainTexts&quot;:{},&quot;imageSources&quot;:{},&quot;links&quot;:{}}, &quot;dynamicDataPaths&quot;: {}, &quot;dynamicDataValues&quot;: {&quot;queryText&quot;:&quot;&quot;}}" ControlId="544c1372-7e5a-49ec-8db6-812f76c375f2" Order="1" Column="1" />
                <pnp:CanvasControl WebPartType="Custom" JsonControlData="{&quot;id&quot;: &quot;544c1372-42df-47c3-94d6-017428cd2baf&quot;, &quot;instanceId&quot;: &quot;6a90154b-74fd-4cb5-802b-4e00c3113c9b&quot;, &quot;title&quot;: &quot;aequos - Data Visualizer&quot;, &quot;description&quot;: &quot;Display data from multiple sources using customizable templates&quot;, &quot;dataVersion&quot;: &quot;1.0&quot;, &quot;properties&quot;: {&quot;licensingEndPointUrl&quot;:&quot;https://aequosmdvdev.azurewebsites.net/api/licenses/check&quot;,&quot;documentationLink&quot;:&quot;https://aequos-solutions.github.io/modern-data-visualizer&quot;,&quot;selectedLayoutKey&quot;:&quot;Teams&quot;,&quot;resultTypes&quot;:[],&quot;dataSourceProperties&quot;:{&quot;clientType&quot;:&quot;MSGraph&quot;,&quot;httpBody&quot;:{},&quot;httpMethod&quot;:&quot;GET&quot;,&quot;httpHeaders&quot;:{&quot;Content-Type&quot;:&quot;application/json;odata=verbose&quot;,&quot;Accept&quot;:&quot;application/json&quot;,&quot;ConsistencyLevel&quot;:&quot;eventual&quot;},&quot;url&quot;:&quot;https://graph.microsoft.com/beta/me/memberOf/$/microsoft.graph.group?$top={itemsCountPerPage}&amp;$count=true&amp;$select={parameter:SchemaExtensionName},id,displayName,description,visibility${if(empty(\&quot;{inputQueryText}\&quot;),'','&amp;$search=\&quot;displayName:{inputQueryText}\&quot; OR \&quot;description:{inputQueryText}\&quot;')}${if(empty('{filters}'),\&quot;&amp;$filter=resourceProvisioningOptions/Any(x:x eq 'Team')\&quot;,concat(\&quot;&amp;$filter=resourceProvisioningOptions/Any(x:x eq 'Team') and \&quot;, buildOdataFilterCondition(json('{filters}'))))}\n&quot;,&quot;useServerSidePaging&quot;:true,&quot;pagingBehavior&quot;:&quot;dynamic&quot;},&quot;queryTextSource&quot;:1,&quot;layoutProperties&quot;:{&quot;metadataFields&quot;:[&quot;{parameter:SchemaExtensionName}.groupDepartmentAsText&quot;,&quot;{parameter:SchemaExtensionName}.groupTypeAsText&quot;]},&quot;showSelectedFilters&quot;:true,&quot;showResultsCount&quot;:true,&quot;showBlankIfNoResult&quot;:false,&quot;useMicrosoftGraphToolkit&quot;:false,&quot;extensibilityLibraryConfiguration&quot;:[{&quot;name&quot;:&quot;Default extensibility library&quot;,&quot;enabled&quot;:true,&quot;id&quot;:&quot;dc4f961b-dbe0-44b4-982d-5776bf99d015&quot;}],&quot;useVerticals&quot;:false,&quot;selectedVerticalKeys&quot;:[],&quot;doNotFetchDataOnPageLoad&quot;:false,&quot;paging&quot;:{&quot;itemsCountPerPage&quot;:10,&quot;pagingRange&quot;:5,&quot;showPaging&quot;:true,&quot;hideDisabled&quot;:true,&quot;hideFirstLastPages&quot;:false,&quot;hideNavigation&quot;:false,&quot;useNextLinks&quot;:false},&quot;caching&quot;:{&quot;enableCaching&quot;:false},&quot;seeAllLinkProps&quot;:{&quot;seeAllLinkText&quot;:&quot;&quot;,&quot;seeAllLinkUrl&quot;:&quot;&quot;,&quot;showSeeAllLink&quot;:false},&quot;adaptiveCardsHostConfig&quot;:&quot;{\n\t\&quot;fontFamily\&quot;: \&quot;Segoe UI, Helvetica Neue, sans-serif\&quot;\n}&quot;,&quot;layoutTemplateType&quot;:&quot;Handlebars&quot;,&quot;dataSourceKey&quot;:&quot;OData&quot;,&quot;templateSlots&quot;:[{&quot;slotName&quot;:&quot;Title&quot;,&quot;slotField&quot;:&quot;displayName&quot;},{&quot;slotName&quot;:&quot;Path&quot;,&quot;slotField&quot;:&quot;scoredEmailAddresses.0.address&quot;},{&quot;slotName&quot;:&quot;Summary&quot;,&quot;slotField&quot;:&quot;&quot;},{&quot;slotName&quot;:&quot;FileType&quot;,&quot;slotField&quot;:&quot;&quot;},{&quot;slotName&quot;:&quot;PreviewImageUrl&quot;,&quot;slotField&quot;:&quot;&quot;},{&quot;slotName&quot;:&quot;PreviewUrl&quot;,&quot;slotField&quot;:&quot;&quot;},{&quot;slotName&quot;:&quot;Author&quot;,&quot;slotField&quot;:&quot;&quot;},{&quot;slotName&quot;:&quot;Tags&quot;,&quot;slotField&quot;:&quot;&quot;},{&quot;slotName&quot;:&quot;Date&quot;,&quot;slotField&quot;:&quot;&quot;},{&quot;slotName&quot;:&quot;SiteId&quot;,&quot;slotField&quot;:&quot;&quot;},{&quot;slotName&quot;:&quot;ListId&quot;,&quot;slotField&quot;:&quot;&quot;},{&quot;slotName&quot;:&quot;ItemId&quot;,&quot;slotField&quot;:&quot;&quot;},{&quot;slotName&quot;:&quot;IsFolder&quot;,&quot;slotField&quot;:&quot;&quot;},{&quot;slotName&quot;:&quot;PersonQuery&quot;,&quot;slotField&quot;:&quot;userPrincipalName&quot;},{&quot;slotName&quot;:&quot;UserDisplayName&quot;,&quot;slotField&quot;:&quot;displayName&quot;},{&quot;slotName&quot;:&quot;UserEmail&quot;,&quot;slotField&quot;:&quot;scoredEmailAddresses.0.address&quot;},{&quot;slotName&quot;:&quot;TeamId&quot;,&quot;slotField&quot;:&quot;id&quot;},{&quot;slotName&quot;:&quot;TeamVisibility&quot;,&quot;slotField&quot;:&quot;visibility&quot;}],&quot;httpHeaders&quot;:&quot;{\r\n    \&quot;Content-Type\&quot;: \&quot;application/json;odata=verbose\&quot;,\r\n    \&quot;Accept\&quot;: \&quot;application/json\&quot;,\r\n    \&quot;ConsistencyLevel\&quot;: \&quot;eventual\&quot;\r\n}\r\n&quot;,&quot;useFilters&quot;:true,&quot;filtersDataSourceReference&quot;:&quot;WebPart.544c1372-fb1d-4e96-bc1e-31fd66979667.1a07a2d7-f287-444e-83fd-b26ece09e1fd:aequosDataFiltersWebPart&quot;,&quot;useInputQueryText&quot;:true,&quot;isFullWidth&quot;:false}, &quot;serverProcessedContent&quot;: {&quot;htmlStrings&quot;:{},&quot;searchablePlainTexts&quot;:{},&quot;imageSources&quot;:{},&quot;links&quot;:{}}, &quot;dynamicDataPaths&quot;: {&quot;queryText&quot;:&quot;WebPart.544c1372-7e5a-49ec-8db6-812f76c375f2.d25cdd6b-2e4a-4d55-9e18-a6edb399685c:aequosSearchBoxWebPart&quot;}, &quot;dynamicDataValues&quot;: {&quot;filtersData&quot;:{}}}" ControlId="544c1372-42df-47c3-94d6-017428cd2baf" Order="2" Column="1" />
                <pnp:CanvasControl WebPartType="Custom" JsonControlData="{&quot;id&quot;: &quot;544c1372-fb1d-4e96-bc1e-31fd66979667&quot;, &quot;instanceId&quot;: &quot;1a07a2d7-f287-444e-83fd-b26ece09e1fd&quot;, &quot;title&quot;: &quot;aequos - Data Filters&quot;, &quot;description&quot;: &quot;Filter results from the Data Visualizer Web Part&quot;, &quot;dataVersion&quot;: &quot;1.0&quot;, &quot;properties&quot;: {&quot;licensingEndPointUrl&quot;:&quot;https://aequosmdvdev.azurewebsites.net/api/licenses/check&quot;,&quot;documentationLink&quot;:&quot;https://aequos-solutions.github.io/modern-data-visualizer&quot;,&quot;selectedLayoutKey&quot;:&quot;Vertical&quot;,&quot;inlineTemplateContent&quot;:&quot;&quot;,&quot;filterOperator&quot;:&quot;or&quot;,&quot;layoutProperties&quot;:{},&quot;dataResultsDataSourceReferences&quot;:[&quot;WebPart.544c1372-42df-47c3-94d6-017428cd2baf.6a90154b-74fd-4cb5-802b-4e00c3113c9b:aequosDataVisualizerWebPart&quot;],&quot;filtersConfiguration&quot;:[{&quot;uniqueId&quot;:&quot;f9d629a5-4c95-4b07-8b00-4a0085566b63&quot;,&quot;displayValue&quot;:&quot;Group type&quot;,&quot;filterName&quot;:&quot;{parameter:SchemaExtensionName}/groupType&quot;,&quot;refinerCount&quot;:null,&quot;selectedTemplate&quot;:&quot;TaxonomyPickerFilterTemplate&quot;,&quot;taxonomyItemIds&quot;:[&quot;{termsetid:{parameter:GroupTypeTermSetPath}}&quot;],&quot;type&quot;:&quot;StaticFilter&quot;,&quot;expandByDefault&quot;:true,&quot;showCount&quot;:null,&quot;isMulti&quot;:false,&quot;operator&quot;:&quot;and&quot;,&quot;sortBy&quot;:&quot;ByName&quot;,&quot;sortDirection&quot;:&quot;Ascending&quot;,&quot;selectionBehavior&quot;:&quot;ItemOnly&quot;,&quot;taxonomyPageSize&quot;:10,&quot;taxonomyShowSearchBox&quot;:true,&quot;taxonomyItemType&quot;:&quot;TermSet&quot;,&quot;sortIdx&quot;:1},{&quot;uniqueId&quot;:&quot;4189ca4f-747d-43fc-a42e-dcade479ad6c&quot;,&quot;displayValue&quot;:&quot;Department&quot;,&quot;filterName&quot;:&quot;{parameter:SchemaExtensionName}/groupDepartment&quot;,&quot;refinerCount&quot;:null,&quot;selectedTemplate&quot;:&quot;TaxonomyPickerFilterTemplate&quot;,&quot;taxonomyItemIds&quot;:[&quot;{termsetid:{parameter:GroupDepartmentTermSetPath}}&quot;],&quot;type&quot;:&quot;StaticFilter&quot;,&quot;expandByDefault&quot;:true,&quot;showCount&quot;:null,&quot;isMulti&quot;:false,&quot;operator&quot;:&quot;and&quot;,&quot;sortBy&quot;:&quot;ByName&quot;,&quot;sortDirection&quot;:&quot;Ascending&quot;,&quot;selectionBehavior&quot;:&quot;ItemOnly&quot;,&quot;taxonomyPageSize&quot;:10,&quot;taxonomyShowSearchBox&quot;:true,&quot;taxonomyItemType&quot;:&quot;TermSet&quot;,&quot;sortIdx&quot;:2}]}, &quot;serverProcessedContent&quot;: {&quot;htmlStrings&quot;:{},&quot;searchablePlainTexts&quot;:{},&quot;imageSources&quot;:{},&quot;links&quot;:{}}, &quot;dynamicDataPaths&quot;: {}, &quot;dynamicDataValues&quot;: {}}" ControlId="544c1372-fb1d-4e96-bc1e-31fd66979667" Order="1" Column="2" />
              </pnp:Controls>
            </pnp:Section>
            <pnp:Section Order="2" Type="OneColumn" />
          </pnp:Sections>
        </pnp:ClientSidePage>
      </pnp:ClientSidePages>
    </pnp:ProvisioningTemplate>
  </pnp:Templates>
</pnp:Provisioning>