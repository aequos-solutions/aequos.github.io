{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Introduction","text":""},{"location":"#aequos-modern-data-visualizer-solution","title":"aequos Modern Data Visualizer solution","text":"<p>The 'Modern Data Visualizer' solution is a set of SharePoint Online modern Web Parts allowing SharePoint super users, webmasters and developers to create highly flexible and personalized data viewing and filtering experiences in minutes.</p> <p>It is the enhanced product version of the well known \"Pattern &amp; Practices Modern Search\" open-source solution that we also created.</p> <p>Info</p> <p>Want to know what are the differences between the commercial and open source solutions to help you decide which one is the right for you? Take a look at our detailled features comparison table.</p> <p>Don't be wrong: we still continue to invest time and support for the open-source solution. If it suits your current requirements, feel free to go with it. We will never push someone to purchase the licensed solution.</p>"},{"location":"#whats-included","title":"What's included?","text":"<p>The solution includes the following Web Parts:</p> Component Description Data Visualizer Retrieve data from a data source and render them in a specific layout. Data Filters Filter and refine data displayed in 'Data Visualizer' Web Parts. Data Verticals Browse data as silos (i.e. tabs) from multiple data sources. Search box Let users enter free text queries sent to 'Data Visualizer' Web Parts. Group Metadata Editor Allows owners to classify their team/ Microsoft 365 group based on Microsoft Graph schema extensions. <p>Overview video: let's build a complete search center</p> <p>Here is a overview video on how to build a complete search center in minutes using all available Web Parts whithin a SharePoint page including multiple data sources.</p>"},{"location":"#supported-browsers","title":"Supported browsers","text":"<p>Here is the list of supported browsers:</p> <ul> <li>Chrome</li> <li>Firefox</li> <li>Edge</li> <li>Edge Chromium</li> <li>Brave</li> <li>Safari</li> </ul> <p>We don't support Internet Explorer 11. We think there are plenty of other options for enteprise scenarios in the market. Maybe it's time to move on. For developers, it represents an huge ammount of time to make the solution compatible for a very low benefit. Hope you understand, ain't personal ;).</p>"},{"location":"#extensibility-model","title":"Extensibility model","text":"<p>By getting this solution, you also benefit from an advanced extensibility model allowing you to customize the solution according to your requirements if default features don't do the job for you. </p> <p>The supported extensions are:</p> <ul> <li>Custom data sources.</li> <li>Custom layouts.</li> <li>Custom web components.</li> <li>Custom suggestions providers.</li> <li>Custom Handlebars customization (helpers, partials, etc.).</li> </ul> <p>With these available customizations options, you can do pretty much anything!</p>"},{"location":"#troubleshooting","title":"Troubleshooting","text":"<p>To help us to resolve your issue, you can include screenshots or error messages coming from:</p> <ul> <li>The faulty Web Part itself. </li> <li>Errors displayed in the browser console (typically pressing F12).</li> <li>Errors displayed in the SharePoint console (pressing CTRL+F12)</li> </ul>"},{"location":"#issues-questions-feedback","title":"Issues, questions, feedback?","text":"<p>For any issue, question or feedback, please the official GitHub repository. We will be happy to help you!</p>"},{"location":"features/","title":"Features comparison with PnP Modern Search v4","text":"<p>The PnP Modern Search v4 shares the same code foundation as the aequos Modern Data Visualizer solutions. However, some features are only available in the commercial solution.</p> <p>Important</p> <p>Although these two solutions share the same code foundation, we do not \"own\" the PnP Modern Search as it is a Microsoft community-driven open source project. It means we do not 'control' or voluntarily 'block' new features and the two solutions evolve independently. However we try as much as possible to ensure the same base concepts remain the same and common issues are adressed on both sides. It is a win-win situation.</p>"},{"location":"features/#data-sources","title":"Data sources","text":"Feature Description aequos Modern Data Visualizer PnP Modern Search Available data sources The data sources you can use to retrieve data. <ul><li>SharePoint Search</li><li>Microsoft Search</li><li>Microsoft Graph</li><li>SharePoint REST API v1/v2<li>Azure AD API (ex Azure Function)<li>\u00adAnonymous REST API <ul><li>SharePoint Search</li><li>Microsoft Search</li></ul> Data source slots Templates can use placeholder variables mapped to data source fields to make them reusable. Yes Yes Data caching Data can be put in cache for performances. Yes No Data paging Data can be browsed using paging controls. Yes Yes"},{"location":"features/#layouts","title":"Layouts","text":"Feature Description aequos Modern Data Visualizer PnP Modern Search Available layouts for results Layouts you can use to display results from a data source. <ul><li>Cards</li><li>Details List</li><li>Simple List</li><li>Slider</li><li>People</li><li>Teams</li><li>Custom</li></ul> <ul><li>Cards</li><li>Details List</li><li>Simple List</li><li>Slider</li><li>People</li><li>Custom</li></ul> Available layouts for filters Layouts you can use to display filters. <ul><li>Vertical</li><li>Horizontal</li><li>Panel</li><li>Custom</li></ul> <ul><li>Vertical</li><li>Horizontal</li><li>Panel</li><li>Custom</li></ul> Result types Define conditions on fields value for conditional rendering. Yes (handlebars templates only) Yes (handlebars templates only) Customize results using Handlebars, HTML and CSS Use Handlebars, HTML and CSS to build custom results templates. Yes Yes Customize results using Adaptive Cards Use Microsoft Adaptive cards to build custom results templates. Yes No Customize filters using Handlebars, HTML and CSS Use Handlebars, HTML and CSS to build custom filters templates Yes Yes Use basic tokens Ability to transform queries dynamically using basic tokens (current page, hub, user, etc.) Yes Yes Use advanced tokens Ability to transform queries dynamically using advanced tokens (verticals, filters) Yes Yes Use Microsoft Adaptive expressions top build dynamic queries Ability to use Adaptive Expressions to build dynamic and conditional queries based on tokens. Yes No"},{"location":"features/#filters","title":"Filters","text":"Feature Description aequos Modern Data Visualizer PnP Modern Search Available templates Templates you can use to filter values. <ul><li>Check box (with search)</li><li>Combo box</li><li>Date range</li><li>Date interval</li><li>Taxonomy picker</li></ul> <ul><li>Check box (without search)</li><li>Combo box</li><li>Date range</li><li>Date interval</li></ul> Configuration options Available configuration options for filters <ul><li>Filter display name</li><li>Multi value/single value</li><li>Operator between values</li><li>Operator between filters</li><li>Expand by default</li><li>Show values count</li><li>Show values count</li><li>Sort values by name/count (ascending/descending)</li></ul> <ul><li>Filter display name</li><li>Multi value/single value</li><li>Operator between values</li><li>Operator between filters</li><li>Expand by default</li><li>Show values count</li><li>Show values count</li><li>Sort values by name/count (ascending/descending)</li></ul>"},{"location":"features/#verticals","title":"Verticals","text":"Feature Description aequos Modern Data Visualizer PnP Modern Search Data verticals Browse data as silos. Yes Yes Custom tokens for verticals Use verticals as tokens including custom data in the results Web Part Yes Yes"},{"location":"features/#search-box","title":"Search box","text":"Feature Description aequos Modern Data Visualizer PnP Modern Search Enter free text keywords Users can enter free text queries in a search box Web Part. Yes Yes"},{"location":"features/#group-metadata-editor","title":"Group Metadata Editor","text":"Feature Description aequos Modern Data Visualizer PnP Modern Search Tag Microsoft Group / Team Tag a specific Microsoft 365 group or team using a custom Microsoft Graph schema extension Yes No"},{"location":"features/#extensibility","title":"Extensibility","text":"Feature Description aequos Modern Data Visualizer PnP Modern Search Extensibility method The method used to create extensions for Web Parts. SPFx library components in global or site collection catalog. SPFx library components in global or site collection catalog. Custom web components Developers can create custom web components to use in templates. Yes Yes Custom suggestions providers Developers can create custom suggestions providers for the search box. Yes Yes Custom data sources Developers can create custom data sources with property pane options. Yes No Custom layouts Developers can create custom layouts for the results component with property pane options. Yes Yes Custom Handlebars customizations Developers can create custom helpers or partials for templates using Handlebars. Yes Yes Multiple extensibility libraries support Developers can register one or more extensibility libraries per Web Part instances. Yes Yes"},{"location":"features/#miscellaneous-support-price","title":"Miscellaneous, support &amp; price","text":"Feature Description aequos Modern Data Visualizer PnP Modern Search Supported browsers <ul><li>Chrome</li><li>Firefox</li><li>Edge</li><li>Edge Chromium</li><li>Brave</li><li>Safari</li><li>Internet Explorer 11 is not supported</li></ul> <ul><li>Chrome</li><li>Firefox</li><li>Edge</li><li>Edge Chromium</li><li>Brave</li><li>Safari</li><li>Internet Explorer 11 is not supported</li></ul> Support How the solution is supported when your encounter issues Guaranteed by @aequos. Major bugs correction within 5 open days. By the open-source community (including us). No guarantee. If it breaks, it breaks Price www.aequos.ca Free License agreement Commercial license. EULA at www.aequos.ca/eula MIT License (anyone can reuse the code for commercial purposes)"},{"location":"get_license/","title":"Get a license","text":""},{"location":"get_license/#licence-types","title":"Licence types","text":"<p>You need a valid license to use the \"Modern Data Visualizer\" Web Parts. We offer two kinds of license: www.aequos.ca</p> <p>Except their duration, our license offer the same specifications: </p> <ul> <li>All Web Parts included (Data Visualizer, Data Filters, Data Verticals, Search Box and Group Metadata Editor).</li> <li>Unlimited users. The size of your organisation doesn't matter.</li> <li>Free upgrades from our GitHub repository. However, no automatic upgrade process, you must manually update the package like a regular SharePoint Framework package.</li> <li>One license per Microsoft 365 tenant ID. If you have two tenants (ex: DEV/PRODUCTION), you must purchase two licenses.</li> <li>A license is not transferable between tenants.</li> </ul>"},{"location":"get_license/#get-a-subscription-license","title":"Get a subscription license","text":"<p>You can get a valid license directly from our website or, if you prefer to receive a formal quote and pay with the registration of a PO number, contact us at mdv@sword-group.com. It will be our pleasure to answer you. </p> <p>In both scenarios, we will need the Microsoft 365 Tenant ID where you plan to use the solution. If you don't know how to get this information, you can use this online tool.</p> <p></p>"},{"location":"get_license/#get-a-trial-version","title":"Get a trial version","text":"<p>Want to try the solution capabilities first? Sure! We offer a 14 days trial for the solution, no personal information nor credit card required. Just:</p> <ol> <li>Download the latest solution package from our GitHub repository.</li> <li>Upload and deploy it to a SharePoint site collection or tenant app catalog.</li> <li>Add any of aequos Modern Data Visualizer Web Parts on a SharePoint page to automatically activate the trial license for your Tenant ID.</li> </ol> <p></p> <p>Warning</p> <ul> <li>The trial license is tied to a unique tenant ID. Once expired, you can't use the solution anymore in this Tenant until you purchase a valid license.</li> <li>Trial periods are not cumulative. However, if you need more time to evaluate our solution, simply contact us directly at mdv@sword-group.com.</li> </ul>"},{"location":"installation/","title":"Installation","text":"<p>Trial version</p> <p>If you don't have a valid license when using one of the Web Parts for the first time in a page, a 14 days trial period will automatically begin associated to your Microsoft 365 tenant ID. You don't need to provide any credit card or personal information, simply follow the steps below to start using the solution. At the end of the trial period, a license validation message will appear preventing using the Web Parts anymore. To continue to use them, you must purchase a valid license. </p> <p></p> <p>Trial periods are not cumulative. However, if you need more time to complete your evaluation simply contact us directly at mdv@sword-group.com.</p> <ol> <li>Download the latest SharePoint Framework package (aequos-modern-data-visualizer.sppkg) from our public GitHub repository.</li> <li> <p>Add the package to your global app catalog or site collection app catalog. If you don't have an app catalog, follow this procedure to create one.</p> <p></p> <ul> <li> <p>The solution is deployed in the general Microsoft 365 CDN meaning we don't host any code on our side.</p> </li> <li> <p>You can choose to make the solution available in all sites or force to install an app to the site every time.</p> </li> </ul> <p>Asked API permissions</p> <p>The solution asks the following API permissions by default to enhance the experience. </p> <p>Mandatory permissions</p> Requested API permission Used for TermStore.Read.All The taxonomy picker filter template. Without it, users won't be able to browse for terms and term sets in the taxonomy tree. <p>Not mandatory permissions</p> <p>The following permissions are not mandatory. If you don't accept them, you will simpy have less available features.</p> Requested API permission Used for User.Read The Microsoft Graph Toolkit persona card in the people layout. People.Read Same as above. Contacts.Read Same as above. User.ReadBAsic.All Same as above. GroupMember.Read.All To list owners and members in the Teams layout panel. Channel.ReadBasic.All To list channels in the Teams layout panel. Group.ReadWrite.All To be able to update Microsoft Graph schems extensions with the Group/Team metadata editor Web Part. Files.Read.All Microsoft Search API Sites.Read.All Microsoft Search API Mail.Read Microsoft Search API Calendars.Read Microsoft Search API ExternalItem.Read.All Microsoft Search API <p>Microsoft Teams deployment</p> <p>If you plan to use the aequos - Group metadata editor solution in Microsoft Teams, you must deploy the <code>.sppkg</code> file in the Tenant app catalog and use the \"Sync to Teams\" ribbon button:</p> <p></p> <p>Once deployed, you should see the application in the Teams application catalog:</p> <p></p> </li> <li> <p>Add the Web Parts to a SharePoint and start building. Easy no?</p> </li> </ol> <p></p>"},{"location":"setup_standalone/","title":"Setup your standalone license","text":""},{"location":"upgrade_from_pnp/","title":"Upgrade from PnP Modern Search v4","text":"<p>The PnP Modern Search v4 is literally a forked version of our Modern Data Visualizer solution and therefore, shares the same code foundation from its parent, simply with less features. If you started your project using the PnP Web Parts but feel limited to accomplish your objectives, you can upgrade to MDV solution (since version 1.3.0) without losing your Web Parts data and configuration following this procedure:</p> <p>Warning</p> <p>We do not recommended to upgrade the PnP Modern Search Web Parts v4 if you simply want to try the MDV solution as it will be difficult to rollback to PnP Modern Search later. For a trial, consider using an isolated site collection with its own app catalog instead. </p> <ol> <li>Download the latest release of the aequos Modern Data Visualizer solution in our GitHub repository</li> <li> <p>In the SharePoint app catalog where the PnP Modern Search v4 solution is deployed, remove the existing package:</p> <p></p> </li> </ol> <p>Downtime consideration</p> <p>Removing the existing package from the app catalog will have an impact on your users as they may see errors when refreshing their SharePoint pages. To minimize the downtime, just upload the new MDV package right away after deleting. The error messages will disappear after few page refreshes.</p> <ol> <li> <p>Add the aequos MDV SharePoint Framework package et voil\u00e0! Same configurations but with much more available options now.</p> <p></p> </li> </ol> <p>Warning</p> <ul> <li>The PnP Modern Search v4 and aequos Data Visualizer solutions can't be used in the same app catalog.</li> <li>PnP Modern Search Web Parts v3 are not upgradable to MDV (neither to PnP v4 anyway).</li> </ul>"},{"location":"extensibility/","title":"Extensibility possibilities","text":"<p>This solution supports different levels of customizations depending your requirements:</p> <ul> <li>'Basic' customizations: these include custom settings for data sources, search box, verticals and filters Web Parts + minor updates to existing layouts by adding custom HTML markup (ex: add a custom field in the UI from a data source), updates to builtin layouts fields ('Cards','Details List' and 'People'), etc. They only require HTML, CSS and Handlebars skills to be done. Typically a super user or a webmaster could do that.</li> <li>'Advanced' customizations: these include major updates like adding a new data source, layout, component or suggestions provider. These are build from scratch and require SharePoint Framework development skills to be done. Typically, a front-end/SharePoint developer could do that.</li> </ul>"},{"location":"extensibility/#basic-customizations","title":"Basic customizations","text":"<p>'Basic' customizations cover the layout templates updates with HTML, CSS and Handlebars. Refer to the templating documentation to know more.</p>"},{"location":"extensibility/#advanced-customizations","title":"Advanced customizations","text":"<p>The solution uses the concept of 'extensibility libraries'. Basically, these are SharePoint Framework library components you put in the global or site collection app catalog that will be loaded automatically by Web Parts to enhance the experience and options (ex: new data source with new options, custom layout, etc.). Simple as that!</p> <p>As a demonstration of capabilities, all builtin data sources, layouts, web components or suggestions providers are built using the same exact interfaces and methods that are publically available in the <code>@aequos/extensibility</code> npm package. We took no shortcuts or cheats whatsoever in our code so you could theorically get the same output!</p> <p>All documentation procedures for extensions are based on the demo extensibility library available in the GitHub repository that you can use as reference.</p>"},{"location":"extensibility/#prerequistes","title":"Prerequistes","text":"<p>For your project to be a valid extensibility library, you must have the following prerequisites:</p> <ul> <li>Your project must be an SPFx library component.</li> <li>The main entry point of your library must implement the <code>IExtensibilityLibrary</code> interface from the '@aequos/extensibility' npm public package.</li> <li>You library manifest ID must be registered in the Web Part where you want to use the extension.</li> </ul>"},{"location":"extensibility/#supported-extensions","title":"Supported extensions","text":"<p>Each Web Part type in the solution supports several extensions or no extension at all. It means even your extensibility library contains all possible extensions, they won't be loaded if the Web Part does not support them.</p> Web Part type Supported extensions Data Visualizer <ul><li>Custom data sources.</li><li>Custom layouts.</li><li>Custom web components.</li><li>Custom Handlebars customizations (ex: helpers, partials ,etc.).</li></ul> Data Filters <ul><li>Custom web components (not directly but via the 'Data Visualizer' Web Part extensibility library registration).</li></ul> Search box <ul><li>Custom suggestions providers.</li></ul> Data Verticals None"},{"location":"extensibility/#register-your-extensibility-library-with-a-web-part","title":"Register your extensibility library with a Web Part","text":"<p>When a Web Part type supports one or multiple extensions, you can register them going to the last property pane confguration page in the 'Extensibility configuration' section:</p> <p></p> <p>From here, you can add the manifest IDs of your libraries and decide to enable or disabled certain libraries. The manifest ID can be found in the <code>&lt;your_library_name&gt;.manifest.json</code> file:</p> <p></p> <p></p> <p>Multiple librairies can be registred for a single Web Part instance allowing you to split your extensions into multiple projects (in the end, they will be all concatenated). For instance, this could be convenient when extensions come from different IT providers.</p>"},{"location":"extensibility/#create-an-extensibility-library","title":"Create an extensibility library","text":"<p>To create an extensibility library, you have the choice to reuse the one provided in the GitHub repository or start from scratch. In this case:</p> <ol> <li>Create a new SharePoint Framework project of type 'Library' with <code>yo @microsoft/sharepoint</code>.</li> <li>In your <code>package.json</code> add the '@aequos/extensibility' npm public package (latest) and run <code>npm i</code>.     </li> <li>In the main entry point, implement the <code>IExtensibilityLibrary</code> interface. Provide all method implementations (return empty arrays if you don't implement specific extensions).     </li> <li> <p>Implement your extension(s) depending of the type:</p> <ul> <li>Data source</li> <li>Layout</li> <li>Web component</li> <li>Suggestions providers</li> <li>Handlebars customizations</li> </ul> <p>Creation process always follows more or less the same pattern:</p> <ol> <li>Create the extension data logic or render logic.</li> <li>Register the information about the extension to be discovered and instanciated by the target Web Part by implementing the corresponding method according to the <code>IExtensibilityLibrary</code> interface.</li> </ol> </li> <li> <p>Bundle <code>gulp bundle --ship</code> and package <code>gulp package-solution --ship</code> and add the solution to the global or site collection catalog (for this one, it must be the same site collection where the Web Part loading that extension(s) is present).</p> </li> <li>Register your manifest ID in the target Web Part instance.</li> <li>Enjoy!</li> </ol>"},{"location":"extensibility/#debug-a-library-component","title":"Debug a library component","text":"<p>Debugging a library component is exactly the same as debugging an SPFx Web Part. Run <code>gulp serve</code> in the hosted workbench and put a 'Data Visualizer','Data Filters' or 'Search Box' Web Part depending the extension you want to test. If registered correctly, your breakpoints will be triggerred by the main Web Part loading your extension.</p>"},{"location":"extensibility/custom_data_source/","title":"Create a custom data source","text":""},{"location":"extensibility/custom_data_source/#data-source-creation-process","title":"Data source creation process","text":"<p>Data source creation process comes in two distinct steps:</p> <ol> <li>Create the data source itself (i.e. the logic to get data, etc.).</li> <li>Register the data source information for discovery.</li> </ol>"},{"location":"extensibility/custom_data_source/#create-the-data-source-logic","title":"Create the data source logic","text":"<p>The first step is to create the core logic of the data source:</p> <ul> <li>In your extensibility library project, create a new <code>MyDataSource.ts</code> TypeScript file.</li> <li> <p>Create an interface for your data source properties, typically the ones you want to persist in the Web Part property bag. Data source properties are isolated from the other general Web Part properties under the property <code>dataSourceProperties</code> in the property bag object.     <pre><code>export interface ICustomDataSourceProperties {\nmyProperty: string;\n}\n</code></pre> </p> </li> <li> <p>Implement the <code>BaseDataSource</code> abstract class using your properties interface:     <pre><code>export class CustomDataSource extends BaseDataSource&lt;ICustomDataSourceProperties&gt; {\n...\n}\n</code></pre></p> </li> <li> <p>Implement your data source logic according to the available methods and properties.</p> </li> </ul>"},{"location":"extensibility/custom_data_source/#basedatasource-methods","title":"BaseDataSource - Methods","text":"Method Description <code>onInit()</code> The initialization method of your data source (ex: initialize your properties, etc.). You can perform asynchronous calls here. This method will be called when the data source is instanciated by the main Web Part. <code>getData()</code> Probably the most important method in a data source. Returns the data of your data source, for instance, after an asynchronous call to your API. The data must follow the <code>IDataSourceData</code> interface. As input, you will receive all the data context with useful information to get your data (ex: the current selected page, current selected filters, etc.). <code>getPropertyPaneGroupsConfiguration()</code> Returns the property pane fields to display when your data source is selected. These are regular SPFx property fields and groups. Data source properties are isolated from the other general Web Part properties under the property <code>dataSourceProperties</code>. It means you must include that path in your property pane controls get the value persisted:  . Defining fields or groups is not mandatory for a data source. If you don't want to expose any option, just return an empty array. <code>getPagingBehavior()</code> The paging behavior of the data source. If 'Dynamic', the paging will be done using the pre-calculated <code>paging.links</code> array property returned by the data source. In this mode, this is your responsibility to populate these links (ex: using a <code>@odata.nextLink</code> information from your API). If 'Static', the paging will be done statically based on the <code>items</code> array property returned by the data source. If 'None', no paging will be performed. <code>getFilterBehavior()</code> The filter behavior of the data source. If 'Dynamic', the available filters and values will be the ones returned by the data source in the <code>filters</code> array property. If 'Static', the available filters and values will be determined using the current results set returned by the data source (using objects properties from the <code>items</code> array property). <code>getAppliedFilters()</code> If any, returns the list of filters (i.e data source fields) applied by the data source to filter results. Set this information in your data source is <code>FilterType.Static</code> but you still want filter initial result with 'Static' filters (like Taxonomy Picker and Date Range). These will be excluded by the main Web Part during the static filtering operation. If you forgot to set these values, data will be filtered statically using the current selected filters. <code>getItemCount()</code> Returns the total of items. This can be the <code>items</code> array length or the total of items in general. This information will be used to generate page numbers. <code>getTemplateSlots()</code> Returns the available template slots for this data source. More information about slots. <code>onPropertyUpdate()</code> The method will be called when a property pane value is updated. The main Web Part in <code>Reactive</code> mode for property pane fields. <code>render()</code> Call this method to force a render of the main Web Part."},{"location":"extensibility/custom_data_source/#basedatasource-properties","title":"BaseDataSource - Properties","text":"Property Description <code>properties</code> The Web Part properties in the property bag. Corresponds to the isolated <code>dataSourceProperties</code> property in the global property bag. You won't be able to access any other general properties of the Web Part. <code>context</code> The Web Part context given by the main Web Part. <code>serviceKeys</code> The available service scope keys you can use to get shared service instances like the <code>TokenService</code>. Example:"},{"location":"extensibility/custom_data_source/#using-service-scope-to-get-service-instances","title":"Using service scope to get service instances","text":"<p>If your data source needs to use <code>SPHttpClient</code>, <code>HttpClient</code>, etc. services to retrieve data, you have multiple ways to get instances for these.</p> <ul> <li> <p>Use the <code>this.context</code> property:     <pre><code>    const spHttpClient = this.context.spHttpClient;\n</code></pre> OR</p> </li> <li> <p>Use the parent service scope to consume an existing instance:     <pre><code>private spHttpClient: SPHttpClient;\n\nconstructor(serviceScope: ServiceScope) {\n\nsuper(serviceScope);\n\nserviceScope.whenFinished(() =&gt; {\nthis.spHttpClient = serviceScope.consume(SPHttpClient.serviceKey);\n});\n}\n</code></pre></p> </li> </ul> <p>We recommend to use the second approach especially if you also use shared instances like the <code>TokenService</code>.</p>"},{"location":"extensibility/custom_data_source/#register-data-source-information","title":"Register data source information","text":"<p>The next step is to fill information about your new data source. In the library main entry point (i.e. the class implementing the <code>IExtensibilityLibrary</code> in interface) return a new <code>IDataSourceDefinition</code> object in the <code>getCustomDataSources()</code> method using these properties: </p> Property Description <code>name</code> The friendly name of your data source that will show up in tiles. <code>iconName</code> An Office UI Fabric icon for your data source. <code>key</code> An unique internal key for your data source. <code>serviceKey</code> A service key used to instanciate your data source class. Builtin or custom data sources are instanciated dynamically using SPFx service scopes. <pre><code>public getCustomDataSources(): IDataSourceDefinition[] {\n\nreturn [\n{\nname: 'My Custom Source',\niconName: 'Code',\nkey: 'CustomDataSource',\nserviceKey: ServiceKey.create&lt;IDataSource&gt;('MyCompany:CustomDataSource', CustomDataSource)\n}\n];\n}\n</code></pre>"},{"location":"extensibility/custom_layout/","title":"Create a custom layout","text":"<p>Custom layouts are only supported for the 'Data Visualizer' Web Part. You can't add custom layout for the 'Data Filter' Web Part.</p>"},{"location":"extensibility/custom_layout/#layout-creation-process","title":"Layout creation process","text":"<p>Same as data source, the layout creation process comes in three distinct steps:</p> <ol> <li>Create the layout class (i.e. define the property pane options).</li> <li>Create the HTML template associated to that layout.</li> <li>Register the layout information for discovery.</li> </ol>"},{"location":"extensibility/custom_layout/#create-the-layout","title":"Create the layout","text":"<ul> <li>In your extensibility library project, create a new <code>MyLayout.ts</code> TypeScript file.</li> <li> <p>Create an interface for your layout properties, typically the ones you want to persist in the Web Part property bag. Layout properties are isolated from the other general Web Part properties under the property <code>layoutProperties</code> in the property bag object.     <pre><code>export interface ICustomLayoutProperties {\nmyTextProperty: string;\n}\n</code></pre></p> <p></p> </li> <li> <p>Implement the <code>BaseLayout</code> abstract class using your properties interface:     <pre><code>export class Customlayout extends BaseLayout&lt;ICustomLayoutProperties&gt; {\n...\n}\n</code></pre></p> </li> <li> <p>Implement your layout logic according to the available methods and properties.</p> </li> </ul>"},{"location":"extensibility/custom_layout/#baselayout-methods","title":"BaseLayout - Methods","text":"Method Description <code>onInit()</code> The initialization method of your layout (ex: initialize your properties, etc.). You can perform asynchronous calls here. This method will be called when the layout is instanciated by the main Web Part. <code>getPropertyPaneGroupsConfiguration()</code> Returns the property pane fields to display when your layout is selected. These are regular SPFx property fields and groups. Layout properties are isolated from the other general Web Part properties under the property <code>layoutProperties</code>. It means you must include that path in your property pane controls get the value persisted (same thing as custom data source). Defining fields or groups is not mandatory for a layout. If you don't want to expose any option, just return an empty array. <code>onPropertyUpdate()</code> The method will be called when a property pane value is updated. The main Web Part in <code>Reactive</code> mode for property pane fields."},{"location":"extensibility/custom_layout/#baselayout-properties","title":"BaseLayout - Properties","text":"Property Description <code>properties</code> The Web Part properties in the property bag. Corresponds to the isolated <code>layoutProperties</code> property in the global property bag. You won't be able to access any other general properties of the Web Part."},{"location":"extensibility/custom_layout/#create-the-template","title":"Create the template","text":"<p>You have the choice to use either Handlebars or Adaptive Cards as template engine:</p>"},{"location":"extensibility/custom_layout/#option-1-create-the-html-template-file-handlebars","title":"Option #1: Create the HTML template file (Handlebars)","text":"<p>In your extensibility library project, create a new <code>custom-layout.html</code> HTML file. A layout template is split into two distinct parts:</p> <p>A <code>template</code> part, containing the HTML markup to display your data once fetched. This part is mandatory to display your data.</p> <pre><code>&lt;content id=\"template\"&gt;\n    &lt;!-- Your template content here --&gt;\n&lt;/content&gt;\n</code></pre> <p>A <code>placeholder</code> part, containing the HTML markup to display as placeholder while the data are getting fetched. This part is optional.</p> <pre><code>&lt;content id=\"placeholder\"&gt;\n    &lt;!-- Your placeholder content here --&gt;\n&lt;/content&gt;\n</code></pre> <p>In a template, you must use Handlebars expressions to access and display your data.</p> <p>Example: iterating through all items</p> <pre><code>{{#each data.items as |item|}}\n    &lt;!-- Access 'item' data source fields from here (ex: item.Title)--&gt;\n{{/each}}\n</code></pre>"},{"location":"extensibility/custom_layout/#option-create-the-json-template-file-adaptive-cards","title":"Option #: Create the JSON template file (Adaptive Cards)","text":"<p>In your extensibility library project, create a new <code>custom-layout.json</code> JSON file. Refer to the official schema or use the Adaptive Cards interactive builder to get started.</p> <p>Example: iterating through all items</p> <pre><code>{\n\"type\": \"Container\",\n\"$data\": \"${data.items}\", \"items\": [\n{\n\"type\": \"ColumnSet\",\n\"columns\": [\n{\n...\n</code></pre>"},{"location":"extensibility/custom_layout/#register-layout-information","title":"Register layout information","text":"<p>The next step is to fill information about your new layout. In the library main entry point (i.e. the class implementing the <code>IExtensibilityLibrary</code> in interface) return a new <code>ILayoutDefinition</code> object in the <code>getCustomLayouts()</code> method using these properties: </p> Property Description <code>name</code> The friendly name of your layout that will show up in tiles. <code>iconName</code> An Office UI Fabric icon for your layout. <code>key</code> An unique internal key for your layout. <code>type</code> The layout type (<code>LayoutType.Results</code> is for the 'Data Visualizer' Web Part, <code>LayoutType.Filter</code> for the 'Data Filter' Web Part). Only <code>LayoutType.Results</code> is supported for now. You can't add custom layout for the 'Data Filter' Web Part. <code>templateContent</code> The template HTML content as string. Use a <code>require</code> statement to get the string content from your HTML file. If you reference a JSON file, you must use the stringified value (ex: <code>JSON.stringify(require('../custom-layout.json'), null, \"\\t\")</code>) <code>serviceKey</code> A service key used to instanciate your layout class. Builtin or custom data layouts are instanciated dynamically using SPFx service scopes. <code>templateType</code> The template type of the layout., Can be either <code>Handlebars</code> or <code>AdaptiveCards</code>. <pre><code>public getCustomLayouts(): ILayoutDefinition[] {\nreturn [\n{\nname: 'My custom layout',\niconName: 'Color',\nkey: 'CustomLayout',\ntype: LayoutType.Results,\ntemplateContent: require('../custom-layout.html'),\nserviceKey: ServiceKey.create&lt;ILayout&gt;('MyCompany:CustomLayout', Customlayout),\ntemplateType: LayoutTemplateType.Handlebars\n}\n];\n}\n</code></pre>"},{"location":"extensibility/custom_suggestions_provider/","title":"Create a custom suggestions providers","text":"<p>Custom suggestions providers can be added to a search box Web Part to get normalized keywords during search.</p> <p></p> <p>A suggestions provider supports:</p> <ul> <li>Zero term suggestions: suggestions displayed when the search box get the initial focus and no term is provided.</li> <li>Suggestions based on a keywords: suggestions matching specific keywords provided in the search box.</li> </ul>"},{"location":"extensibility/custom_suggestions_provider/#custom-suggestions-provider-creation-process","title":"Custom suggestions provider creation process","text":"<p>Suggestions provider creation process comes in two distinct steps:</p> <ol> <li>Create the provider logic.</li> <li>Register the provider information for discovery.</li> </ol>"},{"location":"extensibility/custom_suggestions_provider/#create-the-provider-logic","title":"Create the provider logic","text":"<ul> <li>In your extensibility library project, create a new <code>MyProvider.ts</code> TypeScript file.</li> <li> <p>Create an interface for your provider properties, typically the ones you want to persist in the Web Part property bag. Providers properties are isolated from the other general Web Part properties under the property <code>providerProperties</code> in the property bag object.   <pre><code>export interface ICustomSuggestionProviderProperties {\nmyProperty: string;\n}\n</code></pre></p> </li> <li> <p>Implement the <code>BaseSuggestionProvider</code> abstract class using your properties interface:   <pre><code>export class CustomSuggestionProvider extends BaseSuggestionProvider&lt;ICustomSuggestionProviderProperties&gt; {\n...\n}\n</code></pre></p> </li> <li> <p>Implement your provider logic according to the available methods and properties.</p> </li> </ul>"},{"location":"extensibility/custom_suggestions_provider/#basesuggestionprovider-methods","title":"BaseSuggestionProvider - Methods","text":"Method Description <code>onInit()</code> The initialization method of your provider (ex: initialize your properties, etc.). You can perform asynchronous calls here. This method will be called when the provider is instanciated by the main Web Part. This is a good place to fetch any zero term suggestions if any. <code>getSuggestions()</code> Method called to retrieve suggestions when a keyword is entered (in paramter). <code>getZeroTermSuggestions()</code> Method called to retrieve the zero term suggestions (i.e. when the search box gets initial focus). <code>getPropertyPaneGroupsConfiguration()</code> Returns the property pane fields to display when your provider is selected. These are regular SPFx property fields and groups. PRovider properties are isolated from the other general Web Part properties under the property <code>providerProperties</code>. It means you must include that path in your property pane controls get the value persisted. Defining fields or groups is not mandatory for a provider. If you don't want to expose any option, just return an empty array. <code>onPropertyUpdate()</code> The method will be called when a property pane value is updated. The main Web Part in <code>Reactive</code> mode for property pane fields."},{"location":"extensibility/custom_suggestions_provider/#basesuggestionprovider-properties","title":"BaseSuggestionProvider - Properties","text":"Property Description <code>properties</code> The Web Part properties in the property bag. Corresponds to the isolated <code>providerProperties</code> property in the global property bag. You won't be able to access any other general properties of the Web Part. <code>isZeroTermSuggestionsEnabled</code> Flag indicating if the provider supports zero term suggestions or not."},{"location":"extensibility/custom_suggestions_provider/#register-provider-information","title":"Register provider information","text":"<p>The next step is to fill information about your new suggestions provider. In the library main entry point (i.e. the class implementing the <code>IExtensibilityLibrary</code> in interface) return a new <code>ISuggestionProviderDefinition</code> object in the <code>getCustomSuggestionProviders()</code> method using these properties: </p> Property Description <code>name</code> The friendly name of your provider that will show up in the configuration panel. <code>key</code> An unique internal key for your data source. <code>description</code> A meaningful description of your provider. <code>serviceKey</code> A service key used to instanciate your provider class. Builtin or custom providers are instanciated dynamically using SPFx service scopes. <pre><code>public getCustomSuggestionProviders(): ISuggestionProviderDefinition[] {\nreturn [\n{\nname: 'Custom Suggestions Provider',\nkey: 'CustomSuggestionsProvider',\ndescription: 'A demo custom suggestions provider from the extensibility library',\nserviceKey: ServiceKey.create&lt;ISuggestionProvider&gt;('MyCompany:CustomSuggestionsProvider', CustomSuggestionProvider)\n}\n];\n}\n</code></pre>"},{"location":"extensibility/custom_web_component/","title":"Create a custom web component","text":""},{"location":"extensibility/custom_web_component/#what-is-a-web-component","title":"What is a web component?","text":"<p>A web component is a custom HTML element that can be used in your templates to implement complex behaviors. In the solution we used them here as \"wrappers\" for React components to be able to use them with Handlebars. More information about web components in general can be found here.</p> <p></p> <p>By default, several components are available (see the complete list). If these does not fit your requirement, you can still create your own.</p>"},{"location":"extensibility/custom_web_component/#web-component-creation-process","title":"Web component creation process","text":"<p>Web component creation process comes in two distinct steps:</p> <ol> <li>Create the component class and its React sub components.</li> <li>Register the component information for discovery.</li> </ol>"},{"location":"extensibility/custom_web_component/#create-the-component-logic-and-sub-components","title":"Create the component logic and sub components","text":"<p>A web component is typically composed of these parts:</p> <ul> <li>A web component class derived from the native <code>HTMLElement</code> class.</li> <li>A main React component to be rendered inside the web component.</li> </ul> <p>To create new component:</p> <ul> <li>In your extensibility library project, create a new <code>MyComponent.ts</code> JSX file.</li> <li> <p>Create a new class extending the abstract class <code>BaseWebComponent</code>. This class must have at least the <code>connectedCallback()</code> method from base interface <code>HTMLElement</code>.</p> <pre><code>export class MyCustomComponentWebComponent extends BaseWebComponent {\n\npublic constructor() {\nsuper(); }\n\npublic async connectedCallback() {\n...\n}    }\n</code></pre> </li> <li> <p>Create a new regular React component (in the same file or a separate file and as class or hook):</p> <pre><code>export interface IObjectParam {\nmyProperty: string;\n}\n\nexport interface ICustomComponentProps {\n\n/**\n     * A sample string param\n     */\nmyStringParam?: IObjectParam;\n\n/***\n     * A sample object param\n     */\nmyObjectParam?: string;\n}\n\nexport interface ICustomComponenState {\n}\n\nexport class CustomComponent extends React.Component&lt;ICustomComponentProps, ICustomComponenState&gt; {\n\npublic render() {\n\n// Parse custom object\nconst myObject: IObjectParam = this.props.myObjectParam;\n\nreturn &lt;div&gt;{this.props.myStringParam} {myObject.myProperty}&lt;/div&gt;;\n}\n}\n</code></pre> </li> </ul> <p>In this solution, web components are considered stateless, meaning they will be entirely recreated when an attribute is changed (coming from the property pane). It means you can still use an internal state in your React components but not rely on the parent context (props) since it will be recreated every time by the Handlebars template if a property pane value is updated. The <code>componentDidMount()</code> method will be called every time in this case (not <code>componentDidUpdate()</code>).</p> <ul> <li> <p>In your web component class, render your React component:</p> <pre><code>public async connectedCallback() {\n\nlet props = this.resolveAttributes();\nconst customComponent = &lt;CustomComponent {...props}/&gt;;\nReactDOM.render(customComponent, this);\n} </code></pre> </li> </ul> <p>The <code>resolveAttributes()</code> method will look at all <code>data-*</code> HTML attributes in your web component custom element node and return a corresponding key/value pair object with values in their guessed type that you can pass directly to your React component as props. By convention, web component attributes have to be passed using camel case to be tranformed into React component props. For instance: a <code>data-my-string-param</code> HTML attribute becomes <code>myStringParam</code> prop.</p> <p>Supported guessed types for attributes are boolean, string, date and object. All non supported types will be passed a string. HTML attributes must use the data- prefix to be retrieved correctly.</p> <p>To pass JSON objects, you can use the <code>JSONstringify</code> Handlebars helper. If valid JSON, they will be returned as objects by the <code>resolveAttributes()</code> method.</p> <p>Example</p> <pre><code>&lt;my-custom-component \n    data-my-string-param=\"Default value\" \n    data-my-object-param=\"{{JSONstringify this 2}}\"\n    data-my-date-param=\"01/01/2020\"\n    data-my-boolean-param=\"true\"\n&gt;\n&lt;/my-custom-component&gt;\n</code></pre>"},{"location":"extensibility/custom_web_component/#register-component-information","title":"Register component information","text":"<p>The next step is to fill information about your new component. In the library main entry point (i.e. the class implementing the <code>IExtensibilityLibrary</code> in interface) return a new <code>IComponentDefinition</code> object in the <code>getCustomWebComponents()</code> method using these properties: </p> Property Description <code>componentName</code> The name for your component. This name will be used as the custom HTML element name (ex: <code>&lt;my-custom-component&gt;</code>). <code>componentClass</code> The web component class for that component. <pre><code>public getCustomWebComponents(): IComponentDefinition&lt;any&gt;[] {\nreturn [\n{\ncomponentName: 'my-custom-component',\ncomponentClass: MyCustomComponentWebComponent\n}\n];\n}\n</code></pre>"},{"location":"extensibility/handlebars_customizations/","title":"Register Handlebars customizations","text":"<p>By default, builtin helpers and open-source Handlebars helpers are available. If these don't fit your requirements, you can still create your own custom helper or partial that you can use in your HTML templates or layout fields (ex: 'Cards' or 'Details List' layouts).</p> <p>To avoid any conflict, each Web Part instance gets its own Handlebars isolated namespace (i.e. using <code>Handlebars.create()</code>) meaning registering customizations in the global Handlebars namespace won't work (ex: using <code>Handlebars.registerHelper()</code> directly).</p> <p>To register a new Handlebars customization for the targeted Web Part (i.e. the Web Part instances where the extensibility library is registered and enabled):</p> <ol> <li>In the library main entry point (i.e. the class implementing the <code>IExtensibilityLibrary</code> in interface), register your customization using the <code>registerHandlebarsCustomizations()</code> method. The <code>namespace</code> parameter corresponds to the targeted Web Part Handlebars isolated namespace</li> <li>From here, use the Handlebars API to add your customizations to this specific namespace. They will be availabe in templates for registered Web Part instances:     <pre><code>public registerHandlebarsCustomizations(namespace: typeof Handlebars) {\n\n// Register custom Handlebars helpers\n// Usage {{myHelper 'value'}}\nnamespace.registerHelper('myHelper', (value: string) =&gt; {\nreturn new namespace.SafeString(value.toUpperCase());\n});\n}\n</code></pre></li> </ol>"},{"location":"extensibility/templating/","title":"Customize layout templates","text":"<p>In a basic customization scenario, super users and webmasters can customize existing templates or start from a blank template to adapt the UI to their requirements. Templates can use either Handlebars or Adaptive cards templates to display data retrieved from the data source. Depdending of the template type, there are several options to customize a template:</p> <ul> <li>Handlebars<ul> <li>Use regular HTML markup, Handlebars syntax and helpers.</li> <li>Write custom CSS styles.</li> </ul> </li> <li>Adaptive cards<ul> <li>Use declarative Adaptive Cards JSON templates with data.</li> </ul> </li> <li>Both techniques<ul> <li>Use data sources slots </li> <li>Use default web components provided by the solution.</li> <li>Use Microsoft Graph Toolkit components.</li> </ul> </li> </ul>"},{"location":"extensibility/templating/#handlebars-html-and-css-customizations","title":"Handlebars, HTML and CSS customizations","text":"<p>The templates and fields HTML markup are sanitized automatically preventing XSS attacks. We are using <code>DOMPurify</code> to do so. It means, for instance, you cannot add your own <code>&lt;script&gt;</code> tags or inline JavaScript.</p>"},{"location":"extensibility/templating/#template-structure","title":"Template structure","text":"<p>A layout template is always split into two distinct parts:</p> <pre><code>&lt;content id=\"template\"&gt;\n    &lt;!-- Your template content here --&gt;\n&lt;/content&gt;\n\n&lt;content id=\"placeholder\"&gt;\n    &lt;!-- Your placeholder content here --&gt;\n&lt;/content&gt;\n</code></pre> <ul> <li>A <code>template</code> part, containing the HTML markup to display your data once fetched. This part is mandatory to display your data</li> <li>A <code>placeholder</code> part, containing the HTML markup to display as placeholder while the data are getting fetched. This part is optional</li> </ul> <p>Both can use Handlebars and web components (Microsoft Graph Toolkit included). </p>"},{"location":"extensibility/templating/#handlebars-helpers","title":"Handlebars helpers","text":"<p>The following custom helpers are available in addition to the handlebars-helpers. If those don't do the job for you, you can still write your own using the extensibility library.</p> Helper Description Example <code>{{getGraphPreviewUrl \"&lt;absolute_URL&gt;\"</code> Try to determine the preview URL based on an absolute URL using the unified Microsoft Graph URL syntax. For instance, https://aequosdev.sharepoint.com/sites/dev/Shared%20Documents/MyDocument.pdf becomes https://aequosdev.sharepoint.com/sites/dev/Shared%20Documents/?id=/sites/dev/Shared%20Documents/MyDocument.pdf&amp;parent=/sites/dev/Shared%20Documents <code>{{getGraphPreviewUrl 'https://aequosdev.sharepoint.com/sites/dev/Shared%20Documents/MyDocument.pdf'}}</code> <code>{{getCountMessage &lt;total items count&gt; &lt;?keywords&gt;}}</code> Display a friendly message displaying the result and the entered keywords. <code>{{getCountMessage 5 'contoso'}}</code> will display '5 results for 'contoso'. <code>{{getSummary \"&lt;value&gt;\"}}</code> Use with SharePoint Search data source and the HitHighlightedSummary SharePoint search managed property. Returns the formatted value for rendering. <code>{{getSummary HitHighlightedSummary}}</code> <code>{{getDate &lt;data_value&gt; \"&lt;format&gt;\" &lt;time handling&gt;}}</code> Format the date with Moment.js according to the current language. Date in the managed property should be on the form <code>2018-09-10T06:29:25.0000000Z</code> for the function to work.<p>&lt;time handling&gt; is optional and takes <ul><li>0 = format to browsers time zone (default)</li><li>1 = ignore Z time and handle as browsers local time zone</li><li>2 = strip time and set to 00:00:00 in browsers local time zone</li><li>3 = display in the time zone for the current web</li><li>4 = display in the time zone from the uers profile</li> <code>{{getDate 2018-09-10T06:29:25.0000000Z 'LL'}}</code> <code>{{getUrlField &lt;managed_propertyOWSURLH&gt; \"URL|Title\"}}</code> Use with SharePoint Search data source. Returns the URL or Title part of a URL autocreated managed property <code>{{getUrlField MyPropertyOWSURLH \"Title\"}}</code> <code>{{getUniqueCount items \"&lt;property&gt;\"}}</code> or  <code>{{getUniqueCount array}}</code> Get the unique count of a property over the result set (or another array) or get the unique count of objects in an array. Example: [1,1,1,2,2,4] would return <code>3</code>. <code>{{getUniqueCount [1,1,1,2,2,4]}}</code> <code>{{getUnique items \"&lt;property&gt;\"}}</code> Return the unique values as a new array based on an array or property of an object in the array. <code>{{getUnique items \"NewsCategory\"}}</code> <code>{{#group items by=\"&lt;property&gt;\"}}</code> Group items by a specific results property. See https://github.com/shannonmoeller/handlebars-group-by for usage. <code>{{slot item &lt;property_names&gt;}}</code> Return the <code>&lt;property_name&gt;</code> value for the <code>item</code> object. Supports deep property paths. Supports single and multiple item properties ex with single value: <code>{{slot item \"property.subproperty\"}}</code>ex with multiple properties <code>{{slot item (JSONparse '[\"property1\",\"property2\"]')}}</code> <code>{{getUserEmail &lt;value&gt;}}</code> Extract the user email in a string based on a email regex  (ex: a claim). Returns the first match. <code>{{getUserEmail \"franck.cornu@aequosdev.onmicrosoft.com \\| Franck Cornu \\| 693A30232E667C6D656D626572736869707C6672616E636B2E636F726E7540616571756F736465762E6F6E6D6963726F736F66742E636F6D i:0#.f\\|membership\\|franck.cornu@aequosdev.onmicrosoft.com\"}}</code> <code>{{JSONparse &lt;value&gt;}}</code> Parse a string value into a JSON object. Meant to be used to format helper parameters as objects instead of strings. <code>{{JSONparse '[\"property1\",\"property2\"]')}}</code> <p>Need any other helper? Let us know here!</p>"},{"location":"extensibility/templating/#using-builtin-web-components","title":"Using builtin web components","text":"<p>By default, several components are available (see the complete list). If these does not fit your requirement, you can still create your own using the extensibility library.</p>"},{"location":"extensibility/templating/#custom-css-styles","title":"Custom CSS styles","text":"<p>Inside an HTML template (or layout field), you can write your own CSS styles using a &lt;style&gt; tag. Even better, you can inject Handlebars variables, helpers, conditional blocks, etc. right inside it and get dynamic classes or attributes</p> <pre><code>&lt;content id=\"data-content\"&gt;\n\n    &lt;style&gt;\n\n.example-themePrimary a {\ncolor: {{@root.theme.palette.themePrimary}};\n}\n\n...\n\n&lt;/style&gt;\n\n    &lt;div class=\"template\"&gt;\n        ...\n    ...\n</code></pre> <p>However, all CSS rules (including <code>@media</code> rules) will be all prefixed automatically by an unique ID (aequos-template_&lt;Web Part instance ID&gt;) to make sure styles are isolated from other Web Parts on the page. We do this to avoid conflicts between classes in the global context.</p>"},{"location":"extensibility/templating/#use-sharepoint-theme-in-your-templates","title":"Use SharePoint theme in your templates","text":"<p>If you need to use current site theme colors, fonts and so on you can use the <code>theme</code> property available in the <code>@root</code> Handlebars context like this:</p> <pre><code>&lt;content id=\"data-content\"&gt;\n\n        &lt;style&gt;\n.example-themePrimary {\ncolor: {{@root.theme.palette.themePrimary}};\n}\n...\n&lt;/style&gt;\n\n        ...\n\n        &lt;span class=\"example-themePrimary\"&gt;{{Title}}&lt;/span&gt;\n\n        ...\n\n&lt;/content&gt;\n</code></pre> <p>You can also use this variable in the 'Details List' and 'Cards' layouts in field expresions.</p> <p></p> <p>A good way to see all available values for the current theme is to switch to the debug layout and inspect these values:</p> <p></p>"},{"location":"extensibility/templating/#work-with-placeholders","title":"Work with placeholders","text":"<p>To indicate the data are loading, you can create placeholders (shimmers) using the <code>&lt;content id=\"placeholder-content\"&gt;</code> section of your HTML template: The placeholder is only loaded during first data load. For subsequent requests, a overlay will be displayed.</p> <pre><code>&lt;content id=\"placeholder-content\"&gt;\n\n    &lt;style&gt;\n\n        .placeholder .icon {\n            width: 20px;\n            height: 16px;\n            margin-right: 5px;\n        }\n\n        .placeholder ul {\n            list-style: none;\n        }\n\n        .placeholder ul li {\n            display: flex;\n            align-items: center;\n            padding: 8px;\n        }\n\n    &lt;/style&gt;\n\n    &lt;div class=\"placeholder\"&gt;\n        &lt;ul&gt;\n            {{#times 5}}   \n                &lt;li&gt;\n                    &lt;div class=\"icon placeholder--shimmer\"&gt;&lt;/div&gt;\n                    &lt;span class=\"placeholder--shimmer placeholder--line\" style=\"width: 60%\"&gt;&lt;/span&gt;                \n                &lt;/li&gt;\n            {{/times}}\n        &lt;/ul&gt;\n    &lt;/div&gt;\n&lt;/content&gt;\n</code></pre> <p>Use CSS classes <code>placeholder--shimmer</code> and <code>placeholder--line</code> to build your placeholders. Basically, you can reuse the same HTML structure as your template content markup, but using these these classes instead to fill areas.</p> <p>If no placeholder is present in the template, a default one will be loaded.</p>"},{"location":"extensibility/templating/#microsoft-graph-toolkit","title":"Microsoft Graph Toolkit","text":"<p>The Microsoft Graph Toolkit is a collection of reusable, framework-agnostic web components and helpers for accessing and working with Microsoft Graph. The components are fully functional right of out of the box, with built in providers that authenticate with and fetch data from Microsoft Graph.</p> <p>In the solution, you can use Graph Tookit components whitout the need to re-authenticate against Microsoft Graph because the Web Parts already use the SharePoint provider.</p> <p>Refer to the official documentation to see all available components. For instance, we use the Microsoft Graph Toolkit for the people layout via <code>&lt;mgt-person&gt;</code>.</p>"},{"location":"extensibility/templating/#build-templates-with-item-selection","title":"Build templates with item selection","text":"<p>If your template requires items selection for dynamic filtering, you can follow these guidelines to design your template structure. The item selection feature is based on the Office Fluent UI Selection component and custom <code>data</code> attributes.</p> <p>The available data attributes you can use in your HTML template are:</p> <ul> <li> <p><code>data-selection-index</code>: the index of the item being represented. This would go on the root of the tile/row. </p> </li> <li> <p><code>data-selection-toggle</code>: this boolean flag would be set on the element which should handle toggles.This could be a checkbox or a div.</p> </li> <li> <p><code>data-selection-toggle-all</code>: this boolean flag indicates that clicking it should toggle all selection.</p> </li> <li> <p><code>data-selection-disabled</code>: allows a branch of the DOM to be marked to ignore input events that alter selections.</p> </li> <li> <p><code>data-selection-select</code>: allows a branch of the DOM to ensure that the current item is selected upon interaction.</p> </li> </ul> <p>As item key you must use the builtin Handlebars <code>{{@index}}</code> property in the <code>{{#each}}</code> loop. Also because state managed is internaly managed by the Web Part, we provide you an Handlebars helper <code>isItemSelected</code> to help to apply styles depending of the selection (ex: apply a CSS class or not). To use this helper correctly, you must pass the current selected keys and current index to get the selected state for an item:</p> <pre><code>(isItemSelected @root.selectedKeys @index)\n</code></pre> <p>Template example with item selection</p> <pre><code>&lt;style&gt;\n\n    .selected {\n        background-color: {{@root.theme.palette.themeLighter}};\n        border: 1px solid {{@root.theme.palette.themePrimary}};\n        color: {{@root.theme.palette.themePrimary}};\n    }\n    ...\n\n&lt;/style&gt;\n...\n{{#each data.items as |item|}}\n    &lt;div class=\"{{#if (isItemSelected @root.selectedKeys @index)}}selected{{/if}}\" data-is-focusable data-selection-index=\"{{@index}}\" data-selection-toggle&gt;\n        &lt;span&gt;{{slot item @root.slots.Title}}&lt;/span&gt;\n    &lt;/div&gt;\n{{/each}}\n</code></pre> <p>Note</p> <ul> <li>Item selection is only available with Handlebars templates (not with Adaptive Cards).</li> <li>If you allowed multi items selection, you must use <code>CTRL</code> + <code>Left click</code> to select multiple elements. You can also select a range of elements using <code>SHIFT</code> + <code>Left click</code>.</li> </ul>"},{"location":"extensibility/templating/#adaptive-cards-customizations","title":"Adaptive cards customizations","text":"<p>As defined by Microsoft:</p> <p>\"Adaptive Cards are platform-agnostic snippets of UI, authored in JSON, that apps and services can openly exchange. When delivered to a specific app, the JSON is transformed into native UI that automatically adapts to its surroundings. It helps design and integrate light-weight UI for all major platforms and frameworks.\"</p> <p>This new way of displaying data can be used in the Modern Data Visualizer solution as well.</p> <p>You can use the adaptive cards builder to create your template https://www.adaptivecards.io/designer/.</p>"},{"location":"extensibility/templating/#use-web-components-and-html-markup-in-adaptive-cards","title":"Use web components and HTML markup in adaptive cards","text":"<p>Web components and HTML are supported in adaptive cards through markdown processing. To use it simply, add your HTML markup in the text property. Example:</p> <pre><code>...\n{\n\"type\": \"Column\",\n\"items\": [\n{\n\"type\": \"TextBlock\",\n\"wrap\": true,\n\"text\": \"&lt;aequos-iconfile class='icon' data-extension='${string(jPath($data, concat('.',$root.slots['FileType']))[0])}'&gt;&lt;/aequos-iconfile&gt;\"\n}\n],\n\"width\": \"auto\"\n}\n...\n</code></pre> <p>HTML in adaptive cards will be sanitized.</p>"},{"location":"extensibility/templating/#reference-a-slot-in-a-adaptive-card","title":"Reference a slot in a adaptive card","text":"<p>Since it is not possible to create custom functions with adaptive cards templates right now, slots values can only be accessed using the builtin <code>jPath</code> function and the following syntax:</p> <p><code>${string(jPath($data, concat('.',$root.slots['&lt;your_slot_name&gt;']))[0])}</code></p> <p>Explanation</p> <ul> <li><code>string()</code> is here to make sure the result of the jPath expression will always be a string. If omitted, if the slot provided (i.e. the object path) doesn't exist, it will return <code>null</code> causing a render error. The <code>jPath</code> function always returns an array.</li> <li><code>jPath(&lt;data&gt;, concat('.', $root.slots['&lt;your_slot_name&gt;']))</code> where <code>&lt;data&gt;</code> is the JSON object used to resolve the slot. When looping through <code>items</code>, use the <code>$data</code> token representing the current item with properties. The expression <code>concat('.', $root.slots['&lt;your_slot_name&gt;']))</code> is to comply with the jPath syntax: every property path should be begin with a '.' (See the official jPath documentation).</li> </ul>"},{"location":"extensibility/templating/#styling-your-adaptive-cards","title":"Styling your adaptive cards","text":"<p>When selecting the adaptive cards mode, you can also setup styles through the host configuration. </p> <p>From the official Microsoft documentation: </p> <p>\"HostConfig is a cross-platform configuration object that specifies how an Adaptive Card Renderer generates UI.\".</p>"},{"location":"extensibility/web_components_list/","title":"Builtin web components","text":"<p>Here are the list of all reusable web components you can use to customize your templates. </p> <ul> <li>&lt;aequos-iconfile&gt;</li> <li>&lt;aequos-documentcard&gt;</li> <li>&lt;aequos-filepreview&gt;</li> <li>&lt;aequos-icon&gt;</li> <li>&lt;aequos-panel&gt;</li> <li>&lt;aequos-collapsible&gt;</li> <li>&lt;aequos-persona&gt;</li> <li>&lt;aequos-sortfield&gt;</li> </ul> <p>Info</p> <p>All other web components you will see in builtin layout templates are considered internal and are not supported for custom use.</p> <p>All components have an optional <code>data-theme-variant</code> attribute used to set the theme for your internal React components (for instance using Office UI Fabric). This value is typically retrieved from the root Handlebars context and reflect the current section theme where the Web Part belongs. If not set, the theme of current site will be used as fallback and may not corespond to the current section theme.</p>"},{"location":"extensibility/web_components_list/#icon-file","title":"Icon file","text":"<p>Example</p> DescriptionUsage <p>Render a file icon according to an extension.  </p> <pre><code>&lt;aequos-iconfile \n    data-extension=\"docx\" \n    data-is-container=\"false\" \n    data-size=\"32\"&gt;\n&lt;/aequos-iconfile&gt;\n</code></pre> Parameter Description data-extension The file extension to render. data-is-container If <code>true</code> or <code>1</code>, the icon will be a folder. data-size The size of the icon to display."},{"location":"extensibility/web_components_list/#document-card","title":"Document card","text":"<p>Example</p> DescriptionUsage <p>Render a document card.</p> <p></p> <pre><code>&lt;aequos-documentcard \n    data-location=\"&amp;lt;a href=\\&amp;quot;https://...\\&amp;quot;&amp;gt;Title&amp;lt;/a&amp;gt;\"\n    data-title=\"Title\"\n    data-preview-image=\"https://...\" \n    data-preview-url=\"https://...\" \n    data-date=\"01/01/2020\" \n    data-href=\"https://...\" \n    data-author=\"David Lopez\" \n    data-profile-image=\"/_layouts/15/userphoto.aspx?size=L&amp;username=david.lopez@contoso.com\" \n    data-file-extension=\"docx\"\n    data-enable-preview=\"true\" \n    data-is-container=\"false\"\n    data-show-file-icon=\"true\"&gt;`\n&lt;/aequos-documentcard&gt;\n</code></pre> Parameter Description data-location The document card location. HTML is allowed here. You must encode the string for this scenario. data-title The document card title. data-preview-image The preview image URL for the card. data-preview-url The preview URL for the card. data-href The URL for the card title. data-author The author to display. data-profile-image The profile image URL for the author if any. data-file-extension The document card file extension if any. data-enable-preview If the card supports preview. If <code>true</code>, a preview URL + preview image URL should be set. data-is-container If <code>true</code> or <code>1</code>, the file icon will be a folder icon. show-file-icon If <code>true</code> or <code>1</code>, the file icon will be hidden/displayed."},{"location":"extensibility/web_components_list/#file-preview","title":"File preview","text":"<p>Example</p> DescriptionUsage <p>Render file preview in a callout when the wrapped element is clicked. The wrapped element can be anything (text, image, etc.)</p> <p></p> <pre><code>&lt;aequos-filepreview \n    data-preview-url=\"https://...\" \n    data-preview-image-url=\"https://...\"&gt;\n    &lt;span&gt;Wrapped element&lt;/span&gt;\n&lt;/aequos-filepreview&gt;\n</code></pre> Parameter Description data-preview-image The preview image URL for the callout displayed while the preview is loading in a iframe (optional). data-preview-url The preview URL for the element in the callout."},{"location":"extensibility/web_components_list/#icon","title":"Icon","text":"<p>Example</p> DescriptionUsage <p>Display an Office UI Fabric icon.</p> <p></p> <pre><code>&lt;aequos-icon data-name=\"Tag\" aria-hidden=\"true\"&gt;&lt;/aequos-icon&gt;\n</code></pre> Parameter Description data-name The Office UI Fabric icon name to display (case sensitive)."},{"location":"extensibility/web_components_list/#panel","title":"Panel","text":"<p>Example</p> DescriptionUsage <p>Display a panel with (<code>panel-content</code>) content when the associated outer <code>panel-open</code> element is clicked.</p> <p></p> <pre><code>&lt;aequos-panel   \n    data-state-key=\"{{@root.instanceId}}\"\n    data-disable-animation=\"true\"\n    data-is-light-dismiss=\"true\"\n    data-is-blocking=\"true\"\n    data-size=\"2\"\n    data-panel-header-text=\"Panel header!\"&gt;\n\n    &lt;template id=\"panel-open\"&gt;\n        &lt;!-- All the content here will be wrapped with an onclick event opening/hiding the panel --&gt;\n\n        Click me!\n    &lt;/template&gt;\n\n    &lt;template id=\"panel-content\"&gt;\n        &lt;!-- Panel content goes here --&gt;\n\n        Panel content!\n    &lt;/template&gt;\n\n&lt;/aequos-panel&gt;\n</code></pre> Parameter Description data-state-key An unique ID for the panel component. This value is used to store the current open state. You can use any value here or a unique ID coming from the contexte like <code>{{@root.instanceId}}</code> data-disable-animation Disable the panel opne/close animation. data-is-light-dismiss If <code>true</code>, dismiss the panel when the user clicks outside of the panel area. data-is-blocking If <code>true</code>, the modal show as modal. data-size The size of the panel. See Office Fluent UI for valid values. data-theme-variant The current Microsoft 365 them. Itended to work with <code>{{JSONstringify @root.theme}}</code>. data-panel-header-text The header text in the panel. <p>Important</p> <p>Since release 1.3.0 the parameter <code>data-is-open</code> is deprecated.</p>"},{"location":"extensibility/web_components_list/#collapsible","title":"Collapsible","text":"<p>Example</p> DescriptionUsage <p>Expand/collapse the <code>collapsible-content</code> content when the text with <code>data-group-name</code> is clicked.</p> <p></p> <pre><code>&lt;aequos-collapsible \n    data-group-name=\"Collapsible content\" \n    data-default-collapsed=\"true\"&gt;\n\n    &lt;template id=\"collapsible-header\"&gt;\n        &lt;div&gt;\n            My header!\n        &lt;/div&gt;\n    &lt;/template&gt;\n\n    &lt;template id=\"collapsible-content\"&gt;\n        &lt;div&gt;\n            My Content!\n        &lt;/div&gt;\n    &lt;/template&gt;\n\n    &lt;template id=\"collapsible-footer\"&gt;\n        &lt;div&gt;\n            My Footer!\n        &lt;/div&gt;\n    &lt;/template&gt;\n\n&lt;/aequos-collapsible&gt;\n</code></pre> Parameter Description data-default-collapsed If the content should be collapsed by default <code>true/false</code>. data-group-name The header group name for expand/collapse."},{"location":"extensibility/web_components_list/#persona-card","title":"Persona card","text":"<p>Example</p> DescriptionUsage <p>Display a persona item with relevant information.</p> <p></p> <pre><code>&lt;aequos-persona\n    data-image-url=\"/_layouts/15/userphoto.aspx?size=L&amp;username=david.lopez@contoso.com\"\n    data-primary-text=\"David Lopez\"\n    data-secondary-text=\"Unknown\"\n    data-tertiary-text=\"\"\n    data-optional-text=\"514 928 0000\"\n    data-persona-size=\"\" &gt;\n&lt;/aequos-persona&gt;\n</code></pre> Parameter Description data-image-url The persona image URL. data-primary-text The primary text (ex: person display name). data-secondary-text The secondary text to display (ex: job title). data-tertiary-text The tertiary text to display (ex: work phone). data-optional-text The optional text to display. data-persona-size The size of the persona item to display (no only the picture). Valid values are <ul><li>tiny = 0</li><li>extraExtraSmall = 1</li><li>extraSmall = 2</li><li>small = 3</li><li>regular = 4</li><li>large = 5</li><li>extraLarge = 6</li></ul>"},{"location":"extensibility/web_components_list/#sort-field","title":"Sort Field","text":"<p>Example</p> DescriptionUsageLimits <p>Render a sort dropdown to sort the data results.  </p> <pre><code>&lt;aequos-sortfield \n    data-fields='[\"Author\",\"Filename\"]' \n    data-default-selected-field=\"Author\" \n    data-default-direction=\"1\"&gt;\n&lt;/aequos-sortfield&gt;\n</code></pre> Parameter Description data-fields The array of Sort fields. data-default-selected-field The default sort field. data-default-direction If <code>1</code>, the default direction will be ascending, if <code>2</code>, it will be descending. data-theme-variant The current Microsoft 365 theme. Itended to work with {{JSONstringify @root.theme}}. <p>For SharePoint and Microsoft data sources, only below Sortable fields are allowed.</p> <p>'AADObjectID', 'Author', 'ClassificationLastScan', 'ClickStreamClickedCount', 'ClickStreamLastClickCount', 'ClickStreamSkippedCount', 'ClickStreamSkippedCount', 'CommunityMembersCount', 'CommunityRepliesCount', 'CommunityTopicsCount', 'ComplianceTag', 'ComplianceTagWrittenTime', 'Created', 'DMSDocAccessRight', 'DMSDocAuthor', 'DMSDocTitle', 'DetectedLanguageRanking', 'DocumentAnalyticsLastActivityTimestamp', 'DocumentAnalyticsLastActivityTimestamp', 'EndDateOWSDATE', 'EventDateOWSDATE', 'EventRate', 'EventsRollUpEndDate', 'EventsRollUpStartDate', 'ExpirationTime', 'FileExtension', 'Filename', 'FirstName', 'FirstPublishedDate', 'IRMProtected', 'IRMTemplateName', 'InboundLinkCount', 'IsExternalContent', 'LastModifiedTime', 'LastModifiedTimeForRetention', 'LastName', 'LevelsToTop', 'ModifiedBy', 'ModifierAADIDs', 'NonWordBrokenComplianceTag', 'ProductCatalogGroupNumberOWSTEXT', 'PromotedState', 'QLogClicks', 'QLogLastClicks', 'QLogSiteClicks', 'QLogSiteLastClicks', 'QLogSiteSkips', 'QLogSkips', 'RecentViewCount', 'RecentViewCount', 'RecsClickedLifeTime', 'RecsClickedRecent'.        </p>"},{"location":"getting_started/connections_chart/","title":"Connections overview","text":""},{"location":"getting_started/connections_chart/#connection-diagram-between-web-parts","title":"Connection diagram between Web Parts","text":"<p>The included Web Parts can be connected together to create a complete search center according to this schema:</p> <p></p> <p>The connection between a Data Visualizer and Data Filters is a two-ways connection. All other connection are one-way.</p>"},{"location":"getting_started/sample_scenarios/","title":"Sample scenarios","text":"<p>Wondering what you can do with this solution? Here are some demo videos and tutorials of common usage scenarios for the Data Visualizer solution. </p> <ul> <li>Build a complete search center</li> <li>Build a people directory using the Microsoft Graph data source</li> <li>Build a people directory using alphabetical verticals and SharePoint Search data source</li> <li>Use static taxonomy filters with the SharePoint search data source</li> </ul> <p>You can see all these videos on our official Youtube channel!</p>"},{"location":"getting_started/tutorials/","title":"Tutorials & How-Tos","text":"<p>To help you to get started with the countless combinations you can have with the MDV solution, we provide you some prebuilt scenarios and how-tos. </p> <p>Tutorials provide complete step-by-step confgurations for common enteprise secenarios and \"how-to\" format focuses on specific needed configurations for a granular, particular use case</p> <p> From the aequos team</p> Tutorial Description Build a complete search center Learn how to build a complete custom search center leveraging all components from MDV Build a people directory using alphabetical verticals, Microsoft Graph data source and adaptive expressions Learn how to build a people directory for your organization usin Microsoft Graph. Build a people directory using alphabetical verticals and SharePoint Search data source Same as above but using SharePoint search data source. Build a teams search app using aequos MDV, Microsoft Graph extensions, and SharePoint taxonomy Learn how to build a specific search interface for your Teams using custom metadata. Use taxonomy filters with SharePoint search data source Learn how to use taxonomy based filters with SharePoint search data source. Build taxonomy tag filters bar using Data Visualizer Web Part item selection capability Build a filter bar using taxonomy terms and item selection feature. <p> From the PnP community</p> <p>You can also refer to scenarios made by the community for the PnP Modern Search v4 solution.</p>"},{"location":"getting_started/tutorials/#how-tos","title":"How-Tos","text":"How to: Use the taxonomy picker with OData/SharePoint REST API data source <ol> <li> <p>Add a 'Data Visualizer' Web Part on the page amd select the 'OData' data source and then  SharePoint REST API</p> </li> <li> <p>In the Url field, use the following query :</p> </li> </ol> <pre><code>https://&lt;your_site&gt;/_api/web/Lists/GetByTitle('&lt;yout_list_title&gt;')/Items?&amp;$select=*${if(empty('{filters}'),'',concat(\"&amp;$filter=\", buildOdataFilterCondition(json('{filters}'))))}\n</code></pre> <ol> <li>Add a 'Data Filters' Web Part on the page an configure the filters like this using the <code>TaxCatchAll/IdforTerm</code>:</li> </ol> <p></p>"},{"location":"getting_started/tutorials/build_complete_search_center/","title":"Build a complete search center","text":"<p>In this tutorial video, we show you how to create a complete search center in a SharePoint page using the full solution Web Parts set (Search Box, Data Filters, Data Visualizer and Data Verticals). This is a typical scenario when you want to bypass the OOTB SharePoint search page limitations and integrate with your own information architecture.</p> <p>Questions, issues with this tutorial?</p> <p>If you encouter issues or have questions about this tutorial don't hesitate to reach us using our official GitHub repository.</p>"},{"location":"getting_started/tutorials/build_complete_search_center/#video-tutorial","title":"Video tutorial","text":""},{"location":"getting_started/tutorials/build_people_directory_graph/","title":"Build a people directory using alphabetical verticals, SharePoint Search data source and adaptive expressions","text":"<p>A classic use case in a SharePoint portal. This time, instead of using the SharePoint search data source, we use the Microsoft Graph and the People API to lookup relevant people based on search box Web Part input keywords. We also add alphabetical filters as verticals and take advantage of the adaptive expressions feature to write a dynamic query.  </p> <p>Questions, issues with this tutorial?</p> <p>If you encouter issues or have questions about this tutorial don't hesitate to reach us using our official GitHub repository.</p>"},{"location":"getting_started/tutorials/build_people_directory_graph/#video-tutorial","title":"Video tutorial","text":""},{"location":"getting_started/tutorials/build_people_directory_graph/#step-by-step-tutorial","title":"Step-by-step tutorial","text":"<ol> <li> <p>Add the 'Search Box' Web Part on the page.</p> <p> </p> </li> <li> <p>Add the 'Data Verticals' Web Part on the page.</p> <p> </p> </li> <li> <p>For each alphabetical letter, add and configure a new vertical. As the value use <code>&lt;Letter&gt;</code>. Example <code>A</code> for letter 'A'. You can also add an 'All' tab with an empty value.</p> <p> </p> <p> </p> </li> <li> <p>Add a new 'Data Visualizer' Web Part on the page.</p> <p> </p> </li> <li> <p>Select the 'OData' data source and then 'Microsoft Graph'.</p> <p></p> </li> <li> <p>Enter the following query and press 'Apply': </p> <pre><code>https://graph.microsoft.com/v1.0/users?$top={itemsCountPerPage}&amp;$count=true${if(empty('{inputQueryText}'),'','&amp;$search=\"displayName:{inputQueryText}\"')}${if(empty(\"{verticals.value}\"),'',\"&amp;$filter=startsWith(displayName,'{verticals.value}')\")}\n</code></pre> <p>Explanations:</p> <ul> <li><code>https://graph.microsoft.com/v1.0/users</code>: Microsoft graph endpoint to retreive users from Azure Active Directory.</li> <li><code>?$top={itemsCountPerPage}</code>: Limits the number of results dynamically according the the number configured in the Web Part (<code>{itemsCountPerPage}</code>).</li> <li><code>&amp;$count=true</code>: Returns the number of total results for the query (not the same as the current number of displayed results).</li> <li><code>${if(empty('{inputQueryText}'),'','&amp;$search=\"displayName:{inputQueryText}\"')}</code>: Adaptive expression to conditionally add the <code>search=</code> parameter if the input query text is not empty. Making a request with an empty text will fail otherwise. This conditions is here to cover the All scenario in verticals tab.</li> <li><code>${if(empty(\"{verticals.value}\"),'',\"&amp;$filter=startsWith(displayName,'{verticals.value}')\")}</code>: Adaptive expression to conditionally filter on the current selected vertical tab value if present (for instance when 'A' is selected, only filter users with the display name starts with 'A').</li> </ul> </li> <li> <p>In the 'Headers' option, add the value <code>\"ConsistencyLevel\": \"eventual\"</code> to HTTP headers. This is needed by the Microsoft Graph API to get the count correctly:</p> <p></p> </li> <li> <p>In the 'Connections' property pane configuration page</p> <ul> <li> <p>Connect the 'Search Box' Web Part:</p> <p></p> </li> <li> <p>Connect the 'Data Verticals' Web Part previously added. Select all the available tabs (i.e. letters). Basically it tells the Data Visualizer Web Part to be or remain visible when user clicks on any of these letters.</p> <p></p> </li> </ul> </li> <li> <p>In 'Layouts' property pane configuration page, select the 'People' layout.</p> <p></p> <p>Optionally, in the layout options, you can check 'Show persona card on hover' option. To get it work, an administrator needs to approve required API permissions.</p> </li> <li> <p>Save your page. You can now filter people based on alphabetical letters using their first name or view all users.</p> <p></p> </li> </ol>"},{"location":"getting_started/tutorials/build_people_directory_sharepoint_search/","title":"Build a people directory using alphabetical verticals and SharePoint Search data source","text":"<p>This tutorial gives you basic steps to achieve a people directoy using alphabetical letters and the SharePoint search data source:</p> <p>Questions, issues with this tutorial?</p> <p>If you encouter issues or have questions about this tutorial don't hesitate to reach us using our official GitHub repository.</p>"},{"location":"getting_started/tutorials/build_people_directory_sharepoint_search/#video-tutorial","title":"Video tutorial","text":""},{"location":"getting_started/tutorials/build_people_directory_sharepoint_search/#step-by-step-tutorial","title":"Step-by-step tutorial","text":"<ol> <li> <p>Add the 'Data Verticals' Web Part on the page.</p> <p> </p> </li> <li> <p>For each alphabetical letter, add and configure a new vertical. As the value use <code>&lt;Letter&gt; + *</code>. Example <code>A*</code> for letter 'A'. You can also add an 'All' tab by specifying <code>*</code> as value.</p> <p> </p> </li> <li> <p>Add a new 'Data Visualizer' Web Part on the page.</p> <p> </p> </li> <li> <p>Select the 'SharePoint Search' data source.</p> <p> </p> </li> <li> <p>In the 'Connections' property pane configuration page, connect the 'Data Verticals' Web Part previously added. Select all the available tabs (i.e. letters). Basically it tells the Data Visualizer Web Part to be or remain visible when user clicks on any of these letters.</p> <p> </p> </li> <li> <p>In 'Layouts' property pane configuration page, select the 'People' layout.</p> <p></p> <p>Optionally, in the layout options, you can check 'Show persona card on hover' option. To get it work, an administrator needs to approve required API permissions.</p> <p></p> </li> <li> <p>In the 'Data source' property pane configuration page, select the 'LocalPeopleResults' Result Source and update the Query Template property with the <code>{searchTerms} FirstName:{verticals.value}</code> expression. </p> <p></p> <p>This expression is given as an example. You can use the <code>{verticals.value}</code> token anywhere in the query according to your requirements. The value will be simply replaced dynamically.</p> </li> <li> <p>Save your page. You can now filter people based on alphabetical letters using their first name.</p> <p></p> <p>You can then add a 'Search Box' or 'Data Filters' Web Parts to complete the experience.</p> </li> </ol>"},{"location":"getting_started/tutorials/build_tag_picker_item_selection/","title":"Build taxonomy tag filters bar using Data Visualizer Web Part item selection capability","text":"<p>This tutorial shows you how to build a tag filters bar based on SharePoint taxonomy to quickly filter your content dynamically without the need of the Data Filters Web Part. As an example and to showcase the item selection feature, we will build a news carousel filterable by managed metadata tags on an intranet home page.</p> <p></p> <p>Note</p> <p>The connection between Data Visualizer Web Parts is only available from the 1.4.0 version.</p>"},{"location":"getting_started/tutorials/build_tag_picker_item_selection/#setup-sharepoint-site","title":"Setup SharePoint site","text":"<ol> <li> <p>On a SharePoint site, create some news pages and classify them with a managed metadata column (ex: \"Department\"):</p> <p></p> <p></p> <p>Note</p> <p>Don't forget to publish your news to get them indexed by the SharePoint search engine.</p> </li> <li> <p>At site collection level, create a search managed property based on this managed metadata column (ex: \"RefinableString05\"):</p> <p> </p> <p>Note</p> <p>Use the <code>ows_taxId_&lt;column_name&gt;</code> format for the mapped search crawled property.</p> </li> </ol>"},{"location":"getting_started/tutorials/build_tag_picker_item_selection/#configure-web-parts","title":"Configure Web Parts","text":"<ol> <li> <p>On a SharePoint page, add a new Data Visualizer Web Part to lookup the site news with the following configuration:</p> <ul> <li>Data source: SharePoint Search with query template <code>Path:{site.absoluteUrl}/SitePages/news IsDocument:1</code>. This will get only the site news of the current site.</li> </ul> <p> </p> <ul> <li>Enable the Enable localization option on the first Web Part configuration page.</li> <li>In the slots configuration, for the 'Tags' slot, use the <code>Auto</code> prefix + your search managed property name or alias created earlier (ex: <code>AutoRefinableString05</code>). Press 'Enter' to validate the value.</li> </ul> <p> </p> <p>Using the default 'Cards' layout, you should see something like this:</p> <p> </p> </li> <li> <p>On the same page, add a second Data Visualizer Web Part above the first one with the following configuration:</p> <ul> <li>Data source: OData (Microsoft Graph) with the following URL <code>https://graph.microsoft.com/beta/termStore/sets/&lt;your_term_set_id&gt;/children?$top=5</code>. </li> </ul> <p> </p> <p>You must replace <code>&lt;your_term_set_id&gt;</code> with the id of the taxonomy term set used to classify the news:</p> <p> </p> <p>Note</p> <p>To get it work, the <code>TermStore.Read.All</code> Microsoft Graph permission should be approved at tenant level.</p> <ul> <li>In the slots configuration, for the 'Title' use the following value <code>labels[0:]{.languageTag === \"en-US\"}.name</code>. Press 'Enter' to validate. This will get only label for the English language as item title.</li> </ul> <p></p> <ul> <li> <p>Layouts: use the 'Custom' layout option with the following filter template .html content (open the webpage source code in your browser to access the content).</p> </li> <li> <p>In the 'Common' section of the layout page configuration, allow the item selection:</p> </li> </ul> <p></p> <p>You should see your taxonomy terms like this:</p> <p></p> </li> <li> <p>Go back to the first Data Visualizer Web Part displaying the news and go to the third configuration page regarding connections. Configure the connection with the other Data Visualizer like this:</p> <p></p> </li> <li> <p>Save the page. You can now filter news dynamically based on taxonomy tags dynamically!</p> <p></p> <p>Note</p> <p>If you allowed multi items selection, you must use <code>CTRL</code> + <code>Left click</code> to select multiple elements. You can also select a range of elements using <code>SHIFT</code> + <code>Left click</code>.</p> </li> </ol>"},{"location":"getting_started/tutorials/build_teams_search_portal_using_taxonomy/","title":"Build a teams search app using aequos MDV, Microsoft Graph extensions, and SharePoint taxonomy","text":"<p>In this step-by-step tutorial, we demonstrate how to build a search center allowing to browse teams from Microsoft Teams using a dedicated application, SharePoint taxonomy terms, and aequos MDV.</p> <p></p> <p>Questions, issues with this tutorial?</p> <p>If you encounter issues or have questions about this tutorial, don't hesitate to reach us using our official GitHub repository.</p> <p>Why classify teams?</p> <p>In Microsoft Teams, there is no tagging mechanism to add custom metadata directly to a team, for instance, the type of team, related department, or even the topic. The only metadata you get is the display name and the description. It results in a poor out-of-the-box search and filtering experience in the Microsoft Teams application (web or desktop) and doesn't really help users to quickly find a relevant team when needed. This statement is even more true when an organization has a huge amount of teams and/or users are members of several teams.</p> <p></p> <p>In real-world scenarios, companies often have a well-defined information architecture in place and leverage SharePoint taxonomy to handle this kind of classification. The solution to bypass the Microsoft Teams limitation is generally to maintain a SharePoint list containing all created teams and use SharePoint taxonomy columns as metadata for those teams (i.e. list items). This approach works well but has a major pitfall: you need to synchronize this list every time a team is updated/created/removed. This constraint can be cumbersome at some point giving the fact Microsoft Teams doesn't offer hooks for this type of event meaning you will have to pull this information on a regular basis. Not very optimal and requires dedicated infrastructure.</p> <p>What if you could just tag your teams and filter them directly, live, from a SharePoint page or Teams application and without the need to synchronize anything?. This is precisely what you can achieve with the Modern Data Visualizer solution combined with few configurations.</p> <p>The technologies used for this tutorial are:</p> <ul> <li>Microsoft Graph schema extensions (to add custom properties to teams)</li> <li>SharePoint taxonomy (to define classification values)</li> <li>aequos Modern Data Visualizer solution (for the search experience)</li> </ul>"},{"location":"getting_started/tutorials/build_teams_search_portal_using_taxonomy/#step-1-create-taxonomy-term-sets","title":"Step 1: Create taxonomy term sets","text":"<p>For this example, we will create two SharePoint taxonomy term sets for our teams' classification. Go to the SharePoint term store and create the following term sets and terms:</p> <ul> <li>\"Group type\": the type of team created (Project, Community, Organizational)</li> <li> <p>\"Department\": the organization department associated with the team</p> <p></p> </li> </ul>"},{"location":"getting_started/tutorials/build_teams_search_portal_using_taxonomy/#step-2-create-microsoft-graph-schema-extensions","title":"Step 2: Create Microsoft Graph schema extensions","text":"<p>To be able to set custom metadata for your Teams, you will need first to create a Microsoft Graph schema extension on the underlying <code>group</code> resource. Microsoft Graph extensions are a way provided by Microsoft to add custom data on Microsoft 365 resources (ex: <code>group</code>, <code>user</code>, etc.)</p> <p>Why use a schema extension instead of an open extension?</p> <p>Simply because only schema extension can be filtered using the OData <code>$filter</code> expression. To build a search center, this could be pretty useful ;).</p> <p>Warning</p> <p>As of today, Microsoft Schema extensions does not support complex property types like arrays and string values are limited to 256 characters. It means teams can only be tagged with a single value per metadata.</p>"},{"location":"getting_started/tutorials/build_teams_search_portal_using_taxonomy/#create-a-schema-extension-using-microsoft-graph-explorer","title":"Create a schema extension using Microsoft Graph Explorer","text":"<ul> <li> <p>In the same Azure Tenant where the teams you want to tag belong, create a blank Azure AD application and save its ID for later.</p> <p>Info</p> <p>There is no need to configure any permissions for this application.</p> <p></p> <p></p> </li> </ul> <p>To be able to create a schema extension in Microsoft Graph, you need to \"prove\" you actually own a tenant to use it. This is done by providing a unique ID of an Azure AD application in your Active Directory at extension creation time (in the <code>owner</code> property). This application doesn't need to do more than just exist in the tenant.</p> <ul> <li>Open the Microsoft Graph Explorer and connect with a Microsoft 365 global administrator account</li> <li>In the URL input enter <code>https://graph.microsoft.com/v1.0/schemaExtensions</code> and <code>POST</code> for the HTTP method</li> <li> <p>On the 'Modify permissions' tab, consent to the listed permissions:</p> <p></p> </li> <li> <p>In the 'Request body' tab, use the following body payload with your information and press 'Run Query':</p> </li> </ul> <pre><code>{\n\"id\": \"aequosGroupMetadata\", // Your extension name\n\"description\": \"Extension for Microsoft 365 groups custom metadata\",\n\"targetTypes\": [\n\"Group\"\n],\n\"status\": \"InDevelopment\",\n\"owner\": \"7e49583b-80e1-4ea7-8bc5-xxxxxxxxx\", // Replace with your own Azure AD application ID\n\"properties\": [\n{\n\"name\": \"groupType\",\n\"type\": \"String\"\n},\n{\n\"name\": \"groupTypeAsText\",\n\"type\": \"String\"\n},\n{\n\"name\": \"groupDepartment\",\n\"type\": \"String\"\n},\n{\n\"name\": \"groupDepartmentAsText\",\n\"type\": \"String\"\n}\n]\n}\n</code></pre> <p></p> <ul> <li> <p>You should see the HTTP response like this:</p> <p></p> <p>Important</p> <p>When you create your extension for the first time, you need to save its generated id as you won't be able to retrieve it afterward. Microsoft Graph extensions are shared across all tenants worldwide (only the definition, not values) so it will be very hard to get this value again.</p> </li> </ul>"},{"location":"getting_started/tutorials/build_teams_search_portal_using_taxonomy/#step-3-tag-your-teams-with-your-new-extension-and-taxonomy-values","title":"Step 3: Tag your teams with your new extension and taxonomy values","text":""},{"location":"getting_started/tutorials/build_teams_search_portal_using_taxonomy/#using-the-aequos-groupteam-metadata-web-part","title":"Using the \"aequos - Group/Team metadata\" Web Part","text":"<p>Since the <code>1.4.0</code>, we've added the aequos - Group/Team metadata editor to help you in this task. The Web Part can be used in a SharePoint page or as a tab in a team to calssify \"on-demand\". This way, team owners can directly update the team classification using taxonomy values (or not). Refer to the Web Part usage for more information.</p> <p></p> <p></p>"},{"location":"getting_started/tutorials/build_teams_search_portal_using_taxonomy/#using-microsoft-graph-explorer","title":"Using Microsoft Graph Explorer","text":"<p>If you prefer do the classification manually, you can still use the Microsoft Graph explorer tool https://aka.ms/ge or use a custom application/script to process teams as bulk. In this example, we will just show how to tag a single team using Graph Explorer. The calls remains the same for multiple teams.</p> <ul> <li>In the Microsoft Graph Explorer, get the list of your Teams using the <code>https://graph.microsoft.com/beta/groups?$filter=resourceProvisioningOptions/Any(x:x eq 'Team')</code> URL (GET) and choose one in the list you want to tag saving its <code>id</code>:</li> </ul> <p></p> <ul> <li>In the Graph Explorer, using this ID, update the group with the SharePoint taxonomy term values by using the <code>https://graph.microsoft.com/v1.0/groups/&lt;YOUR-GUID&gt;</code>. As a convention, we will use the SharePoint taxonomy term IDs as the main extension properties value and the term labels for the <code>'AsText'</code> properties:</li> </ul> <p></p> <pre><code>{\n\"extef3z6iep_aequosGroupMetadata\": {\n\"groupType\": \"&lt;YOUR-PROJECT-TERM-ID&gt;\",\n\"groupTypeAsText\": \"Project\",\n\"groupDepartment\": \"&lt;YOUR-MARKETING-TERM-ID&gt;\",\n\"groupDepartmentAsText\": \"Marketing\"\n}\n}\n</code></pre> <p>Info</p> <p>The <code>'AsText'</code> are mainly here for performances purpose as it avoids fetching the label again for the taxonomy ID in the Web Part layout.</p>"},{"location":"getting_started/tutorials/build_teams_search_portal_using_taxonomy/#step-4-build-a-sharepoint-search-page-using-the-modern-data-visualizer-web-parts","title":"Step 4: Build a SharePoint search page using the Modern Data Visualizer Web Parts","text":"<p>In a SharePoint modern site (communication or team site), create a new page using the 'Home' layout. This can be achieved using PnP PowerShell and the following cmdlets:</p> <pre><code>Connect-PnPOnline -Url https:/&lt;your_site_url&gt; -UseWebLogin\nAdd-PnPClientSidePage -LayoutType Home -Name teams-search-mdv -CommentsEnabled:$false\n</code></pre> <p>or by using the following CLI for Microsoft 365 commands:</p> <pre><code>m365 login\nm365 spo page add --name teams-search-mdv.aspx --webUrl https:/&lt;your_site_url&gt; --layoutType Home\n</code></pre> <p>We use the this layout for convenience as it fits well to build search pages.</p> <ul> <li>Add needed Graph permissions for the Modern Data Visualizer SPFx Web Parts. This can be achieved using Microsoft 365 CLI and the following commands:</li> </ul> <pre><code>m365 login\nm365 spo serviceprincipal grant add --resource 'Microsoft Graph' --scope 'GroupMember.Read.All'\nm365 spo serviceprincipal grant add --resource 'Microsoft Graph' --scope 'Channel.ReadBasic.All'\nm365 spo serviceprincipal grant add --resource 'Microsoft Graph' --scope 'User.Read'\n</code></pre> <ul> <li>Go and edit the newly created page and change the layout to be 'Vertical section':</li> </ul> <p></p> <ul> <li>On the main zone, add a Search Box Web Part:</li> </ul> <p></p> <ul> <li>On the right zone, add a Data Filters Web Part with the following configurations:</li> </ul> <p></p> <p>Data Filters Web Part configuration</p> <p></p> Display Name Filter field Template Group type &lt;your_schema_extension_name&gt;/groupType (ex: <code>exttumpwrak_aequosGroupMetadata/groupType</code>) \"Taxonomy picker\" wired to the \"Group type\" term set: Department &lt;your_schema_extension_name&gt;/groupDepartment (ex: <code>exttumpwrak_aequosGroupMetadata/groupDepartment</code>) \"Taxonomy picker\" wired to the \"Group type\" term set: <ul> <li>On the main zone, below the search box, add a new Data Visualizer Web Part with the following configurations (in this order):</li> </ul> <p>Data Visualizer Web Part configuration</p> 1. Data source2. Connections3. Layout <p>Select the \"OData\" source using Microsoft Graph:</p> <p></p> <p>Configure the source with the following values:</p> <ul> <li> <p>Url:     <pre><code>https://graph.microsoft.com/beta/me/memberOf/$/microsoft.graph.group?$top={itemsCountPerPage}&amp;$count=true&amp;$select=exttumpwrak_aequosGroupMetadata,id,displayName,description,visibility${if(empty(\"{inputQueryText}\"),'','&amp;$search=\"displayName:{inputQueryText}\" OR \"description:{inputQueryText}\"')}${if(empty('{filters}'),\"&amp;$filter=resourceProvisioningOptions/Any(x:x eq 'Team')\",concat(\"&amp;$filter=resourceProvisioningOptions/Any(x:x eq 'Team') and \", buildOdataFilterCondition(json('{filters}'))))}\n</code></pre></p> <p>You must replace the <code>exttumpwrak_aequosGroupMetadata</code> value with your own extension name created earlier. Also, don't forget to click \"Apply\".</p> <p>This URL could seem intimidating but leverages both Microsoft adaptive expressions and built-in Web Part tokens to create a dynamic query depending on the connected search box and filter values. Decorticated, the query does the following:</p> <ul> <li>Retrieve the Microsoft 365 groups where the user is a member <code>https://graph.microsoft.com/beta/me/memberOf/$/microsoft.graph.group?</code></li> </ul> <ul> <li>Return a specified number of results according to the Web Part configuration <code>$top={itemsCountPerPage}</code></li> </ul> <ul> <li>Return the number of results for the search <code>&amp;$count=true</code></li> </ul> <ul> <li>Return useful properties for a team used by the 'Teams' layout, including the custom schema extension you created earlier (to be replaced by your own value) <code>&amp;$select=exttumpwrak_aequosGroupMetadata,id,displayName,description,visibility</code></li> </ul> <ul> <li>Add a $search condition on display name and description only if a keyword is entered in the search box. Leave blank otherwise <pre><code>${\n    if(empty(\"{inputQueryText}\"),\n        '',\n        '&amp;$search=\"displayName:{inputQueryText}\" OR \"description:{inputQueryText}\"'\n    )\n}\n</code></pre></li> </ul> <ul> <li>Add a $filter condition only if filter values are present and selected. Leave blank otherwise. The <code>buildOdataFilterCondition()</code> function converts the current filter values to an OData valid <code>$filter</code> condition using 'eq' operator. <pre><code>${\n    if(empty('{filters}'),\n        \"&amp;$filter=resourceProvisioningOptions/Any(x:x eq 'Team')\",\n        concat(\"&amp;$filter=resourceProvisioningOptions/Any(x:x eq 'Team') and \", buildOdataFilterCondition(json('{filters}')))\n    )\n}\n</code></pre></li> </ul> </li> <li> <p>HTTP Method: <code>GET</code></p> </li> <li>HTTP headers:     <pre><code>{\n\"Content-Type\": \"application/json;odata=verbose\",\n\"Accept\": \"application/json\",\n\"ConsistencyLevel\": \"eventual\"\n}\n</code></pre></li> </ul> <p>Connect to the Data Filters Web Part and the Search box on the same page:</p> <p></p> <p>Select the \"Teams\" layout from the layout configuration page. In the options, select the <code>AsText</code> properties from your schema extension:</p> <p></p> <p></p> <ul> <li> <p>Connect the Data Filters Web Part to the Data Visualizer Web Part:</p> <p></p> </li> </ul> <p>Congratulations, you have now a functional search center for your teams!</p>"},{"location":"getting_started/tutorials/build_teams_search_portal_using_taxonomy/#step-5-create-a-teams-application-and-deploy-it-to-your-users","title":"Step 5: Create a Teams application and deploy it to your users","text":"<p>To fully integrate the search experience directly in Microsoft Teams, you can create a new application and deploy it globally for your users inside your organization.</p> <ol> <li> <p>Open Microsoft Teams in web or desktop mode. In the app bar, click on (...) and search for the application named \"App Studio\":</p> <p></p> </li> <li> <p>Create a new application (ex: \"Teams search\"):</p> <p></p> </li> <li> <p>Fill the required information and leave the other settings by default:</p> <p></p> Settings Example value Package Name aequos-mdv-teams-search Version 1.0.0 Short description Search center for Microsoft Teams Full description Allow users to search and filter teams in Microsoft Teams Developer/Company Name SWORD Group Website https://www.sword-group.com Privacy statement https://www.sword-group.com Terms of use https://www.sword-group.com </li> <li> <p>In the 'Tabs' section, add a personal tab with the following information:</p> Settings Example value Name Team search application Entity ID teamsSearch Content URL <code>https://&lt;your_tenant&gt;.sharepoint.com/_layouts/15/teamslogon.aspx?spfx=true&amp;dest=https://&lt;your_tenant&gt;.sharepoint.com/sites/&lt;your_sharepoint_site&gt;/SitePages/teams-search-mdv.aspx</code> <p>You must replace &lt;your_tenant&gt; and &lt;your_sharepoint_site&gt; by the values corresponding to your environment.</p> <p></p> <p></p> </li> <li> <p>In the 'Domains and premissions' section, configure the SSO setting with the following information:</p> Settings Example value AAD App ID <code>00000003-0000-0ff1-ce00-000000000000</code> (ID of the SharePoint Azure AD application. It is the same for everyone) Single-Sign-On https://&lt;your_tenant&gt;.sharepoint.com (replace by your own value) </li> <li> <p>Click 'Test and distribute' and then Install to validate the application is working. You can now package this app and deploy it for your users globally:</p> <p></p> <p></p> </li> </ol>"},{"location":"getting_started/tutorials/build_teams_search_portal_using_taxonomy/#whats-next","title":"What's next?","text":"<p>This tutorial gave you a straightforward approach to add custom metadata to your teams in Microsoft Teams. The next step is to classify all your teams accordingly using the Microsoft Graph schema extension so you can filter them using this interface. This can be achieved using multiple ways (CSV + PowerShell, SPFx extension, aequos Group/Team Metadata Editor but this is outside of the purpose of this article.</p> <p>Questions, issues with this tutorial?</p> <p>If you encounter issues or have questions about this tutorial don't hesitate to reach us using our official GitHub repository.</p>"},{"location":"getting_started/tutorials/static_taxonomy_filters_sharepoint_search/","title":"Use static taxonomy filters with the SharePoint search data source","text":"<p>Static filters don't necessarily need to be connected to a Data Visualizer Web Part. They are different from 'Refinement' filters and they just send abitrary filter values to consumer Web Parts ignoring received values from the data source. In this demo, we show you a practical use case and how to use them, for instance retrieve data from the SharePoint search according to a specific taxonomy term in a specific terms set without any prior results fetched (meaning filter values will be available at page load for initial filtering).</p> <p>Questions, issues with this tutorial?</p> <p>If you encouter issues or have questions about this tutorial don't hesitate to reach us using our official GitHub repository.</p>"},{"location":"getting_started/tutorials/static_taxonomy_filters_sharepoint_search/#video-tutorial","title":"Video tutorial","text":"<p>Static filters can be used in tokens as well for other data sources. </p>"},{"location":"usage/data-filters/","title":"Data Filters Web Part","text":"<p>The 'Data Filters' Web Part allows to filter the current results displayed in a 'Data Visualizer' Web Part. This component is higly configurable to meet you requirements and it works for all data sources.</p> <p></p> <p></p>"},{"location":"usage/data-filters/#configuration","title":"Configuration","text":""},{"location":"usage/data-filters/#connection-to-data-visualizers","title":"Connection to Data Visualizer(s)","text":"<p>To use the data filters, we must first connect it to one or multiple 'Data Visualizer' Web Parts. In the other hand, you must conenct back those Web Parts to the 'Data Filters' one. It is a two-ways connection.</p> <p> </p> <p>Note</p> <p>If you connect more than one Data Visualizer Web Part, the filter values and counts will be merged for similar filter names:</p> <p>Example</p> <p>DataSource1 and DataSource2 expose respectively a 'FileType' filter with values and counts <code>value1 (1)</code>, <code>value2 (1)</code> for DataSource1 and <code>value2 (1)</code>, <code>value4 (1)</code> for DataSource2 and both are connected to the Data Filter Web Part. In this case, an unique 'FileType' filter name will be displayed (because the filter name is the same for both data sources) with values <code>value1 (1)</code>,<code>value2 (2)</code>,<code>value4 (1)</code>. If you select a value that is not present in a data source (ex: <code>value1</code> for DataSource2), you will simply get zero result in the Web Part.</p>"},{"location":"usage/data-filters/#connection-to-data-verticals","title":"Connection to Data Verticals","text":"<p>To create a dynamic filter experience, you can also connect the Data Filter Web Part to a Data Vertical Web Part. This way filters will only be displayed if specific verticals are selected.</p> <p></p>"},{"location":"usage/data-filters/#filter-settings","title":"Filter settings","text":"<p>From the filter settings, you can customize individual filters and the operator to use between filters (OR or AND).</p> <p></p> <p>For each filter, the available options are as follow:</p> <p> </p> Setting Description Display Name A friendly name for the filter. Filter field The internal data source field to use as filter. Here you can select a field from the current data source (if data have been already retrieved) of type your own custom value (press enter to validate). Values count The maximum number of values to be retrieved for a given filter. If left empty, the values count will be defaulted to 10. This value is useful if you use SharePoint refiners with a lot of refiner values. By default SharePoint will only retreve the first 100 values. To get all refiner values, you must specify an higher number manually (maximum value is 1000). Template The template to use to display filter values. See Filter templates for more details. Filter type Specify if the filter is a 'static' filter or a 'refiner' filter. See Filter types for more information. Expand by default If applicable for the selected template, display values as expanded. Show count If applicable for the selected template, display counts for values. Mutli values If applicable for the selected template, allow selection of multiple values. Operator between values If multi values is selected, the operator to use between values (OR/AND). This value can be overriden manually by the user when using the following filter templates: <ul><li>Checkbox</li><li>Combo box</li><li>Taxonomy picker</li></ul> Sort values by Sort values by name or by count. Sort direction Sort values in ascending/descending order."},{"location":"usage/data-filters/#filter-templates","title":"Filter templates","text":"<p>The available filter templates are as follow:</p> Template Overview Checkbox Filter results as flat list of values.  Date interval Filter results according to predefined date intervals (any time, last month, last 3 months, last year and older than a year. These intevals can't be changed.  Date range Filter values from/to a start/end date.  Combo box Filter results as a dropdown list of values.  Taxonomy picker  (Configuration details) Filter results using a SharePoint taxonomy hierarchy of terms. For more information about taxonomy picker configuration, click here."},{"location":"usage/data-filters/#taxonomy-picker-template-configuration","title":"Taxonomy Picker template configuration","text":"<p>The taxonomy picker template allows you to filter data using the SharePoint Term Store using your own information architecture.</p> <p> </p>"},{"location":"usage/data-filters/#configure-the-taxonomy-picker","title":"Configure the taxonomy picker","text":"<p>To configure the taxonomyp picker, follow these steps:</p> <ol> <li> <p>From the Data Filter Web Part 'Edit' button in the Web Part property pane, select the Taxonomy picker template from the dropdown list and click on the tag icon next to it to view setings:</p> <p> </p> </li> <li> <p>Select anchor terms or term sets you want to display as filters for users. They will be displayed as root elements for the filter name in the Web Part. You have here the flexibility to mix term sets from different term groups or anchor terms from same or different term sets:</p> <p>Example with term sets:</p> <p></p> <p>Example with anchor terms</p> <p> </p> <p>Note</p> <ul> <li> <p>Even though there is no technical limitation regarding the number of anchor terms or term sets you can display as root filters, we strongly recommend to limit this number to only few items to avoid performance issues or split into multiple filters.</p> </li> <li> <p>Only items with the same type can be used as root filters (i.e. only term sets or terms, not both at the the time).</p> </li> </ul> </li> <li> <p>Configure behavior settings with the provided options:</p> <p> </p> Setting Description Item selection behavior Determine the default selection behavior when a user select the value. This settings can also be overriden per value for more flexibility:  Number of items per page Determine the number of items to show per taxonomy levels. An high value will have impact on performances.  Display search box Determine if a search box should appear in the picker letting users search for values. When an user search for values, the scope is restricted to term sets or anchor terms configured as root and does not apply to the whole term store. Also, the search is performed using the current UI language.  </li> </ol>"},{"location":"usage/data-filters/#filter-types-static-filter-versus-refiner-filter","title":"Filter types: 'Static' filter versus 'Refiner' filter","text":"<p>The Web Part supports two types of filters ('Static' and 'Refiner'). However, there are some differences that are important to understand between these two if you want to use them properly:</p> <ul> <li>Refiner: a 'Refiner' filter means the filter gets its values from the data source and sends back the selected ones the data source. If the data source has no result, there won't be any refiner values, simple as that.</li> <li>Static filter: a 'Static' filter means the filter doesn't care about filter values sent by the data source and provides its own arbitrary values regardless of input values. A date range picker or a taxonomy picker (or any picker) are good examples of what an 'Static' filter is. Such a filter do not need necessarily need a Data Visualizer connection.</li> </ul> <p>Note</p> <p>The filter type is indicated for each filter. </p>"},{"location":"usage/data-filters/#use-indexed-property-bag-properties-with-taxonomny-values","title":"Use indexed property bag properties with taxonomny values","text":"<p>This behavior only works with the SharePoint Search Data source and the Enabled localization flag activated.</p> <p>Using an indexed property bag value could be useful to store information about a SharePoint site or other element that can't be tagged with a taxonomy value directly. The 'Modern Data Visualizer' solution supports property bag properties values that use the following taxonomy value format to be able to filter on them (ex: a taxonomy multi values separated by a semicolon (;)):</p> <p><code>L0|#a2cf1afb-44b6-4cf4-bf37-642bb2e9bff3|Category 1;L0|#02e3406c0-1048-4bce-90eb-e7a51dfa7f31|Category3;L0|#07e094327-23d7-48af-9699-781eb26dc40f|Category2</code></p> <p>These taxonomy values can then be used in the Data Filters Web Part using a <code>RefinableStringXX</code> search managed property to filter specific sites or elements. As an example, you can refer to the \"Create an end-to-end Office 365 groups provisioning solution\" tutorial GitHub project to leverage this format.</p>"},{"location":"usage/data-filters/#filter-deep-linking","title":"Filter deep linking","text":"<p>The Data Filter Web Part supports deep linking, meaning you can preselect filters from the URL at page load. When filter values are selected, a query string parameter <code>f</code> is append to the current URL containing the current filter values data.</p> <p></p> <p>Important</p> <p>We recommend to use the URL generated from filter values selection instead of crafting the URL manually.</p>"},{"location":"usage/data-filters/layouts/","title":"Layouts","text":""},{"location":"usage/data-filters/layouts/#builtin-layouts","title":"Builtin layouts","text":"<p>By default, the following layouts are provided:</p> <p></p>"},{"location":"usage/data-filters/layouts/#vertical","title":"Vertical","text":"<p>Display filters as a vertical bar:</p> <p></p>"},{"location":"usage/data-filters/layouts/#horizontal","title":"Horizontal","text":"<p>Display filters as an horizontal bar. For instance, it fits nicely with 'Combo' filter templates.</p> <p></p>"},{"location":"usage/data-filters/layouts/#layout-options","title":"Layout options","text":"Setting Description Default value Preferred number of cards per row Specifiy the preferred number of filters to display per row when the required width space is available. The Web Part will always adjust the number of possible filters to display depending the available width. It means that if you set this value to '3' but you display the Web Part in small column, only 1 filter will be displayed. 3."},{"location":"usage/data-filters/layouts/#panel","title":"Panel","text":"<p>Display filters as an side panel. Useful to gain space on the page.</p> <p></p>"},{"location":"usage/data-filters/layouts/#layout-options_1","title":"Layout options","text":"Setting Description Default value Button label to display The label to display to open the panel. \"Show filters\". Panel header text The label to display to in the panel header. \"Filters\". Modal If enabled, the panel will be modal (you can't select elemtns outside the panel). True Light dismiss If enabled, dismiss the panel when click outside. True Panel size The filter panel size to display. Small (right)."},{"location":"usage/data-filters/layouts/#debug","title":"Debug","text":"<p>The 'debug' layout allows you to see all relevant data used by filter templates during render.</p> <p></p> <p>The template context object exposes the following properties:</p> <pre><code>{\n\"filters\": \"&lt;Current filters to display in the UI (selected/unseslected)&gt;\",\n\"selectedFilters\": \"&lt;The current submitted filters&gt;\",\n\"instanceId\": \"&lt;The Web Part instance ID&gt;\",\n\"theme\": \"&lt;Current theme variables&gt;\",\n\"strings\": \"&lt;Localized strings that can be used in the Web Part&gt;\",\n\"selectedOnce\": \"&lt;Flag indicating if a filter value has been selected at least once by the use&gt;\",\n\"properties\": \"&lt;The filter Web Part properties&gt;\"\n}\n</code></pre>"},{"location":"usage/data-filters/layouts/#custom","title":"Custom","text":"<p>The 'custom' layout is the minimal layout to start with if you want to create your own customized UI from scratch. You can also start from an existing layout.</p> <p></p> <p>Updating a builtin layout (ex: 'Horizontal', 'Vertical', etc.) will automatically switch the selected layout to 'Custom' with your modifications as content. All previous custom layout content will be overwritten.</p> <p> </p> <p>You have also the ability to use an external .html file to centralize your customizations. This file must be stored in an accessible location for uses (ex: a SharePoint document library with 'Read' permissions for concerned users).</p> <p> </p> <p>Unless you specify an external file, the template content is stored in the Web Part property bag.</p> <p>Updating the layout HTML template is a good option for minor UI updates (Ex: add a link, update colors, etc.). For more control over the UI, you may want to use the extensibility library feature.</p>"},{"location":"usage/data-filters/layouts/custom/","title":"Custom","text":"<p>The 'custom' layout is the minimal layout to start with if you want to create your own customized UI from scratch. You can also start from an existing layout.</p> <p></p> <p>Updating a builtin layout (ex: 'Horizontal', 'Vertical', etc.) will automatically switch the selected layout to 'Custom' with your modifications as content. All previous custom layout content will be overwritten.</p> <p> </p> <p>You have also the ability to use an external .html file to centralize your customizations. This file must be stored in an accessible location for uses (ex: a SharePoint document library with 'Read' permissions for concerned users).</p> <p> </p> <p>Unless you specify an external file, the template content is stored in the Web Part property bag.</p> <p>Updating the layout HTML template is a good option for minor UI updates (Ex: add a link, update colors, etc.). For more control over the UI, you may want to use the extensibility library feature.</p>"},{"location":"usage/data-filters/layouts/debug/","title":"Debug","text":"<p>The 'debug' layout allows you to see all relevant data used by filter templates during render.</p> <p></p> <p>The template context object exposes the following properties:</p> <pre><code>{\n\"filters\": \"&lt;Current filters to display in the UI (selected/unseslected)&gt;\",\n\"selectedFilters\": \"&lt;The current submitted filters&gt;\",\n\"instanceId\": \"&lt;The Web Part instance ID&gt;\",\n\"theme\": \"&lt;Current theme variables&gt;\",\n\"strings\": \"&lt;Localized strings that can be used in the Web Part&gt;\",\n\"selectedOnce\": \"&lt;Flag indicating if a filter value has been selected at least once by the use&gt;\",\n\"properties\": \"&lt;The filter Web Part properties&gt;\"\n}\n</code></pre>"},{"location":"usage/data-filters/layouts/horizontal/","title":"Horizontal","text":"<p>Display filters as an horizontal bar. For instance, it fits nicely with 'Combo' filter templates.</p> <p></p>"},{"location":"usage/data-filters/layouts/horizontal/#layout-options","title":"Layout options","text":"Setting Description Default value Preferred number of cards per row Specifiy the preferred number of filters to display per row when the required width space is available. The Web Part will always adjust the number of possible filters to display depending the available width. It means that if you set this value to '3' but you display the Web Part in small column, only 1 filter will be displayed. 3."},{"location":"usage/data-filters/layouts/panel/","title":"Panel","text":"<p>Display filters as an side panel. Useful to gain space on the page.</p> <p></p>"},{"location":"usage/data-filters/layouts/panel/#layout-options","title":"Layout options","text":"Setting Description Default value Button label to display The label to display to open the panel. \"Show filters\". Panel header text The label to display to in the panel header. \"Filters\". Modal If enabled, the panel will be modal (you can't select elemtns outside the panel). True Light dismiss If enabled, dismiss the panel when click outside. True Panel size The filter panel size to display. Small (right)."},{"location":"usage/data-filters/layouts/vertical/","title":"Vertical","text":"<p>Display filters as a vertical bar:</p> <p></p>"},{"location":"usage/data-verticals/","title":"Data Verticals Web Part","text":"<p>The 'Data Verticals' Web Part allows to conditionally render a 'Data Visualizer' Web Part according to the selected vertical. It is a simple way to build a complete search center including multiple sources.</p> <p></p> <p> </p>"},{"location":"usage/data-verticals/#configuration","title":"Configuration","text":"<p>The configuration of the 'Data Verticals' Web Part is fairly simple.</p> <p> </p>"},{"location":"usage/data-verticals/#configure-verticals","title":"Configure verticals","text":"<p>The options for a vertical are as follow:</p> Setting Description Tab name The vertical name (i.e. tab) Tab value The vertical value that will be sent to connected 'Data Visualizer' Web Parts. You can use this value using the <code>{verticals.value}</code> token. See tokens for more info. Fluent UIFabric icon name The optional Fluent UI icon to display for the tab. Refer to Office UI Fabric documentation to see all available icons. Is hyperlink If checked, the tab will behave as an hyperlink meaning it won't trigger any selected event. Link URL If the tab is an hyperlink, the link URL to use. Tokens <code>{&lt;TokenName&gt;}</code> are supported here. See tokens for more info. Open behavior If the tab is an hyperlink, the opening behavior (new tab or current tab). Show link icon If the tab is an hyperlink, display or hide an icon next to the tab name indicating the tab is a link (same page or external). <p>The 'Data Verticals' Web Part does not need to be connected to any Web Part. However, it is meant to be used by a 'Data Visualizer' Web Part to get it work. More info about configuration here.</p> <p>We recommend to configure the 'Data Visualizer' Web Parts that will use verticals before connecting them to the verticals Web Part.</p>"},{"location":"usage/data-visualizer/","title":"Data Visualizer Web Part","text":"<p>The 'Data Visualizer' Web Part is the fundamental building block of whole global solution. Its purpose is basically to get data from a specifc source and render them in a specific native or custom layout based on Handlebars and web components.</p> <p>This Web Part can be used alone or connected to other Web Parts to add dyanmic interactions (filters, search box or verticals). To use the Web Part on a SharePoint page:</p> <ol> <li>Edit your SharePoint modern page.</li> <li>Search for the 'aequos - Data Visualizer' Web Part and add it to your page:</li> </ol> <p></p> <p></p>"},{"location":"usage/data-visualizer/#configuration","title":"Configuration","text":"<p>The data visualizer Web Part configuration is divided into four parts each corresponding to a property pane page:</p> <ol> <li>Data source: From where to retrieve the data. Includes the slots configuration and tokens usage.</li> <li>Layouts: How to render them.</li> <li>Connections: How the Web Part will be connected to others in the page.</li> <li>Extensibility: How the Web Part will be connected to others in the page.</li> </ol>"},{"location":"usage/data-visualizer/adaptive_exressions/","title":"Adaptive expressions","text":"<p>From 1.2.x version, you can benefit from Microsoft adaptive expressions to build and/or format strings dynamically based on existing environment tokens. An adaptive expression can contain one or more explicit values, prebuilt functions, or custom functions. Refer to the official Microsoft documentation to see the compelte list.</p> <p>In the solution, they can be used wherever tokens are supported.</p> <p>A concrete example about their utility and usage is described in the Build a people directory using alphabetical verticals, SharePoint Search data source and adaptive expressions  tutorial.</p> <p>How to use them?</p> <p>An adaptive expression is always enclosed with <code>${...}</code>. Single tokens are only enclosed with <code>{...}</code> and can be included in a expression. For instance, the following expression will evaluate the <code>{inputQueryText}</code> token value and depending if it is empty or not, the output will be different.</p> <pre><code>${if(empty('{inputQueryText}'),'','&amp;$search=\"displayName:{inputQueryText}\"')}\n</code></pre> <p>Note</p> <ul> <li>Tokens enclosed with regular curly braces <code>{}</code> are always evaluated before adaptive expressions (enclosed with <code>${}</code>)</li> <li>Expressions enclosed with quotes (<code>\"</code>) will always be evaluated as constants meaning all nested functions won't be evaluated. If you want to use the result of a function output and a string, you should use the <code>concat()</code> method. Ex: instead of <code>\"myStringValue myFunction('param')\"</code>, use <code>concat(\"myStringValue\",myFunction('param'))</code>.</li> </ul>"},{"location":"usage/data-visualizer/adaptive_exressions/#use-prebuilt-functions","title":"Use prebuilt functions","text":"<p>We defined some useful functions that you can use in your adaptive expression to format the output correctly:</p>"},{"location":"usage/data-visualizer/adaptive_exressions/#odata-query","title":"OData query","text":"Functions Description Usage <code>buildOdataFilterCondition</code> Builds an OData filter condition dynamically according the current selection. Use the <code>{filters}</code> token. Example: use a multi taxonomy filter values: <code>https://graph.microsoft.com/v1.0/groups?&amp;${if(empty('{filters}'),'',concat(\"&amp;$filter=\", buildOdataFilterCondition(json('{filters}'))))}</code>."},{"location":"usage/data-visualizer/slots/","title":"Slots","text":"<p>The 'slots' are a very important part of this solution and their use becomes very handy when it comes to create your own layouts. The slots feature is available for all data sources, including builtin and custom ones.</p> <p></p>"},{"location":"usage/data-visualizer/slots/#what-is-a-slot","title":"What is a 'slot'?","text":"<p>A slot is a mapping between a data source specific field and a placeholder variable used in layout templates.</p> <p>To illustrate this concept, here are a single card from the 'Cards' layout. You can see how slots apply to the UI:</p> <p></p> <p>Slot definitions will be replaced dynamically by the underlying field values you specified in the mappings list. In the end, from a template perspective, an URL is an URL regardless of the source. Slots are used individually depending of the requirements of the chosen layout. </p>"},{"location":"usage/data-visualizer/slots/#why-i-would-need-them","title":"Why I would need them?","text":"<p>They allow you to get your data source (custom or builtin) work with all templates without the need of refactoring them and to adapt your data source specific fields. Basically, it is a convenient, time saving feature making your templates reusable.</p>"},{"location":"usage/data-visualizer/slots/#builtin-slots","title":"Builtin slots","text":"<p>Here are all the builtin slots the solution provides. </p> <p>Data sources may or may not define all these slots depending the nature of the source.</p> Slot name Description Title Typically the title of an item in results. Path The absolute URL of an item. Summary A short description of the item. Date A date associated to the item. Can be for instance, the created date, modified date or publishing date. FileType The file type. This can be an extension (ex: <code>docx</code>) or the complete path of the item including the file extension (ex: <code>https://mycompany.sharepoint.com/sites/mysite/Shared Documents/MyFile.pdf</code>). This slot is mainly used to retrieve the correct file icon for the item. PreviewImageUrl The image thumbnail URL to display for an item. You can use the builtin <code>AutoPreviewImageUrl</code> field here to get a default image if applicable. PreviewUrl Same as preview image URL but for the interactive preview of the item (ex: a Word document). You can use the builtin <code>AutoPreviewUrl</code> field here to get a default image if applicable. In this case, the Web Part will use a generic Microsoft Graph URL to generate the preview. More information on supported file types. Author An author associated to the item. Tags Tags associated to the item. Can be for instance taxonomy terms. SiteId The SharePoint site ID associated to the item. With <code>ListId</code> and <code>ItemId</code> this value is used to generate the preview URL. ListId The SharePoint site ID associated to the item. With <code>SiteId</code> and <code>ItemId</code> this value is used to generate the preview URL. ItemId The SharePoint site ID associated to the item. With <code>ListId</code> and <code>SiteId</code> this value is used to generate the preview URL. IsFolder Indicate if the current item is a folder. The value here should be a true/false value or 0/1. PersonQuery Used for the people layout to get information about the current user dynamically. More info here. UserDisplayName Used by the people layout to display the user name. UserEmail Used by the people layout to display the user email. TeamId The Microsoft Teams team ID or the Microsoft 365 group ID. Intended to be used with the Teams layout TeamVisibility The Microsoft Teams team visiblity (public/private). Intended to be used with the Teams layout <p>A slot can be empty.</p>"},{"location":"usage/data-visualizer/slots/#define-your-custom-slots","title":"Define your custom slots","text":"<p>In addition to builtin ones, you can add your own slots and use them in layouts. To do so, first add your slot in the list:</p> <p></p> <p>And then use it in your templates using the following Handlebars expression:</p> <pre><code>{{slot item @root.slots.&lt;SlotName&gt;}}\n</code></pre> <ul> <li><code>slot</code>: The Handlebars helper name.</li> <li><code>item</code>: The current item containing the field value.</li> <li><code>@root.slots.&lt;SlotName&gt;</code>: The corresponding slot mapping name (ex. <code>@root.slots.Path</code> to the URL). </li> </ul> <p>The slot value will be processed a string in your template.</p>"},{"location":"usage/data-visualizer/tokens/","title":"Tokens","text":"<p>Tokens give you the ability to write dynamic queries for your data sources by using the special syntax <code>{&lt;TokenName&gt;}</code>.</p>"},{"location":"usage/data-visualizer/tokens/#where-can-i-use-tokens","title":"Where can I use tokens?","text":"<p>You can use tokens in the following locations:</p> <ul> <li> <p>Data Visualizer Web Part</p> <ul> <li>Builtin data sources<ul> <li>SharePoint Search<ul> <li>Query template field.</li> <li>Refinement filters field.</li> </ul> </li> <li>SharePoint CAML<ul> <li>Filter condition value using the dynamic menu.</li> <li>Anywhere in the CAML XML text if you are in 'Advanced' mode.</li> </ul> </li> <li>OData<ul> <li>URL field.</li> </ul> </li> </ul> </li> <li>Layouts<ul> <li>In the 'See all' link.</li> </ul> </li> <li>Anywhere in custom data sources code using the <code>TokenService</code> and <code>resolveTokens()</code> method.</li> </ul> </li> <li> <p>Data Verticals Web Part</p> <ul> <li>In the link URL when the vertical item is a link.</li> <li>In the vertical tab value.</li> </ul> </li> </ul>"},{"location":"usage/data-visualizer/tokens/#supported-tokens-all-data-sources","title":"Supported tokens (all data sources)","text":"<p>Tokens are case insensitive</p> <p>You can escape curly braces characters using <code>'\\'</code> to avoid: ex: <code>DepartmentId:\\{edbfd618-ef1d-4cc5-a214-95bf44ddf4ee\\}</code></p>"},{"location":"usage/data-visualizer/tokens/#page-tokens","title":"Page tokens","text":"Token Definition {Page.&lt;FieldName&gt;} The value of a field on the page from where the query was issued. For example, if the page from where the query was issued contained a site column named \"ContentOwner,\" specifying {Page.ContentOwner} would allow you to query for the value of \"ContentOwner.\" FieldName is the internal name of the field. When used with taxonomy columns, use <code>{Page.&lt;FieldName&gt;.Label}</code> or <code>{Page.&lt;FieldName&gt;.TermID}</code>"},{"location":"usage/data-visualizer/tokens/#connections-tokens","title":"Connections tokens","text":"<p>Tokens related to connected Web Parts in the Data Visualizer. </p> <p>These tokens can only be used in the 'Data Visualizer' Web Part.</p> Token Definition {inputQueryText} The query value entered into a search box on a page. The value depends on the configuration of input text connection of the Data Visualizer Web Part.  {filters.&lt;FilterName&gt;.&lt;valueAsObject|valueAsText|fromDate|toDate|operator&gt;} The current selected filters. 'FilterName' corresponds to the filter name specified in the Data Filters Web Part (not the display name). The availablue values for a filter are as follow: <ul><li><code>valueAsObject</code>: the filter value as JSON object. This value is intended to be used by custom adaptive expressions as parameter.</li><li><code>valueAsText</code>: the filter value as text. For multi values filter, values will be separated by a comma <code>','</code>.</li><li><code>fromDate</code>: if the filter is a date range template, the 'from' date selected by the user in UTC format.</li><li><code>toDate</code>: if the filter is a date range template, the 'to' date selected by the user in UTC format.</li><li><code>operator</code>: the operator configured to be used between filter values (ex: <code>'or'</code> or <code>'and'</code>.If no filter are selected (i.e. no values), the <code>{filters}</code> expression will be resolved as an empty string <code>''</code>. Use an adaptive expression <code>if(empty('{filters}')</code> to conditionnaly build your query acocrding to selected filters. Ex: <code>https://graph.microsoft.com/v1.0/groups?&amp;${if(empty('{filters}'),'',concat(\"&amp;$filter=\", buildOdataFilterCondition(json('{filters}'))))}</code>.Note: this token is always parsed as an array of objects, ex <code>[{...}]</code>. {itemsCountPerPage} The number of items count per page configured in the 'Data Visualizer' Web Part. Useful for the OData source to specify a <code>$top={itemsCountPerPage}</code> parameter. {startRow} The next start row number according to current paging. Useful for the OData source to specify a <code>$skipToken={startRow}</code> or <code>$skip={startRow}</code> parameters. {verticals.&lt;value|name&gt;} If connected, get the current selected vertical tab name or associated value."},{"location":"usage/data-visualizer/tokens/#context-tokens","title":"Context tokens","text":"Token Definition {PageContext.&lt;PropertyName&gt;} Resolves current SPFx page context related tokens. You can use deep paths here to access properties. Ex: <code>{PageContext.site.absoluteUrl}</code>.  {LegacyPageContext.&lt;PropertyName&gt;} Resolves current SPFx legacy page context related tokens. You can use deep paths here to access properties. Ex: <code>{LegacyPageContext.aadTenantId}</code>.  {QueryString.&lt;ParameterName&gt;} A value from a query string in the URL of the current page. For example, if the URL of the current page contains a query string such as ItemNumber=567, you could obtain the value 567 by specifying <code>{QueryString.ItemNumber}</code>.  {CurrentDisplayLanguage} The current display language based on MUI in ll-cc format.   {CurrentDisplayLCID} Numeric value of the current display language based on MUI in ll-cc format.   {TenantUrl} URL of the tenant (root site)"},{"location":"usage/data-visualizer/tokens/#site-web-hub-etc-tokens","title":"Site, web, hub, etc. tokens","text":"<p>Except for <code>{Hub}</code>, these a shortands to the <code>{PageContext}</code> tokens. They returns the same values. &lt;PropertyName&gt; is case sensitive.</p> Token Definition {Site.&lt;PropertyName&gt;} Resolves current site related tokens. You can use the 'Debug' layout and the <code>context</code> property to see all available values for a site. Ex <code>{Site.id._guid}</code> or <code>{Site.absoluteUrl}</code>. {Hub.&lt;PropertyName&gt;} Resolves current hub site related tokens. Valid property names are <code>{Hub.HubSiteId}</code>, <code>{Hub.Id}</code> and <code>{Hub.IsHubSite}</code>. {Group.&lt;PropertyName&gt;} Resolves current Office 365 group related tokens. You can use the 'Debug' layout and the <code>context</code> property to see all available values for a site. {List.&lt;PropertyName&gt;} Resolves current list related tokens. Ex <code>{List.id._guid}</code> or <code>{List.absoluteUrl}</code>. {Web.&lt;PropertyName&gt;} Resolves current web related tokens  You can use the 'Debug' layout and the <code>context</code> property to see all available values for a site. Ex <code>{Web.id._guid}</code> or <code>{Web.absoluteUrl}</code>."},{"location":"usage/data-visualizer/tokens/#user-tokens","title":"User tokens","text":"Token Definition {User} or {User.Name} Display name of the user who issued the query. For example, this value can be used to query content of the managed property Author.   {User.Email} Email address of the user who issued the query. For example, this value can be used to query content of the managed property WorkEmail.   {User.PreferredContentLanguage} Language as specified as Preferred Content Language in the profile of the user who issued the query.   {User.PreferredDisplayLanguage} Language as specified as Preferred Display Language in the profile of the user who issued the query.   {User.&lt;property&gt;} Any property from the user profile of the user who issued the query \u2014 for example, <code>SPS-Interests</code>, <code>userprofile_guid</code>, <code>accountname</code>, etc. including custom properties."},{"location":"usage/data-visualizer/tokens/#date-tokens","title":"Date tokens","text":"Token Definition {CurrentYear} Todays's date four digits, 2018  {CurrentMonth} Today's month, 1-12  {CurrentDate} Today's date, 1-31  {Today}+/- &lt;integer value for number of days&gt; A date calculated by adding/subtracting the specified number of days to/from the date when the query is issued. Date format is YYYY-MM-DD (Ex: <code>{Today}+5</code>)"},{"location":"usage/data-visualizer/tokens/#sharepoint-search-query-variables","title":"SharePoint search query variables","text":""},{"location":"usage/data-visualizer/tokens/#supported-variables","title":"Supported variables","text":"<p>The SharePoint Search engine already supports tokens by default (i.e query variables, ex: <code>{Site.ID}</code>). You can use them in the Query template field only. To see the all the supported tokens natively, refer to the Microsoft documentation.</p>"},{"location":"usage/data-visualizer/tokens/#use-the-or-operator","title":"Use the 'OR' operator","text":"<p>To deal with mutli valued properties (like taxonomy multi or choices SharePoint fields), you can use the 'OR' operator syntax <code>{|&lt;property&gt;&lt;operator&gt;&lt;multi_values_property&gt;}</code>. The search query will be expanded to the following KQL or OData query:</p> <pre><code>((&lt;property&gt;&lt;operator&gt;&lt;value_1&gt;) OR (&lt;property&gt;&lt;operator&gt;&lt;value_2&gt;) OR (&lt;property&gt;&lt;operator&gt;&lt;value_3&gt;) ...)\n</code></pre> <p>Examples:</p> <ul> <li>Using an user profile multi values taxonomy property: <code>{|owstaxidmetadataalltagsinfo:{User.SPS-Hashtags}}</code></li> <li>Using a page multi values taxonomy property: <code>{|owstaxidmetadataalltagsinfo:{Page.myTaxonomyMultiColumn.TermID}}</code> or <code>{|owstaxidmetadataalltagsinfo:{Page.myTaxonomyMultiColumn.TermLabel}}</code></li> <li>Using a page multi values choice property: <code>{|RefinableStringXX:{Page.myChoiceMultiColumn}}</code></li> <li>Filter on a field with SharePoint REST API using OData: <code>{&amp;fields/FileLeafRef eq title1,title2}</code></li> </ul> <p>At any time, you can see the resolved query using the 'Debug' layout an inspecting the <code>data.queryModification</code> property.</p> <p>Note</p> <p>Multi values have to be separated by a comma <code>,</code> to be correctly interpreted by the OR operator. Using a multi taxonomy column (ex <code>{Page.myTaxonomyMultiColumn.TermID}</code>) or a multi choice field <code>{Page.myChoiceMultiColumn}</code> will automatically output values with the comma delimiter. The expression will be considered as an OData query if the operator is either 'eq','ne','ge','gt','lt' or 'le'. In this case, the logical operator will be automatically format to lower case and values enclosed with single quotes to comply with OData format.</p>"},{"location":"usage/data-visualizer/tokens/#odata-data-source-default-url-syntax","title":"OData Data Source default URL syntax","text":"<p>The OData Data source supports a special URL syntax allowing to execute a specifc part of that URL only during the first execution by using <code>{{</code> and <code>}}</code> enclosing characters sequence. This could be convenient for an URL containing dynamic OData filter conditions like <code>$filter=startswith(MyField,'{inputQueryText'}</code> that may be invalid due to incorrect or unavailable values during first load resulting of API error.</p> <p>Example:</p> <p></p> <p>In this example, <code>{{/me/people}}</code> means only <code>/me/people</code> part of the URL will be executed during the first load,, retrieving the all list of users without any condition. However, on subsequent requests, the complete URL <code>/me/people?search={inputQueryText}}</code> will be executed with the correct token values.</p>"},{"location":"usage/data-visualizer/tokens/#token-resolution-notes","title":"Token resolution notes","text":"<p>To help you to write your queries, here are some hints about the token resolution process:</p> <ul> <li>If token doesn't exist in the environment, it will left untouched .Ex: <code>/me/people?search={tokenthatnotexists}</code> will be sent as is without modification. For instance if you use <code>{verticals.value}</code> or <code>{filters.&lt;field&gt;.valueAsText}</code> but there re no such Web Parts connect, tokens will be left untouched.</li> <li>If the token exists but don't have any value or empty string (ex: <code>null</code> or <code>''</code>), it will be replaced by an empty string as we don't want the string 'null' litterally.</li> <li>Tokens containinrefering to conmplex proeprties like arrays, objects, or array of objects will always be resolved as an array. Ex: an object <code>{'property':'value'}</code> will be stringified as <code>[{'property':'value'}]</code>.</li> </ul>"},{"location":"usage/data-visualizer/tokens/#go-further-with-microsoft-adaptive-expressions","title":"Go further with Microsoft Adaptive expressions","text":"<p>Along tokens, you can also use Microsoft adaptive expressions for complex scenarios. See Adaptive expressions usage for more information.</p>"},{"location":"usage/data-visualizer/common/caching/","title":"Caching","text":"<p>For all data sources, you have the option to cache the data to improve performances during the first page load.</p> <p></p> <p>When enabled, only the first page of initial results is cached. By default, a 5 minutes cache is applied. However, you can set your own duration. At any moment you can clear the cache by clicking on the 'Clear cache' button to start over. You data will be cached on the next page refresh.</p> <p>Notice the data are won't be put in the cache when:</p> <ul> <li>A filter is selected.</li> <li>The current page number is greater than 1.</li> <li>The input query text changes.</li> </ul> <p>Data in the cache are stored in the browser local storage under the following name: aequosDataVisualizer_DataSourceDataFirstPage_&lt;WebPart instance ID&gt;.</p>"},{"location":"usage/data-visualizer/common/common/","title":"Common","text":"<p>Common general options for all data sources</p> Setting Description Default value Do not fetch the data at page load If enabled, the data won't be fetched during the first load of the Web Part. Use this setting if you want to trigger a data fetch only on dynamic external events like selected static filters or a new search box input. False"},{"location":"usage/data-visualizer/common/paging/","title":"Paging","text":"<p>The paging options are available for all data sources.</p> Setting Description Default value Show paging Hide or display the paging control. Number of items per page Specify the number of items to show per page. Depending of the data source,  this value will be handled automatically or manually. For instance, the SharePoint Search and SharePoint CAML will take care of this value automatically. However, the OData data source can use this value by usin the <code>{itemsCountPerPage}</code> token to build a dynamic query (ex: <code>$top={itemsCountPerPage}</code>). Number of pages to display in range Determines the number of pages to display in range. Hide navigation buttons (prev page, next page) Self explicit. Hide first/last navigation buttons Self explicit. Hide navigation buttons (prev, next, first, last) if they are disabled Self explicit. <p>Data source paging behaviors</p> <p>Paging is available for all data sources. However, they can handle it differently.</p> Data source Paging behavior Comments SharePoint CAML Dynamic Paging is done calculating the next page link based of the last item ID of the current results set. Therefore, pages are \"discovered\" along the way when browsing, meaning you can only increase the page number by one every time. SharePoint Search Dynamic All page links are pre-calculated since the search engine returns the total items count matching the query regardless the page number. It means you can directly go the last page of results matching the query if you want. OData Dynamic/Static Dynamic when using the <code>@odata.nextLink</code> information if present ('server-side paging') or <code>$skip</code> or <code>$skipToken</code> in the URL to determine the next page link URL. When dynamic, the pages are \"discovered\" along the way when browsing. Static when using the items array directly. Static Data Static Paging is done statically base on the items array."},{"location":"usage/data-visualizer/connections/","title":"Connections","text":"<p>The 'Data Visualizer' Web Part can be used alone but also connected to other Web Parts:</p> <p></p>"},{"location":"usage/data-visualizer/connections/#input-query-text","title":"Input query text","text":"<p>The input query text can be either static or dynamic. In all cases, this value can be used using the <code>{inputQueryText}</code> token. See tokens for more information.</p> <p>Static value</p> <p>It corresponds to a free text keywords that you want to pass to your data source:</p> <p></p> <p>This value will be applied every time to your data source.</p> <p>Dynamic value</p> <p>You can connect a dynamic value from the page environment (ex: a query string parameter, the top bar search box, etc.) or a search box already added to the page.</p> <p></p> <p>Optionaly, you can set a default query text when there is no value for the connected source (ex: an empty search box at page load). </p>"},{"location":"usage/data-visualizer/connections/#filters-web-part","title":"Filters Web Part","text":"<p>Send available filters for the current data source to a Data Filters Web Part to be rendered. This is a two-ways connection and you need to connect the Data Visualizer Web Part from the Data Filter Web Part as well.</p> <p>For static filters (i.e. taxonomy picker and date range filter templates), this value can be used using the <code>{filters.&lt;FilterName&gt;}</code> token. See tokens for more information.</p> <p></p>"},{"location":"usage/data-visualizer/connections/#verticals","title":"Verticals","text":"<p>When you connect the Web Part to a Data Verticals one, you must specify on which vertical the Web Part content should be displayed.</p> <p></p> <p>This mechanism allows to build a complete search center using verticals tabs. </p>"},{"location":"usage/data-visualizer/connections/#data-results","title":"Data Results","text":""},{"location":"usage/data-visualizer/connections/#how-to-configure-item-selection","title":"How to configure item selection?","text":""},{"location":"usage/data-visualizer/connections/#source-web-part-configuration","title":"Source Web Part configuration","text":"<ol> <li>In a Data Visualizer Web Part where you want to select items from, go to the second property pane configuration page and enable the Allow item selection flag:</li> </ol> <ol> <li>Specifiy if you want to allow only single or multi selection.</li> <li>Make sure some results are displayed in the Web Part by setting a default query.</li> </ol>"},{"location":"usage/data-visualizer/connections/#target-web-parts-configuration","title":"Target Web Part(s) configuration","text":"<ol> <li> <p>In a Data Visualizer Web Part where you want to filter values, go to the third configuration page and enable the Connect to a data results Web Part flag. </p> </li> <li> <p>From here, select the previous Web Part as source.</p> <p></p> </li> <li> <p>Select the source field to use as filter value.</p> <p></p> <p>Note</p> <p>If you don't see any fields in the dropdown list after selection a source Web Part, it could be because:</p> <ul> <li>The source Web Part doesn't have any results displayed yet so we can't guess what are the available exposed fields. In this case, you can either type the field name manually in the dropdown and press 'Enter' or display results in the source Web Part to list all its available fields.</li> <li>The source Web Part doesn't allow item selection. In this case, you can't add any field.</li> </ul> </li> <li> <p>Select the destination field to filter the current Web Part results.</p> <p></p> <p>Note</p> <p>If you don't see any fields in the dropdown list for target fields, it is because the Web Part doesn't display any result yet. In this case, you can either type the field name manually in the dropdown and press 'Enter' or display results in the source Web Part to list all available fields.</p> </li> <li> <p>Select the selection mode.</p> <p></p> <p>Note</p> <ul> <li>Process values as filters: the values will be sent as regular filters, just like they were selected in the Data Filter Web Part. In this mode, the selected source field must be a valid filter for the current data source. For instance if the data source is SharePoint Search or Microsoft Search, the field must be a valid refinable managed property. </li> <li>Process values as tokens: the values will be sent manually in the data source query using token <code>{filter.source_field.valueAsText/valueAsObject}</code> and/or adaptive expressions to craft a valid query. This scenario can be useful for instance if:<ul> <li>You use SharePoint Search or Microsoft Search data sources and you don't want to use a Refinable managed property as filters.</li> <li>You use OData data source and you want to create a dynamic query using tokens.</li> </ul> </li> </ul> <p>Examples</p> <p>SharePoint Search KQL (Single Value)</p> <p><code>Title:{filters.Title.valueAsText}</code>  will be translated to <code>Title:docx</code></p> <p>SharePoint Search KQL (Multi Values) OR condition: <code>{|Title:{filters.Title.valueAsText}}</code> will be translated to <code>(Title:docx) OR (Title:pdf)...</code> AND condition: <code>{&amp;Title:{filters.Title.valueAsText}}</code> will be translated to <code>(Title:docx) AND (Title:pdf)...</code> </p> <p>OData URL (Multi Values) OR condition: <code>{|Title eq {filters.Title.valueAsText}}` will be translated to `(Title eq 'docx') or (Title eq 'pdf')</code> AND condition: <code>{&amp;Title eq {filters.Title.valueAsText}}` will be translated to `(Title eq 'docx') or (Title eq 'pdf')</code></p> </li> <li> <p>Select the logical operator to use between selected filter values if applicable (default mode only).</p> <p></p> </li> </ol> <p>Filtering general behavior</p> <ul> <li><code>null</code> ou <code>empty</code> filters values are ignored in the resulting query.</li> <li>Duplicate values are trimmed (ex: user select items with the same filter values).</li> <li>Filter values should be 'string' values. All other types will be ignored (ex: 'objects' from JSON response).</li> </ul>"},{"location":"usage/data-visualizer/connections/item-selection/","title":"Item selection","text":""},{"location":"usage/data-visualizer/connections/item-selection/#how-to-configure-item-selection","title":"How to configure item selection?","text":""},{"location":"usage/data-visualizer/connections/item-selection/#source-web-part-configuration","title":"Source Web Part configuration","text":"<ol> <li>In a Data Visualizer Web Part where you want to select items from, go to the second property pane configuration page and enable the Allow item selection flag:</li> </ol> <ol> <li>Specifiy if you want to allow only single or multi selection.</li> <li>Make sure some results are displayed in the Web Part by setting a default query.</li> </ol>"},{"location":"usage/data-visualizer/connections/item-selection/#target-web-parts-configuration","title":"Target Web Part(s) configuration","text":"<ol> <li> <p>In a Data Visualizer Web Part where you want to filter values, go to the third configuration page and enable the Connect to a data results Web Part flag. </p> </li> <li> <p>From here, select the previous Web Part as source.</p> <p></p> </li> <li> <p>Select the source field to use as filter value.</p> <p></p> <p>Note</p> <p>If you don't see any fields in the dropdown list after selection a source Web Part, it could be because:</p> <ul> <li>The source Web Part doesn't have any results displayed yet so we can't guess what are the available exposed fields. In this case, you can either type the field name manually in the dropdown and press 'Enter' or display results in the source Web Part to list all its available fields.</li> <li>The source Web Part doesn't allow item selection. In this case, you can't add any field.</li> </ul> </li> <li> <p>Select the destination field to filter the current Web Part results.</p> <p></p> <p>Note</p> <p>If you don't see any fields in the dropdown list for target fields, it is because the Web Part doesn't display any result yet. In this case, you can either type the field name manually in the dropdown and press 'Enter' or display results in the source Web Part to list all available fields.</p> </li> <li> <p>Select the selection mode.</p> <p></p> <p>Note</p> <ul> <li>Process values as filters: the values will be sent as regular filters, just like they were selected in the Data Filter Web Part. In this mode, the selected source field must be a valid filter for the current data source. For instance if the data source is SharePoint Search or Microsoft Search, the field must be a valid refinable managed property. </li> <li>Process values as tokens: the values will be sent manually in the data source query using token <code>{filter.source_field.valueAsText/valueAsObject}</code> and/or adaptive expressions to craft a valid query. This scenario can be useful for instance if:<ul> <li>You use SharePoint Search or Microsoft Search data sources and you don't want to use a Refinable managed property as filters.</li> <li>You use OData data source and you want to create a dynamic query using tokens.</li> </ul> </li> </ul> <p>Examples</p> <p>SharePoint Search KQL (Single Value)</p> <p><code>Title:{filters.Title.valueAsText}</code>  will be translated to <code>Title:docx</code></p> <p>SharePoint Search KQL (Multi Values) OR condition: <code>{|Title:{filters.Title.valueAsText}}</code> will be translated to <code>(Title:docx) OR (Title:pdf)...</code> AND condition: <code>{&amp;Title:{filters.Title.valueAsText}}</code> will be translated to <code>(Title:docx) AND (Title:pdf)...</code> </p> <p>OData URL (Multi Values) OR condition: <code>{|Title eq {filters.Title.valueAsText}}` will be translated to `(Title eq 'docx') or (Title eq 'pdf')</code> AND condition: <code>{&amp;Title eq {filters.Title.valueAsText}}` will be translated to `(Title eq 'docx') or (Title eq 'pdf')</code></p> </li> <li> <p>Select the logical operator to use between selected filter values if applicable (default mode only).</p> <p></p> </li> </ol> <p>Filtering general behavior</p> <ul> <li><code>null</code> ou <code>empty</code> filters values are ignored in the resulting query.</li> <li>Duplicate values are trimmed (ex: user select items with the same filter values).</li> <li>Filter values should be 'string' values. All other types will be ignored (ex: 'objects' from JSON response).</li> </ul>"},{"location":"usage/data-visualizer/data-sources/","title":"Data sources","text":""},{"location":"usage/data-visualizer/data-sources/#builtin-data-sources","title":"Builtin data sources","text":"<p>By default, the following data sources are provided:</p> <p></p> <p>Be careful, when you switch the data source in the property pane, all the previous data source properties are lost. We do this to avoid polluting the Web Part property bag with multiple useless configurations.</p>"},{"location":"usage/data-visualizer/data-sources/#sharepoint-search","title":"SharePoint Search","text":"<p>The 'SharePoint Search' data source retrieve items from the SharePoint search engine.</p> <p>The SharePoint search is different from the Microsoft Graph search.</p>"},{"location":"usage/data-visualizer/data-sources/#source-configuration","title":"Source configuration","text":"Setting Description Default value Query text The input query text to pass to the search engine. This setting is not configurable directly in the data source options. To enable it you use go the the third configuration page of the Web Part and selected either a static or dynamic value (Ex: from a connected search box Web Part). See the connection documentation for more information on how to configure this option. This value can be then used in the Query template using the <code>{searchTerms}</code> token. Also this value can be a Keyword Query Language expression (KQL). None Query template The search query template to use. It allows you to use dynamic tokens according to the context or specifiy conditions that should always apply to the query. <code>{searchTerms}</code> Result source ID Can be either a built-in result source ID listed in the dropdown, or a custom result source that you specify. Type the <code>GUID</code> of the result source, or the <code>SCOPE</code> (Level - SearchObjectLevel enumeration) and <code>NAME</code> (SourceName), separated by <code>|</code> (pipe character). For this to take effect, you must press 'Enter' to save the value. Valid scopes are <code>SPSiteSubscription</code>, <code>SPSite</code>, <code>SPWeb</code>. Examples: <ul><li>SPWeb<code>|</code>Local News</li><li>SPSite<code>|</code>Contracts</li><li>SPSiteSubscription<code>|</code>Intranet</li></ul> LocalSharePointResults Selected properties The SharePoint managed properties to retrieve from the results. They can be used with the same name in layouts and slots afterwards. <ul><li>Title</li><li>Path</li><li>DefaultEncodingURL</li><li>FileType</li><li>HitHighlightedSummary</li><li>AuthorOWSUSER</li><li>owstaxidmetadataalltagsinfo</li><li>Created</li><li>UniqueID</li><li>NormSiteID</li><li>NormListID</li><li>NormUniqueID</li><li>ContentTypeId</li><li>UserName</li><li>JobTitle</li><li>WorkPhone Sort Configure the sort settings of the data source. Properties listed in the dropdown are all static properties marked as 'Sortable' in the SharePoint search schema. However, it does not list all possible RefinableXXX or aliases fields. To use them, you must enter the value manually and press 'Enter' to validate. For a particular field, you can define if it should be used for initial sort (i.e. when the results are loaded for the first time) or be only available for users in the sort control (i.e. after the results are loaded). The sort control does not consider default sort fields (i.e. select them by default) and you can only sort on a single field at a time according the fields you defined. If no user sort fields are defined in the configuration, the sort control won't be displayed. None. Refinement filters The initial refinement filters to apply to the query. Both KQL (Keyword Query Language) and FQL (Fast Query Language) expressions work here (Ex: KQL <code>FileType:docx</code>, FQL: <code>FileType:equals(\"docx\")</code>). They will be apply every time to the current search query regarless selected filters from connected Web Parts. Notice: for strign expressions, use <code>\"</code> isntead of <code>'</code>. None Language of the search request The language to use for the search request. By default the search request will be made using the current user interface language. This parameter is mainly use to process diacritics, plurals, etc. correctly according to the language. Current UI language. Enable query rules Whether or not apply SharePoint query rules. False Include OneDrive for Business results Whether or not include OneDrive for business results. False Enable audience targeting Whether or not results should be targeted according to the audiences that the current user belongs to. More information about modern audiences and how to configure them. False Enable localization If enabled, the Web Part will try to translate the taxonomy term IDs found in result item properties and refinement values to their corresponding label according to the curent UI language. To get it work, you must map a new refinable managed property associated with ows_taxId_ crawled property and turn this toggle 'on':  If enabled and depending how many items are currently displayed, this could be slightly decrease loading performances. To use translated values in your template, you must use the '<code>Auto + &lt;property_name&gt;</code>' property format instead of the original property name. For instance, to use translated values of the 'owstaxidmetadataalltagsinfo' property, you must use the 'Autoowstaxidmetadataalltagsinfo' auto created property. False Enable multi-geo environment If your organization expands its Microsoft 365 presence to multiple geographic regions and/or countries within your existing tenant, you can enable it. Once enabled, the Web Part will include the geo-locations configuration; you can specify an optional list of which geo-locations in the multi-geo tenant to fan the query out. If you don't include this parameter or leave it blank, the query is fanned out to all geo locations.More information about the Search configuration for Microsoft 365 Multi-Geo. False"},{"location":"usage/data-visualizer/data-sources/#sharepoint-caml","title":"SharePoint CAML","text":"<p>The 'SharePoint CAML' data source allows you to rerieve items uisng a CAML query built using the interative builder or using an XML text.</p>"},{"location":"usage/data-visualizer/data-sources/#source-configuration_1","title":"Source configuration","text":"<p>A CAML query always apply on a SharePoint list or document library. Thus, you must first select one using the following dropdowns:</p> <p></p> Setting Description Default value Site The site collection containing the list or document library By default, it uses the current site collection. However, you can disable the checkmark and search for a specific site. This control uses SharePoint search to get sites looking in the Title and Path managed properties. It means if your sites has been newly created it may not appear immediatly until indexed. Web The web containing the list. It can be the root web of the selected site collecion or an other subsite. '/' (root web) List The list where the CAML query will be applied. None"},{"location":"usage/data-visualizer/data-sources/#caml-query-configuration","title":"CAML Query configuration","text":"<p>To build your CAML query, you have the choice to use the interactive builder or start from scratch using your own XML. See the query schema for CAML to get started.</p>"},{"location":"usage/data-visualizer/data-sources/#using-the-builder","title":"Using the builder","text":"Setting Description Default value View Fields The item fields to return from the. They will be available in your templates with the same name. <ul><li>UniqueId</li><li>EncodedAbsUrl</li><li>FileRef</li><li>File_x0020_Type</li><li>FileLeafRef</li><li>Name</li><li>Author</li><li>Created</li></ul> Search within folders Enable this option if you want to search in folders recursively in your list or document library. False Filters The filter condition builder. From here you can select: <ul><li>Field: the list to apply the condition</li><li>Operator: the operator to use. Supported operators are \"Equals,Does not equal, Is greater than, Is less than, Is grater or equal to, Is less or equal to, Is null, Is not null, Begins with and Contains\".Operator choices are automatically adjusted regarding the selected field type.</li><li>Value: the value to use for the condition. You can use a plain text/date/taxonomy value here (depending of the selected field type) or use a dynamic token. For the second option, enable the corresponding checkbox to have access to the dynamic tokens menu. Notice that not all available tokens are listed here. If the token you want to use is not is the list, you can add it using the 'Custom value' option and press enter. All supported tokens can be found here</li></ul> Sort Configure the sort settings of the data source. The sort property can be selected from the dropdown. For a particular field, you can define if it should be used for initial sort (i.e. when the results are loaded for the first time) or be only available for users in the sort control (i.e. after the results are loaded). The sort control does not consider default sort fields (i.e. select them by default) and you can only sort on a single field at a time according the fields you defined. If no user sort fields are defined in the configuration, the sort control won't be displayed. None."},{"location":"usage/data-visualizer/data-sources/#using-the-advanced-mode","title":"Using the advanced mode","text":"<p>In advanced mode, you are responsible to wrtie your own CAML query as XML text. You can use tokens <code>{&lt;tokenName&gt;}</code> directly in the text to create dynamic queries.</p> <p></p> <p>Tip: to help you get started, you can start writing your query using the builder and then switch to 'Advanced mode'. This way, you will see the underlying generated query. However, from the moment where the CAML query text in advanced mode differ from the one generated by the builder, the builder settings will be lost if you switch back to that mode.</p>"},{"location":"usage/data-visualizer/data-sources/#odata","title":"OData","text":"<p>The OData data source allows you to get data from the following APIs</p> <ul> <li>Microsoft Graph: both v1.0 or beta endpoints.</li> <li>SharePoint REST API: the current site or an other site in your tenant. Supports v1.0 or v2.0,</li> <li>Azure Active Directoy secured API like an Azure function, Azure Web Application, etc.</li> <li> <p>Anonymous API</p> <p></p> </li> </ul>"},{"location":"usage/data-visualizer/data-sources/#microsoft-graph","title":"Microsoft Graph","text":"<p>The URL supports the following formats. Tokens can also be used to construct your URL:</p> <ul> <li><code>me</code></li> <li><code>/me</code></li> <li><code>https://graph.microsoft.com/v1.0/me</code></li> <li><code>https://graph.microsoft.com/beta/me</code></li> <li><code>me/events?$filter=startswith(subject, 'ship')</code></li> </ul> <p>Before using a Microsoft Graph resource, you need to ensure you allowed the correct API permissions at tenant level. Because you can't define API permissions through the Web Part package declaratively (i.e <code>webApiPermissions</code>), we recommend you to use the CLI for Microsoft 365 to add correct permissions for your API:</p> <pre><code>m365 spo serviceprincipal grant add --resource 'Microsoft Graph' --scope 'Mail.Read'\n</code></pre>"},{"location":"usage/data-visualizer/data-sources/#sharepoint-rest-api","title":"SharePoint REST API","text":"<p>The URL supports the following formats. Tokens can also be used to construct your URL</p> <ul> <li><code>/_api/</code> (will target the current root site if you don't specify anything)</li> <li><code>&lt;your_site&gt;/_api/</code> (ex: http://mycompany.sharepoint.com/sites/intranet/_api/lists)</li> <li><code>/_api/v2.0/sites/{site.id}/drive/list/items?expand=fields(select=FileLeafRef,BaseName,FileRef,FSObjType)&amp;$top={itemsCountPerPage}</code></li> <li>etc.</li> </ul> <p>You can also use query parameters supported by the API</p>"},{"location":"usage/data-visualizer/data-sources/#azure-active-directory-secured-api","title":"Azure Active Directory secured API","text":"<ol> <li> <p>Follow this procedure to set up your Azure Active Directory application. Don't forget to add at least the 'user impersonation' permission to be able to call the API endpoint.</p> <p>Before using an AAD secured resource, you need to ensure you allowed the correct API permissions at tenant level. Because you can't define API permissions through the Web Part package declaratively (i.e <code>webApiPermissions</code>), we recommend you to use the CLI for Microsoft 365 to add correct permissions for your API:</p> <pre><code>m365 spo serviceprincipal grant add --resource '&lt;aad_app_display_name&gt;' --scope 'user_impersonation'\n</code></pre> </li> <li> <p>Allow your SharePoint domain (ex: https://mycompany.sharepoint.com) as allowed origin in the service or application CORS (Cross-origin resource sharing) settings. Here a procedure for an Azure function.</p> </li> </ol>"},{"location":"usage/data-visualizer/data-sources/#anonymous","title":"Anonymous","text":"<p>You can also call an API endpoint with no specific authentifcation like an Azure HTTP trigger Function with function code. By default, we use the demo OData v4 services provided by https://www.odata.org/odata-services/ to demonstrate the capability.</p>"},{"location":"usage/data-visualizer/data-sources/#set-http-headers-or-body","title":"Set HTTP headers or body","text":"<p>The only method allowed are <code>GET</code> or <code>POST</code>. For each, you have the ability so set your own HTTP headers. The value must be a valid JSON value:</p> <pre><code>{\n\"Content-Type\": \"application/json;odata=verbose\",\n\"Accept\": \"application/json\",\n...\n}\n</code></pre> <p>If you specify a <code>POST</code> request, you can also benefit of builtin tokens.</p> <pre><code>{\n\"ItemsCount\": \"{itemsCountPerPage}\",\n\"MyProperty\": \"My Value\",\n...\n}\n</code></pre>"},{"location":"usage/data-visualizer/data-sources/#sort-settings","title":"Sort settings","text":"<p>Configure the sort settings of the data source. The sort property should be entered manually in the Sort Field. For a particular field, you can define if it should be used for initial sort (i.e. when the results are loaded for the first time) or be only available for users in the sort control (i.e. after the results are loaded). The sort control does not consider default sort fields (i.e. select them by default) and you can only sort on a single field at a time according the fields you defined. If no user sort fields are defined in the configuration, the sort control won't be displayed. The Sort will only work with APIs that use \"orderby\" as the property for sorting. With SharePoint and Microsoft APIs, it will always work as they use \"orderby\" for sorting.</p>"},{"location":"usage/data-visualizer/data-sources/#pagination","title":"Pagination","text":"<p>For each API type, you can control how the results will be paginated in order to improve performances.</p> <p></p>"},{"location":"usage/data-visualizer/data-sources/#dynamic-paging","title":"Dynamic paging","text":"<p>Use a Dynamic paging if the underlying API you are using supports paging mechanisms (likely using <code>$top</code> and <code>$skip</code> or <code>$skipToken</code> tokens, for instance Microsoft Graph or SharePoint REST API).</p>"},{"location":"usage/data-visualizer/data-sources/#use-server-side-paging","title":"Use server-side paging","text":"<p>Some APIs like Microsoft Graph or the SharePoint REST API provide a server-side paging functionality (see https://docs.microsoft.com/en-us/graph/paging for more information). Basically, it allows you to paginate results more easily by using a pre-calculated next page link URL instead of building it manually. </p> <p>If checked, the paging will be based on the <code>@odata.nextLink</code> value from the HTTP response. It means when you will click on the next page button, this value will be used to get the next set of results. Thus, the items count and paging information (i.e first page, current page, next page, previous page, and last page) will be determined automatically as long as you move through pages.</p> <p>If unchecked, it will be your URL to be executed to get the next page results. In this last scenario you likely want to provide a dynamic URL using builtin tokens.</p> <p>Example</p> <ul> <li> <p>With server-side paging enabled using <code>@odata.nextLink</code>:</p> <pre><code>/me/messages?$top={itemsCountPerPage}\nor\n/me/messages?$top=2\n</code></pre> <p>Here, the <code>$skip</code> token will be provided automatically in the <code>@odata.nextLink</code> so you don't have to provide it in the URL.</p> </li> <li> <p>Without server-side paging enabled using <code>$top</code> and <code>$skip</code> tokens:</p> <pre><code>&lt;your_sharepoint_site_url&gt;/_api/lists?$top={itemsCountPerPage}&amp;$skip={startRow}\n</code></pre> <p>If you want to control the paging by yourself, you will have to provide a <code>$skip</code> value manually using builtin tokens. You can use the <code>{itemsCountPerPage}</code> and <code>{startRow}</code> tokens where <code>{startRow}</code> corresponds to the number or items per page * the current page number (start from 0) and <code>{itemsCountPerPage}</code> to the number of items per page configured in the property pane. The URL and the items count will be resolved dynamically based on these token values as long as you move through pages. Because we can't determine the total number of items, in some cases, the last page could be empty. It happens for example when the 'total items count'/'items count per page' is even (i.e. exact same number of items for each page).</p> </li> </ul>"},{"location":"usage/data-visualizer/data-sources/#static-paging","title":"Static paging","text":"<p>If performance is not an issue (i.e for a small ammount of data), you can also set a static paging on your data based on a results array. In this case, you will have to provide the response field to use as the array of items to get the total items count. Then, in the common paging settings, configure the desired number items per page to generate pages dynamically.</p> <p></p> <p>If you use static paging, don't forget to add a fixed count in your url <code>/me/messages?$top=10</code> instead of <code>/me/messages?$top={itemsCountPerPage}</code>. Otherwise, you will get only one page every time.</p>"},{"location":"usage/data-visualizer/data-sources/#static-data","title":"Static Data","text":"<p>The 'Static data' is the simplest data source you can use. With this data ssource, items are retrieved from a static JSON object that you define and does not require any asynchronous call.</p> <p></p>"},{"location":"usage/data-visualizer/data-sources/#when-to-use-this-data-source","title":"When to use this data source?","text":"<p>This data source allows you to define your own data schema (i.e. fields) that you can consume in your template. However, to be consumed by templates, the data must follow this JSON strcuture: </p> <pre><code>{\n\"items\": [\n{\n\"&lt;any_property&gt;\": \"&lt;any_value_of_any_type&gt;\",\n...\n}\n],\n\"&lt;any_other_property&gt;\": \"&lt;any_value_of_any_type&gt;\",\n...\n}\n</code></pre> <p>Don't forget the quotes '\"' for property names.</p> <p>Even if you don't return items, you must specifiy this property. In this case, pass an empty array.</p>"},{"location":"usage/data-visualizer/data-sources/#how-to-use-this-data-source-a-practical-example","title":"How to use this data source: a practical example","text":"<p>Let say you want to display a static list of useful links for your organization on the home page. Open the code editor and enter the following data:</p> <p></p> <p>The data could be look like this:</p> <pre><code>{\n\"items\": [\n{\n\"linkName\": \"My Company Web Site\",\n\"linkHref\": \"http://mycompany.com\",\n\"linkOpenBehavior\": \"_blank\"\n},\n{\n\"linkName\": \"My Company Web Site\",\n\"linkHref\": \"http://mycompany.com\",\n\"linkOpenBehavior\": \"_blank\"\n}\n],\n\"numberOfLinks\": \"2\"\n}\n</code></pre>"},{"location":"usage/data-visualizer/data-sources/#static-data-configuration","title":"Static Data Configuration","text":"Setting Description Default value Sort Configure the sort settings of the data source. The sort property should be entered manually in the Sort Field. For a particular field, you can define if it should be used for initial sort (i.e. when the results are loaded for the first time) or be only available for users in the sort control (i.e. after the results are loaded). The sort control does not consider default sort fields (i.e. select them by default) and you can only sort on a single field at a time according the fields you defined. If no user sort fields are defined in the configuration, the sort control won't be displayed. The Sort will work for 'Text' and 'Number' fields only. None. <p>Now to consume this data, you can either start from an existing layout, or use a custom one. See the templating documentation to know more.</p>"},{"location":"usage/data-visualizer/data-sources/#microsoft-search","title":"Microsoft Search","text":"<p>The 'Microsoft Search' data source retrieve items from the Microsoft search engine.</p>"},{"location":"usage/data-visualizer/data-sources/#source-configuration_2","title":"Source configuration","text":"Setting Description Default value Entity types to search The entity types to search. See the Microsoft Search API documentation to see valid combinations. Drive items (SharePoint &amp; OneDrive) Use beta endpoint If checked, will use the Microsoft search <code>beta</code> endpoint instead of <code>v1.0</code> in Microsoft Graph. false Sort Configure the sort settings of the data source. Properties listed in the dropdown are all static properties marked as 'Sortable' in the SharePoint search schema. However, it does not list all possible RefinableXXX or aliases fields. To use them, you must enter the value manually and press 'Enter' to validate. For a particular field, you can define if it should be used for initial sort (i.e. when the results are loaded for the first time) or be only available for users in the sort control (i.e. after the results are loaded). The sort control does not consider default sort fields (i.e. select them by default) and you can only sort on a single field at a time according the fields you defined. If no user sort fields are defined in the configuration, the sort control won't be displayed. None. <p>Warning</p> <p>Filters (aka 'refiners') are only available with the beta endpoint.</p>"},{"location":"usage/data-visualizer/data-sources/#common-settings","title":"Common settings","text":"<p>Common general options for all data sources</p> Setting Description Default value Do not fetch the data at page load If enabled, the data won't be fetched during the first load of the Web Part. Use this setting if you want to trigger a data fetch only on dynamic external events like selected static filters or a new search box input. False"},{"location":"usage/data-visualizer/data-sources/#paging","title":"Paging","text":"<p>The paging options are available for all data sources.</p> Setting Description Default value Show paging Hide or display the paging control. Number of items per page Specify the number of items to show per page. Depending of the data source,  this value will be handled automatically or manually. For instance, the SharePoint Search and SharePoint CAML will take care of this value automatically. However, the OData data source can use this value by usin the <code>{itemsCountPerPage}</code> token to build a dynamic query (ex: <code>$top={itemsCountPerPage}</code>). Number of pages to display in range Determines the number of pages to display in range. Hide navigation buttons (prev page, next page) Self explicit. Hide first/last navigation buttons Self explicit. Hide navigation buttons (prev, next, first, last) if they are disabled Self explicit. <p>Data source paging behaviors</p> <p>Paging is available for all data sources. However, they can handle it differently.</p> Data source Paging behavior Comments SharePoint CAML Dynamic Paging is done calculating the next page link based of the last item ID of the current results set. Therefore, pages are \"discovered\" along the way when browsing, meaning you can only increase the page number by one every time. SharePoint Search Dynamic All page links are pre-calculated since the search engine returns the total items count matching the query regardless the page number. It means you can directly go the last page of results matching the query if you want. OData Dynamic/Static Dynamic when using the <code>@odata.nextLink</code> information if present ('server-side paging') or <code>$skip</code> or <code>$skipToken</code> in the URL to determine the next page link URL. When dynamic, the pages are \"discovered\" along the way when browsing. Static when using the items array directly. Static Data Static Paging is done statically base on the items array."},{"location":"usage/data-visualizer/data-sources/#caching","title":"Caching","text":"<p>For all data sources, you have the option to cache the data to improve performances during the first page load.</p> <p></p> <p>When enabled, only the first page of initial results is cached. By default, a 5 minutes cache is applied. However, you can set your own duration. At any moment you can clear the cache by clicking on the 'Clear cache' button to start over. You data will be cached on the next page refresh.</p> <p>Notice the data are won't be put in the cache when:</p> <ul> <li>A filter is selected.</li> <li>The current page number is greater than 1.</li> <li>The input query text changes.</li> </ul> <p>Data in the cache are stored in the browser local storage under the following name: aequosDataVisualizer_DataSourceDataFirstPage_&lt;WebPart instance ID&gt;.</p>"},{"location":"usage/data-visualizer/data-sources/microsoft-search/","title":"Microsoft search","text":"<p>The 'Microsoft Search' data source retrieve items from the Microsoft search engine.</p>"},{"location":"usage/data-visualizer/data-sources/microsoft-search/#source-configuration","title":"Source configuration","text":"Setting Description Default value Entity types to search The entity types to search. See the Microsoft Search API documentation to see valid combinations. Drive items (SharePoint &amp; OneDrive) Use beta endpoint If checked, will use the Microsoft search <code>beta</code> endpoint instead of <code>v1.0</code> in Microsoft Graph. false Sort Configure the sort settings of the data source. Properties listed in the dropdown are all static properties marked as 'Sortable' in the SharePoint search schema. However, it does not list all possible RefinableXXX or aliases fields. To use them, you must enter the value manually and press 'Enter' to validate. For a particular field, you can define if it should be used for initial sort (i.e. when the results are loaded for the first time) or be only available for users in the sort control (i.e. after the results are loaded). The sort control does not consider default sort fields (i.e. select them by default) and you can only sort on a single field at a time according the fields you defined. If no user sort fields are defined in the configuration, the sort control won't be displayed. None. <p>Warning</p> <p>Filters (aka 'refiners') are only available with the beta endpoint.</p>"},{"location":"usage/data-visualizer/data-sources/odata/","title":"Odata","text":"<p>The OData data source allows you to get data from the following APIs</p> <ul> <li>Microsoft Graph: both v1.0 or beta endpoints.</li> <li>SharePoint REST API: the current site or an other site in your tenant. Supports v1.0 or v2.0,</li> <li>Azure Active Directoy secured API like an Azure function, Azure Web Application, etc.</li> <li> <p>Anonymous API</p> <p></p> </li> </ul>"},{"location":"usage/data-visualizer/data-sources/odata/#microsoft-graph","title":"Microsoft Graph","text":"<p>The URL supports the following formats. Tokens can also be used to construct your URL:</p> <ul> <li><code>me</code></li> <li><code>/me</code></li> <li><code>https://graph.microsoft.com/v1.0/me</code></li> <li><code>https://graph.microsoft.com/beta/me</code></li> <li><code>me/events?$filter=startswith(subject, 'ship')</code></li> </ul> <p>Before using a Microsoft Graph resource, you need to ensure you allowed the correct API permissions at tenant level. Because you can't define API permissions through the Web Part package declaratively (i.e <code>webApiPermissions</code>), we recommend you to use the CLI for Microsoft 365 to add correct permissions for your API:</p> <pre><code>m365 spo serviceprincipal grant add --resource 'Microsoft Graph' --scope 'Mail.Read'\n</code></pre>"},{"location":"usage/data-visualizer/data-sources/odata/#sharepoint-rest-api","title":"SharePoint REST API","text":"<p>The URL supports the following formats. Tokens can also be used to construct your URL</p> <ul> <li><code>/_api/</code> (will target the current root site if you don't specify anything)</li> <li><code>&lt;your_site&gt;/_api/</code> (ex: http://mycompany.sharepoint.com/sites/intranet/_api/lists)</li> <li><code>/_api/v2.0/sites/{site.id}/drive/list/items?expand=fields(select=FileLeafRef,BaseName,FileRef,FSObjType)&amp;$top={itemsCountPerPage}</code></li> <li>etc.</li> </ul> <p>You can also use query parameters supported by the API</p>"},{"location":"usage/data-visualizer/data-sources/odata/#azure-active-directory-secured-api","title":"Azure Active Directory secured API","text":"<ol> <li> <p>Follow this procedure to set up your Azure Active Directory application. Don't forget to add at least the 'user impersonation' permission to be able to call the API endpoint.</p> <p>Before using an AAD secured resource, you need to ensure you allowed the correct API permissions at tenant level. Because you can't define API permissions through the Web Part package declaratively (i.e <code>webApiPermissions</code>), we recommend you to use the CLI for Microsoft 365 to add correct permissions for your API:</p> <pre><code>m365 spo serviceprincipal grant add --resource '&lt;aad_app_display_name&gt;' --scope 'user_impersonation'\n</code></pre> </li> <li> <p>Allow your SharePoint domain (ex: https://mycompany.sharepoint.com) as allowed origin in the service or application CORS (Cross-origin resource sharing) settings. Here a procedure for an Azure function.</p> </li> </ol>"},{"location":"usage/data-visualizer/data-sources/odata/#anonymous","title":"Anonymous","text":"<p>You can also call an API endpoint with no specific authentifcation like an Azure HTTP trigger Function with function code. By default, we use the demo OData v4 services provided by https://www.odata.org/odata-services/ to demonstrate the capability.</p>"},{"location":"usage/data-visualizer/data-sources/odata/#set-http-headers-or-body","title":"Set HTTP headers or body","text":"<p>The only method allowed are <code>GET</code> or <code>POST</code>. For each, you have the ability so set your own HTTP headers. The value must be a valid JSON value:</p> <pre><code>{\n\"Content-Type\": \"application/json;odata=verbose\",\n\"Accept\": \"application/json\",\n...\n}\n</code></pre> <p>If you specify a <code>POST</code> request, you can also benefit of builtin tokens.</p> <pre><code>{\n\"ItemsCount\": \"{itemsCountPerPage}\",\n\"MyProperty\": \"My Value\",\n...\n}\n</code></pre>"},{"location":"usage/data-visualizer/data-sources/odata/#sort-settings","title":"Sort settings","text":"<p>Configure the sort settings of the data source. The sort property should be entered manually in the Sort Field. For a particular field, you can define if it should be used for initial sort (i.e. when the results are loaded for the first time) or be only available for users in the sort control (i.e. after the results are loaded). The sort control does not consider default sort fields (i.e. select them by default) and you can only sort on a single field at a time according the fields you defined. If no user sort fields are defined in the configuration, the sort control won't be displayed. The Sort will only work with APIs that use \"orderby\" as the property for sorting. With SharePoint and Microsoft APIs, it will always work as they use \"orderby\" for sorting.</p>"},{"location":"usage/data-visualizer/data-sources/odata/#pagination","title":"Pagination","text":"<p>For each API type, you can control how the results will be paginated in order to improve performances.</p> <p></p>"},{"location":"usage/data-visualizer/data-sources/odata/#dynamic-paging","title":"Dynamic paging","text":"<p>Use a Dynamic paging if the underlying API you are using supports paging mechanisms (likely using <code>$top</code> and <code>$skip</code> or <code>$skipToken</code> tokens, for instance Microsoft Graph or SharePoint REST API).</p>"},{"location":"usage/data-visualizer/data-sources/odata/#use-server-side-paging","title":"Use server-side paging","text":"<p>Some APIs like Microsoft Graph or the SharePoint REST API provide a server-side paging functionality (see https://docs.microsoft.com/en-us/graph/paging for more information). Basically, it allows you to paginate results more easily by using a pre-calculated next page link URL instead of building it manually. </p> <p>If checked, the paging will be based on the <code>@odata.nextLink</code> value from the HTTP response. It means when you will click on the next page button, this value will be used to get the next set of results. Thus, the items count and paging information (i.e first page, current page, next page, previous page, and last page) will be determined automatically as long as you move through pages.</p> <p>If unchecked, it will be your URL to be executed to get the next page results. In this last scenario you likely want to provide a dynamic URL using builtin tokens.</p> <p>Example</p> <ul> <li> <p>With server-side paging enabled using <code>@odata.nextLink</code>:</p> <pre><code>/me/messages?$top={itemsCountPerPage}\nor\n/me/messages?$top=2\n</code></pre> <p>Here, the <code>$skip</code> token will be provided automatically in the <code>@odata.nextLink</code> so you don't have to provide it in the URL.</p> </li> <li> <p>Without server-side paging enabled using <code>$top</code> and <code>$skip</code> tokens:</p> <pre><code>&lt;your_sharepoint_site_url&gt;/_api/lists?$top={itemsCountPerPage}&amp;$skip={startRow}\n</code></pre> <p>If you want to control the paging by yourself, you will have to provide a <code>$skip</code> value manually using builtin tokens. You can use the <code>{itemsCountPerPage}</code> and <code>{startRow}</code> tokens where <code>{startRow}</code> corresponds to the number or items per page * the current page number (start from 0) and <code>{itemsCountPerPage}</code> to the number of items per page configured in the property pane. The URL and the items count will be resolved dynamically based on these token values as long as you move through pages. Because we can't determine the total number of items, in some cases, the last page could be empty. It happens for example when the 'total items count'/'items count per page' is even (i.e. exact same number of items for each page).</p> </li> </ul>"},{"location":"usage/data-visualizer/data-sources/odata/#static-paging","title":"Static paging","text":"<p>If performance is not an issue (i.e for a small ammount of data), you can also set a static paging on your data based on a results array. In this case, you will have to provide the response field to use as the array of items to get the total items count. Then, in the common paging settings, configure the desired number items per page to generate pages dynamically.</p> <p></p> <p>If you use static paging, don't forget to add a fixed count in your url <code>/me/messages?$top=10</code> instead of <code>/me/messages?$top={itemsCountPerPage}</code>. Otherwise, you will get only one page every time.</p>"},{"location":"usage/data-visualizer/data-sources/sharepoint-caml/","title":"Sharepoint caml","text":"<p>The 'SharePoint CAML' data source allows you to rerieve items uisng a CAML query built using the interative builder or using an XML text.</p>"},{"location":"usage/data-visualizer/data-sources/sharepoint-caml/#source-configuration","title":"Source configuration","text":"<p>A CAML query always apply on a SharePoint list or document library. Thus, you must first select one using the following dropdowns:</p> <p></p> Setting Description Default value Site The site collection containing the list or document library By default, it uses the current site collection. However, you can disable the checkmark and search for a specific site. This control uses SharePoint search to get sites looking in the Title and Path managed properties. It means if your sites has been newly created it may not appear immediatly until indexed. Web The web containing the list. It can be the root web of the selected site collecion or an other subsite. '/' (root web) List The list where the CAML query will be applied. None"},{"location":"usage/data-visualizer/data-sources/sharepoint-caml/#caml-query-configuration","title":"CAML Query configuration","text":"<p>To build your CAML query, you have the choice to use the interactive builder or start from scratch using your own XML. See the query schema for CAML to get started.</p>"},{"location":"usage/data-visualizer/data-sources/sharepoint-caml/#using-the-builder","title":"Using the builder","text":"Setting Description Default value View Fields The item fields to return from the. They will be available in your templates with the same name. <ul><li>UniqueId</li><li>EncodedAbsUrl</li><li>FileRef</li><li>File_x0020_Type</li><li>FileLeafRef</li><li>Name</li><li>Author</li><li>Created</li></ul> Search within folders Enable this option if you want to search in folders recursively in your list or document library. False Filters The filter condition builder. From here you can select: <ul><li>Field: the list to apply the condition</li><li>Operator: the operator to use. Supported operators are \"Equals,Does not equal, Is greater than, Is less than, Is grater or equal to, Is less or equal to, Is null, Is not null, Begins with and Contains\".Operator choices are automatically adjusted regarding the selected field type.</li><li>Value: the value to use for the condition. You can use a plain text/date/taxonomy value here (depending of the selected field type) or use a dynamic token. For the second option, enable the corresponding checkbox to have access to the dynamic tokens menu. Notice that not all available tokens are listed here. If the token you want to use is not is the list, you can add it using the 'Custom value' option and press enter. All supported tokens can be found here</li></ul> Sort Configure the sort settings of the data source. The sort property can be selected from the dropdown. For a particular field, you can define if it should be used for initial sort (i.e. when the results are loaded for the first time) or be only available for users in the sort control (i.e. after the results are loaded). The sort control does not consider default sort fields (i.e. select them by default) and you can only sort on a single field at a time according the fields you defined. If no user sort fields are defined in the configuration, the sort control won't be displayed. None."},{"location":"usage/data-visualizer/data-sources/sharepoint-caml/#using-the-advanced-mode","title":"Using the advanced mode","text":"<p>In advanced mode, you are responsible to wrtie your own CAML query as XML text. You can use tokens <code>{&lt;tokenName&gt;}</code> directly in the text to create dynamic queries.</p> <p></p> <p>Tip: to help you get started, you can start writing your query using the builder and then switch to 'Advanced mode'. This way, you will see the underlying generated query. However, from the moment where the CAML query text in advanced mode differ from the one generated by the builder, the builder settings will be lost if you switch back to that mode.</p>"},{"location":"usage/data-visualizer/data-sources/sharepoint-search/","title":"Sharepoint search","text":"<p>The 'SharePoint Search' data source retrieve items from the SharePoint search engine.</p> <p>The SharePoint search is different from the Microsoft Graph search.</p>"},{"location":"usage/data-visualizer/data-sources/sharepoint-search/#source-configuration","title":"Source configuration","text":"Setting Description Default value Query text The input query text to pass to the search engine. This setting is not configurable directly in the data source options. To enable it you use go the the third configuration page of the Web Part and selected either a static or dynamic value (Ex: from a connected search box Web Part). See the connection documentation for more information on how to configure this option. This value can be then used in the Query template using the <code>{searchTerms}</code> token. Also this value can be a Keyword Query Language expression (KQL). None Query template The search query template to use. It allows you to use dynamic tokens according to the context or specifiy conditions that should always apply to the query. <code>{searchTerms}</code> Result source ID Can be either a built-in result source ID listed in the dropdown, or a custom result source that you specify. Type the <code>GUID</code> of the result source, or the <code>SCOPE</code> (Level - SearchObjectLevel enumeration) and <code>NAME</code> (SourceName), separated by <code>|</code> (pipe character). For this to take effect, you must press 'Enter' to save the value. Valid scopes are <code>SPSiteSubscription</code>, <code>SPSite</code>, <code>SPWeb</code>. Examples: <ul><li>SPWeb<code>|</code>Local News</li><li>SPSite<code>|</code>Contracts</li><li>SPSiteSubscription<code>|</code>Intranet</li></ul> LocalSharePointResults Selected properties The SharePoint managed properties to retrieve from the results. They can be used with the same name in layouts and slots afterwards. <ul><li>Title</li><li>Path</li><li>DefaultEncodingURL</li><li>FileType</li><li>HitHighlightedSummary</li><li>AuthorOWSUSER</li><li>owstaxidmetadataalltagsinfo</li><li>Created</li><li>UniqueID</li><li>NormSiteID</li><li>NormListID</li><li>NormUniqueID</li><li>ContentTypeId</li><li>UserName</li><li>JobTitle</li><li>WorkPhone Sort Configure the sort settings of the data source. Properties listed in the dropdown are all static properties marked as 'Sortable' in the SharePoint search schema. However, it does not list all possible RefinableXXX or aliases fields. To use them, you must enter the value manually and press 'Enter' to validate. For a particular field, you can define if it should be used for initial sort (i.e. when the results are loaded for the first time) or be only available for users in the sort control (i.e. after the results are loaded). The sort control does not consider default sort fields (i.e. select them by default) and you can only sort on a single field at a time according the fields you defined. If no user sort fields are defined in the configuration, the sort control won't be displayed. None. Refinement filters The initial refinement filters to apply to the query. Both KQL (Keyword Query Language) and FQL (Fast Query Language) expressions work here (Ex: KQL <code>FileType:docx</code>, FQL: <code>FileType:equals(\"docx\")</code>). They will be apply every time to the current search query regarless selected filters from connected Web Parts. Notice: for strign expressions, use <code>\"</code> isntead of <code>'</code>. None Language of the search request The language to use for the search request. By default the search request will be made using the current user interface language. This parameter is mainly use to process diacritics, plurals, etc. correctly according to the language. Current UI language. Enable query rules Whether or not apply SharePoint query rules. False Include OneDrive for Business results Whether or not include OneDrive for business results. False Enable audience targeting Whether or not results should be targeted according to the audiences that the current user belongs to. More information about modern audiences and how to configure them. False Enable localization If enabled, the Web Part will try to translate the taxonomy term IDs found in result item properties and refinement values to their corresponding label according to the curent UI language. To get it work, you must map a new refinable managed property associated with ows_taxId_ crawled property and turn this toggle 'on':  If enabled and depending how many items are currently displayed, this could be slightly decrease loading performances. To use translated values in your template, you must use the '<code>Auto + &lt;property_name&gt;</code>' property format instead of the original property name. For instance, to use translated values of the 'owstaxidmetadataalltagsinfo' property, you must use the 'Autoowstaxidmetadataalltagsinfo' auto created property. False Enable multi-geo environment If your organization expands its Microsoft 365 presence to multiple geographic regions and/or countries within your existing tenant, you can enable it. Once enabled, the Web Part will include the geo-locations configuration; you can specify an optional list of which geo-locations in the multi-geo tenant to fan the query out. If you don't include this parameter or leave it blank, the query is fanned out to all geo locations.More information about the Search configuration for Microsoft 365 Multi-Geo. False"},{"location":"usage/data-visualizer/data-sources/static-data/","title":"Static data","text":"<p>The 'Static data' is the simplest data source you can use. With this data ssource, items are retrieved from a static JSON object that you define and does not require any asynchronous call.</p> <p></p>"},{"location":"usage/data-visualizer/data-sources/static-data/#when-to-use-this-data-source","title":"When to use this data source?","text":"<p>This data source allows you to define your own data schema (i.e. fields) that you can consume in your template. However, to be consumed by templates, the data must follow this JSON strcuture: </p> <pre><code>{\n\"items\": [\n{\n\"&lt;any_property&gt;\": \"&lt;any_value_of_any_type&gt;\",\n...\n}\n],\n\"&lt;any_other_property&gt;\": \"&lt;any_value_of_any_type&gt;\",\n...\n}\n</code></pre> <p>Don't forget the quotes '\"' for property names.</p> <p>Even if you don't return items, you must specifiy this property. In this case, pass an empty array.</p>"},{"location":"usage/data-visualizer/data-sources/static-data/#how-to-use-this-data-source-a-practical-example","title":"How to use this data source: a practical example","text":"<p>Let say you want to display a static list of useful links for your organization on the home page. Open the code editor and enter the following data:</p> <p></p> <p>The data could be look like this:</p> <pre><code>{\n\"items\": [\n{\n\"linkName\": \"My Company Web Site\",\n\"linkHref\": \"http://mycompany.com\",\n\"linkOpenBehavior\": \"_blank\"\n},\n{\n\"linkName\": \"My Company Web Site\",\n\"linkHref\": \"http://mycompany.com\",\n\"linkOpenBehavior\": \"_blank\"\n}\n],\n\"numberOfLinks\": \"2\"\n}\n</code></pre>"},{"location":"usage/data-visualizer/data-sources/static-data/#static-data-configuration","title":"Static Data Configuration","text":"Setting Description Default value Sort Configure the sort settings of the data source. The sort property should be entered manually in the Sort Field. For a particular field, you can define if it should be used for initial sort (i.e. when the results are loaded for the first time) or be only available for users in the sort control (i.e. after the results are loaded). The sort control does not consider default sort fields (i.e. select them by default) and you can only sort on a single field at a time according the fields you defined. If no user sort fields are defined in the configuration, the sort control won't be displayed. The Sort will work for 'Text' and 'Number' fields only. None. <p>Now to consume this data, you can either start from an existing layout, or use a custom one. See the templating documentation to know more.</p>"},{"location":"usage/data-visualizer/layouts/","title":"Layouts","text":""},{"location":"usage/data-visualizer/layouts/#builtin-layouts","title":"Builtin layouts","text":"<p>By default, the following layouts are provided:</p> <p></p> <p>Be careful, when you switch the layout in the property pane, all the previous layout properties are lost. We do this to avoid polluting the Web Part property bag with multiple useless configurations.</p>"},{"location":"usage/data-visualizer/layouts/#cards","title":"Cards","text":"<p>The 'cards' layout allows you to display items as tiles, just like the native 'Highlighted Content' SharePoint Web Part.</p> <p></p> Setting Description Default value Manage card fields Allows you to define you own values for card placeholder fields. By default, the document card fields come with predefined mappings but you can set your own.<p></p> As a field value, you can choose either a field property value (from the list or as free text) and without any transformation or use an Handlebars expression by clicking on the checkbox next to it. In this case, all helpers from the main template are available. Also, if the field doesn't have the 'Allow HTML' indication flag enabled, it means the value will be always interpreted as text, regardless if you set an HTML value. Otherwise, your value will be interpreted as HTML for those fields (ex: 'Location' and 'Tags' placeholder fields). For HTML fields you can use the special variable <code>@root.theme</code> to use theme colors (ex: <code>@root.theme.palette.themePrimary</code>) or <code>@root.slots.&lt;SlotName&gt;</code> to access slot value. If you don't set a value for those fields (i.e an empty value), they won't appear in the UI:<p></p>. Enable result preview If enabled, display a callout with an interactive preview of the document based on the value specified value for the <code>PreviewUrl</code> current data source slot. <p></p> False Show file icon Hide or display the file icon for the result card. The file icon is determined using the <code>FileType</code> slot. True Compact mode Display cards as compact. False Preferred number of cards per row Specifiy the preferred number of cards to display per row when the required width space is available. The Web Part will always adjust the number of possible tiles to display depending the available width. It means that if you set this value to '3' but you display the Web Part in small column, only 1 tile will be displayed. 3."},{"location":"usage/data-visualizer/layouts/#details-list","title":"Details List","text":"<p>The 'details list' layout allows you to display items as a structured list, the same way as a SharePoint document library or list.</p> <p> </p> Setting Description Default value Manage columns Allows you to build you own table view by adding or removing columns dynamically. For each column, you get the following options:<p></p><ul><li>Sort order: the order of the column in the table.</li><li>Column name: the column friendly name to display.</li><li>Column value: you can choose here either a field from the data source current results set (from the list or as free text) without any transformation or use an Handlebars expression by clicking on the checkbox next to it. In this case, all Handlebars helpers from the main template are available and you can also add you own HTML markup in the column value. For HTML fields you can use the special variable <code>@root.theme</code> to use theme colors (ex: <code>@root.theme.palette.themePrimary</code>).You can specify a different field for sorting when using an Handlebars expression by specifying the field from the separate dropdown.</li><li>Minimum width in px: the minimum width of the column in pixels.</li><li>Maximum width in px: the maximum width of the column in pixels.</li><li>Sortable: allows you to sort column values according to the data source sort settings. It means you must first configure the sort setting at data source level with option 'User sort' to <code>true</code> to see them in the details list columns configuration. Sort is perfromed one column at a time.</li><li>Resizable: allows you to resize the column dynamically in display mode.</li><li>Multiline: if the column column should be multiline. By default only ellipsis (...) will be display for larger text.</li></ul> Show file icon Hide or display the file icon in the first column. Compact mode Display the details list in compact mode."},{"location":"usage/data-visualizer/layouts/#slider","title":"Slider","text":"<p>The 'slider' layout allows you to display data as as dynamic slider (i.e caroussel).</p> <p> </p> Setting Description Default value Auto play If enabled, slides move automatically every X seconds. True Auto play duration Move elements every X seconds. 3 seconds. Pause on hover If enabled, pause the slider on mouse hover. True Number of elements to group together in slides Groups cells together in slides. 3. Show page dots Enable or disable slider navigation. You can adjust the dots position by updating the <code>.flickity-page-dots</code> CSS class. True Infinite scrolling Enable or disable infinite scrolling on the carousel. False Slide height (in px) Dynamically set the slides height to adjust your results. 360px. Slide width (in px) Dynamically set the slides width to adjust your results. 318px."},{"location":"usage/data-visualizer/layouts/#simple-list","title":"Simple list","text":"<p>The 'simple list' layout display items as a simple list with larger rows, like a search engine results display.</p> <p> </p> Setting Description Default value Show file icon Hide or display the file icon for the result card. The file icon is determined using the <code>FileType</code> slot. True Show thumbnail If enabled, display a thumbnail for the itme + a callout with an interactive preview of the document on click based on the value specified value for the <code>PreviewUrl</code> current data source slot. <p></p> False"},{"location":"usage/data-visualizer/layouts/#people","title":"People","text":"<p>The 'people' layout display a list of persons with additional information. Typically, this layout is well suited for a people directory.</p> <p></p> <p>By default, the user profile pictures are fetched from the SharePoint User Profile Service. If your user pictures are stored in Active Directoy, make sure you synchronized them with SharePoint User Profile Service. Otherwise, a placeholder image will be displayed.</p> Setting Description Default value Manage people fields Allows you to define you own values for people placeholder fields. <p></p>As a field value, you can choose either a field property value (from the list or as free text) and without any transformation or use an Handlebars expression by clicking on the checkbox next to it. In this case, all helpers from the main template are available. Also, if the field doesn't have the 'Allow HTML' indication flag enabled, it means the value will be always interpreted as text, regardless if you set an HTML value. Otherwise, your value will be interpreted as HTML for those fields (ex: 'Primary text' placeholder field). For HTML fields you can use the special variable <code>@root.theme</code> to use theme colors (ex: <code>@root.theme.palette.themePrimary</code>) or <code>@root.slots.&lt;SlotName&gt;</code> to access slot value. If you don't set a value for those fields (i.e an empty value), they won't appear in the UI. Show persona card on hover If enabled, show a person card on hover for the current item. <p></p> This feature uses Microsoft Graph and Microsoft Graph Toolkit to display information about the user and needs the following API permissions in your tenant to work: <ul><li>User.Read</li><li>People.Read</li><li>Contacts.Read</li><li>User.ReadBasic.All</li></ul>If these permissions are not set, the card won't appear. You can use CLI for Microsoft 365 to add correct permissions for this feature:<code>o365$ spo serviceprincipal grant add --resource '&lt;aad_app_display_name&gt;' --scope 'user_impersonation'</code>. Refer to the section below about persona hover card customization. Component size The size of the person item (not only the picture). The more the size is and the more information will be displayed for each item and vice versa."},{"location":"usage/data-visualizer/layouts/#persona-hover-card","title":"Persona hover card","text":"<p>Activating this option may slightly reduce loading performances because the user information are fecthed individually for each user (i.e result). This option shouldn't be used with large page count.</p>"},{"location":"usage/data-visualizer/layouts/#microsoft-graph-toolkit","title":"Microsoft Graph Toolkit","text":"<p>The hover card uses Microsoft Graph Toolkit. This means you can add additional information providing your own template like this:</p> <p><pre><code>&lt;mgt-person-card inherit-details&gt;\n    &lt;template data-type=\"additional-details\"&gt;\n    &lt;h3&gt;Stuffed Animal Friends:&lt;/h3&gt;\n    &lt;ul&gt;\n        &lt;li&gt;Giraffe&lt;/li&gt;\n        &lt;li&gt;lion&lt;/li&gt;\n        &lt;li&gt;Rabbit&lt;/li&gt;\n    &lt;/ul&gt;\n    &lt;/template&gt;\n&lt;/mgt-person-card&gt;\n</code></pre> More information here.</p>"},{"location":"usage/data-visualizer/layouts/#teams","title":"Teams","text":"<p>The Teams layout can be used to display information about Microsoft Teams teams and Microsoft 365 groups:</p> <p></p> Setting Description Default value Data source fields The data source to display as tags. The order you select fields will determine the display order.  This option can be usefull if, for instance, you set custom Microsoft schema extensions on your Microsoft 365 groups None <p>Despite you can use this layout with any data, the 'teams' layout is firstly designed to be paired with a data source retrieving these relevant informations. That's why we suggest to use this layout and the OData &amp; Microsoft Graph data source with the following Microsoft Graph URLs and configurations:</p> <p>Only teams where the current user is a member</p> URLHTTP HeadersPermissions <p><code>https://graph.microsoft.com/beta/me/memberOf/$/microsoft.graph.group?$top={itemsCountPerPage}&amp;$count=true&amp;$select=id,displayName,description,visibility&amp;$filter=resourceProvisioningOptions/Any(x:x eq 'Team')</code></p> <pre><code>{\n\"Content-Type\": \"application/json;odata=verbose\",\n\"Accept\": \"application/json\",\n\"ConsistencyLevel\": \"eventual\"\n}\n</code></pre> <ul> <li>User.Read</li> <li>GroupMember.Read.All (to list owners and members in the team panel)</li> <li>Channel.ReadBasic.All (to list channels in the team panel)</li> </ul> <p>All Microsoft 365 groups (with or without Teams, public/private)</p> URLHTTP HeadersPermissions <p><code>https://graph.microsoft.com/v1.0/groups</code></p> <pre><code>{\n\"Content-Type\": \"application/json;odata=verbose\",\n\"Accept\": \"application/json\",\n{\n\"ConsistencyLevel\": \"eventual\"\n}\n}\n</code></pre> <ul> <li>GroupRead.All</li> <li>GroupMember.Read.All (to list owners and members in the team panel)</li> <li>Channel.ReadBasic.All (to list channels in the team panel)</li> </ul> <p>These URLs can also be enhanced using adaptive expressions to build a dynamic query depending the context (ex: selected filters, search box keywords, etc.). </p> <p>Groups with a display name or description that contains with a keyword from the search box including a count of returned objects</p> URLHTTP HeadersPermissions <p><code>https://graph.microsoft.com/v1.0/groups?${if(empty(\"{inputQueryText}\"),'','&amp;$search=\"displayName:{inputQueryText}\" OR \"description:{inputQueryText}\"')}&amp;$count=true&amp;$top={itemsCountPerPage}&amp;$orderby=displayName</code></p> <pre><code>{\n\"Content-Type\": \"application/json;odata=verbose\",\n\"Accept\": \"application/json\",\n\"ConsistencyLevel\": \"eventual\"\n}\n</code></pre> <ul> <li>GroupRead.All</li> <li>GroupMember.Read.All (to list owners and members in the team panel)</li> <li>Channel.ReadBasic.All (to list channels in the team panel)      </li> </ul> <p>See also the \"Build a teams search app using aequos MDV, Microsoft Graph extensions and SharePoint taxonomy\" on how you can leverage this capability with SharePoint taxonomy filters.</p> <p>This URL require the <code>\"ConsistencyLevel\": \"eventual\"</code> HTTP header to be set in the OData data source configuration:</p> <p></p> <p>This layout uses the following data source slots by defaut:</p> <p></p> Setting Description Default value <code>TeamId</code> The Microsoft 365 or Microsoft Teams team id. This information is used by the layout to get additional information about the team (ex: channels, member, owners) <code>id</code> <code>TeamVisibility</code> The team visiblity (public/private). Leave this field empty if you don't want to display visibility <code>visiblity</code> <p>This layout displays now the information about archive status of a Team. The information is visible with this icon </p> <p></p>"},{"location":"usage/data-visualizer/layouts/#debug","title":"Debug","text":"<p>The 'debug' layout allows you to see all relevant data used by layout templates or data sources during render.</p> <p> </p> <p>The template context object exposes the following properties:</p> <pre><code>\"paging\": {\n\"currentPageNumber\": \"&lt;The current selected page number&gt;\"\n},\n\"filters\": {\n\"selectedFilters\": \"&lt;List of currently selected filters&gt;\",\n\"filterOperator\": \"&lt;Operator to use between filters&gt;\",\n\"instanceId\": \"&lt;The connected Data Filters Web Part instance ID&gt;\",\n\"filtersConfiguration\": \"&lt;The filters configuration&gt;\"\n},\n\"inputQueryText\": \"&lt;The current input query text (Ex: search box text)&gt;\",\n\"slots\": \"&lt;Hashtable of configured slots for the current data source. Usage: {{slot item @root.slots}} &gt;\",\n\"theme\": \"&lt;Current theme variables&gt;\",\n\"properties\": \"&lt;Web Part properties from property bag&gt;\",\n\"context\": {\n\"site\": \"&lt;Contextual information for the SharePoint site collection that is hosting the page&gt;\",\n\"web\": \"&lt;Contextual information for the SharePoint web that is hosting the page&gt;\",\n\"list\" :\"&lt;Contextual information for the SharePoint list that is hosting the page&gt;\",\n\"listItem\":\"&lt;Contextual information for the SharePoint list item that is hosting the page&gt;\",\n\"cultureInfo\":\"&lt;It provides culture info for the current user of the application&gt;\",\n\"user\":\"&lt;It provides contextual information for the SharePoint user that is accessing the page&gt;\"\n},\n\"data\": \"&lt;The data source data&gt;\",\n\"instanceId\": \"&lt;The Web Part instance ID&gt;\",\n\"utils\": {\n\"defaultImage\": \"&lt;The default image content to display when no thummbnail is available (Base64)&gt;\"\n}\n</code></pre>"},{"location":"usage/data-visualizer/layouts/#custom","title":"Custom","text":"<p>The 'custom' layout is the minimal layout to start with if you want to create your own customized UI from scratch. You can also start from an existing layout.</p> <p> </p> <p>Updating a builtin layout (ex: 'Cards', 'Detail List', etc.) will automatically switch the selected layout to 'Custom' with your modifications as content. All previous custom layout content will be overwritten.</p> <p> </p> <p>You have also the ability to use an external .html file to centralize your customizations. This file must be stored in an accessible location for uses (ex: a SharePoint document library with 'Read' permissions for concerned users).</p> <p> </p> <p>Unless you specify an external file, the template content is stored in the Web Part property bag.</p> <p>Updating the layout HTML template is a good option for minor UI updates (Ex: add a link, update colors, etc.). For more control over the UI, you may want to use the extensibility library feature.</p>"},{"location":"usage/data-visualizer/layouts/#common-settings","title":"Common settings","text":"<p>For all layouts, some common settings are available:</p> <p></p> Setting Description Default value Show a 'See all' link Allows you to specify a 'See all' link at the top right of the Web Part along the Web Part title. You can set the text that will appear plus the link to use. Tokens are supported in the link URL. <p></p> Disabled Hide this web part if there's nothing to show If there is no results, the Web Part will remain blank in display mode (title and 'See all' link included). In edit mode, you will see a message indicating there is no results. <p></p> Disabled Show results count Hide or display the results count for the current query. Enabled Use Microsoft Graph Toolkit Enable or disable the Microsoft Graph Toolkit to be used in Handlebars template. Refer to the MGT documentation to see available components."},{"location":"usage/data-visualizer/layouts/#result-types","title":"Result types","text":"<p>The result types feature gives you the ability to apply a conditional rendering at item level according to data source field values.</p> <p></p> <p>Not all layouts support the result types feature (ex: Details lsit and slider layouts).</p> <p>Example</p> <p>Given the following conditions, we apply a border with a specific color for each: </p> <p></p> <p></p> <p>The result would be like this:</p> <p></p> <p>The following operators are supported:</p> <ul> <li>Equals</li> <li>Not equals</li> <li>Contains</li> <li>StartsWith</li> <li>Greater Or Equal</li> <li>Less Or Equal</li> <li>Less than</li> <li>Greater than</li> <li>Is not null</li> </ul> <p>In the case you use a custom template, you can still benefit from this feature following this markup:</p> <pre><code>{{#&gt; resultTypes}}\n  {{!-- The block below will be used as default item template if no result types matched --}}\n  &lt;div class=\"template_result\"&gt;\n      &lt;!-- Your default template markup --&gt;\n  &lt;/div&gt;\n{{/resultTypes}}\n</code></pre> <p>Handlebars partials are used behind the scenes and conditions are built dynamically using a recursive if/else structure.</p>"},{"location":"usage/data-visualizer/layouts/cards/","title":"Cards","text":"<p>The 'cards' layout allows you to display items as tiles, just like the native 'Highlighted Content' SharePoint Web Part.</p> <p></p> Setting Description Default value Manage card fields Allows you to define you own values for card placeholder fields. By default, the document card fields come with predefined mappings but you can set your own.<p></p> As a field value, you can choose either a field property value (from the list or as free text) and without any transformation or use an Handlebars expression by clicking on the checkbox next to it. In this case, all helpers from the main template are available. Also, if the field doesn't have the 'Allow HTML' indication flag enabled, it means the value will be always interpreted as text, regardless if you set an HTML value. Otherwise, your value will be interpreted as HTML for those fields (ex: 'Location' and 'Tags' placeholder fields). For HTML fields you can use the special variable <code>@root.theme</code> to use theme colors (ex: <code>@root.theme.palette.themePrimary</code>) or <code>@root.slots.&lt;SlotName&gt;</code> to access slot value. If you don't set a value for those fields (i.e an empty value), they won't appear in the UI:<p></p>. Enable result preview If enabled, display a callout with an interactive preview of the document based on the value specified value for the <code>PreviewUrl</code> current data source slot. <p></p> False Show file icon Hide or display the file icon for the result card. The file icon is determined using the <code>FileType</code> slot. True Compact mode Display cards as compact. False Preferred number of cards per row Specifiy the preferred number of cards to display per row when the required width space is available. The Web Part will always adjust the number of possible tiles to display depending the available width. It means that if you set this value to '3' but you display the Web Part in small column, only 1 tile will be displayed. 3."},{"location":"usage/data-visualizer/layouts/custom/","title":"Custom","text":"<p>The 'custom' layout is the minimal layout to start with if you want to create your own customized UI from scratch. You can also start from an existing layout.</p> <p> </p> <p>Updating a builtin layout (ex: 'Cards', 'Detail List', etc.) will automatically switch the selected layout to 'Custom' with your modifications as content. All previous custom layout content will be overwritten.</p> <p> </p> <p>You have also the ability to use an external .html file to centralize your customizations. This file must be stored in an accessible location for uses (ex: a SharePoint document library with 'Read' permissions for concerned users).</p> <p> </p> <p>Unless you specify an external file, the template content is stored in the Web Part property bag.</p> <p>Updating the layout HTML template is a good option for minor UI updates (Ex: add a link, update colors, etc.). For more control over the UI, you may want to use the extensibility library feature.</p>"},{"location":"usage/data-visualizer/layouts/debug/","title":"Debug","text":"<p>The 'debug' layout allows you to see all relevant data used by layout templates or data sources during render.</p> <p> </p> <p>The template context object exposes the following properties:</p> <pre><code>\"paging\": {\n\"currentPageNumber\": \"&lt;The current selected page number&gt;\"\n},\n\"filters\": {\n\"selectedFilters\": \"&lt;List of currently selected filters&gt;\",\n\"filterOperator\": \"&lt;Operator to use between filters&gt;\",\n\"instanceId\": \"&lt;The connected Data Filters Web Part instance ID&gt;\",\n\"filtersConfiguration\": \"&lt;The filters configuration&gt;\"\n},\n\"inputQueryText\": \"&lt;The current input query text (Ex: search box text)&gt;\",\n\"slots\": \"&lt;Hashtable of configured slots for the current data source. Usage: {{slot item @root.slots}} &gt;\",\n\"theme\": \"&lt;Current theme variables&gt;\",\n\"properties\": \"&lt;Web Part properties from property bag&gt;\",\n\"context\": {\n\"site\": \"&lt;Contextual information for the SharePoint site collection that is hosting the page&gt;\",\n\"web\": \"&lt;Contextual information for the SharePoint web that is hosting the page&gt;\",\n\"list\" :\"&lt;Contextual information for the SharePoint list that is hosting the page&gt;\",\n\"listItem\":\"&lt;Contextual information for the SharePoint list item that is hosting the page&gt;\",\n\"cultureInfo\":\"&lt;It provides culture info for the current user of the application&gt;\",\n\"user\":\"&lt;It provides contextual information for the SharePoint user that is accessing the page&gt;\"\n},\n\"data\": \"&lt;The data source data&gt;\",\n\"instanceId\": \"&lt;The Web Part instance ID&gt;\",\n\"utils\": {\n\"defaultImage\": \"&lt;The default image content to display when no thummbnail is available (Base64)&gt;\"\n}\n</code></pre>"},{"location":"usage/data-visualizer/layouts/details-list/","title":"Details list","text":"<p>The 'details list' layout allows you to display items as a structured list, the same way as a SharePoint document library or list.</p> <p> </p> Setting Description Default value Manage columns Allows you to build you own table view by adding or removing columns dynamically. For each column, you get the following options:<p></p><ul><li>Sort order: the order of the column in the table.</li><li>Column name: the column friendly name to display.</li><li>Column value: you can choose here either a field from the data source current results set (from the list or as free text) without any transformation or use an Handlebars expression by clicking on the checkbox next to it. In this case, all Handlebars helpers from the main template are available and you can also add you own HTML markup in the column value. For HTML fields you can use the special variable <code>@root.theme</code> to use theme colors (ex: <code>@root.theme.palette.themePrimary</code>).You can specify a different field for sorting when using an Handlebars expression by specifying the field from the separate dropdown.</li><li>Minimum width in px: the minimum width of the column in pixels.</li><li>Maximum width in px: the maximum width of the column in pixels.</li><li>Sortable: allows you to sort column values according to the data source sort settings. It means you must first configure the sort setting at data source level with option 'User sort' to <code>true</code> to see them in the details list columns configuration. Sort is perfromed one column at a time.</li><li>Resizable: allows you to resize the column dynamically in display mode.</li><li>Multiline: if the column column should be multiline. By default only ellipsis (...) will be display for larger text.</li></ul> Show file icon Hide or display the file icon in the first column. Compact mode Display the details list in compact mode."},{"location":"usage/data-visualizer/layouts/people/","title":"People","text":"<p>The 'people' layout display a list of persons with additional information. Typically, this layout is well suited for a people directory.</p> <p></p> <p>By default, the user profile pictures are fetched from the SharePoint User Profile Service. If your user pictures are stored in Active Directoy, make sure you synchronized them with SharePoint User Profile Service. Otherwise, a placeholder image will be displayed.</p> Setting Description Default value Manage people fields Allows you to define you own values for people placeholder fields. <p></p>As a field value, you can choose either a field property value (from the list or as free text) and without any transformation or use an Handlebars expression by clicking on the checkbox next to it. In this case, all helpers from the main template are available. Also, if the field doesn't have the 'Allow HTML' indication flag enabled, it means the value will be always interpreted as text, regardless if you set an HTML value. Otherwise, your value will be interpreted as HTML for those fields (ex: 'Primary text' placeholder field). For HTML fields you can use the special variable <code>@root.theme</code> to use theme colors (ex: <code>@root.theme.palette.themePrimary</code>) or <code>@root.slots.&lt;SlotName&gt;</code> to access slot value. If you don't set a value for those fields (i.e an empty value), they won't appear in the UI. Show persona card on hover If enabled, show a person card on hover for the current item. <p></p> This feature uses Microsoft Graph and Microsoft Graph Toolkit to display information about the user and needs the following API permissions in your tenant to work: <ul><li>User.Read</li><li>People.Read</li><li>Contacts.Read</li><li>User.ReadBasic.All</li></ul>If these permissions are not set, the card won't appear. You can use CLI for Microsoft 365 to add correct permissions for this feature:<code>o365$ spo serviceprincipal grant add --resource '&lt;aad_app_display_name&gt;' --scope 'user_impersonation'</code>. Refer to the section below about persona hover card customization. Component size The size of the person item (not only the picture). The more the size is and the more information will be displayed for each item and vice versa."},{"location":"usage/data-visualizer/layouts/people/#persona-hover-card","title":"Persona hover card","text":"<p>Activating this option may slightly reduce loading performances because the user information are fecthed individually for each user (i.e result). This option shouldn't be used with large page count.</p>"},{"location":"usage/data-visualizer/layouts/people/#microsoft-graph-toolkit","title":"Microsoft Graph Toolkit","text":"<p>The hover card uses Microsoft Graph Toolkit. This means you can add additional information providing your own template like this:</p> <p><pre><code>&lt;mgt-person-card inherit-details&gt;\n    &lt;template data-type=\"additional-details\"&gt;\n    &lt;h3&gt;Stuffed Animal Friends:&lt;/h3&gt;\n    &lt;ul&gt;\n        &lt;li&gt;Giraffe&lt;/li&gt;\n        &lt;li&gt;lion&lt;/li&gt;\n        &lt;li&gt;Rabbit&lt;/li&gt;\n    &lt;/ul&gt;\n    &lt;/template&gt;\n&lt;/mgt-person-card&gt;\n</code></pre> More information here.</p>"},{"location":"usage/data-visualizer/layouts/simple-list/","title":"Simple list","text":"<p>The 'simple list' layout display items as a simple list with larger rows, like a search engine results display.</p> <p> </p> Setting Description Default value Show file icon Hide or display the file icon for the result card. The file icon is determined using the <code>FileType</code> slot. True Show thumbnail If enabled, display a thumbnail for the itme + a callout with an interactive preview of the document on click based on the value specified value for the <code>PreviewUrl</code> current data source slot. <p></p> False"},{"location":"usage/data-visualizer/layouts/slider/","title":"Slider","text":"<p>The 'slider' layout allows you to display data as as dynamic slider (i.e caroussel).</p> <p> </p> Setting Description Default value Auto play If enabled, slides move automatically every X seconds. True Auto play duration Move elements every X seconds. 3 seconds. Pause on hover If enabled, pause the slider on mouse hover. True Number of elements to group together in slides Groups cells together in slides. 3. Show page dots Enable or disable slider navigation. You can adjust the dots position by updating the <code>.flickity-page-dots</code> CSS class. True Infinite scrolling Enable or disable infinite scrolling on the carousel. False Slide height (in px) Dynamically set the slides height to adjust your results. 360px. Slide width (in px) Dynamically set the slides width to adjust your results. 318px."},{"location":"usage/data-visualizer/layouts/teams/","title":"Teams","text":"<p>The Teams layout can be used to display information about Microsoft Teams teams and Microsoft 365 groups:</p> <p></p> Setting Description Default value Data source fields The data source to display as tags. The order you select fields will determine the display order.  This option can be usefull if, for instance, you set custom Microsoft schema extensions on your Microsoft 365 groups None <p>Despite you can use this layout with any data, the 'teams' layout is firstly designed to be paired with a data source retrieving these relevant informations. That's why we suggest to use this layout and the OData &amp; Microsoft Graph data source with the following Microsoft Graph URLs and configurations:</p> <p>Only teams where the current user is a member</p> URLHTTP HeadersPermissions <p><code>https://graph.microsoft.com/beta/me/memberOf/$/microsoft.graph.group?$top={itemsCountPerPage}&amp;$count=true&amp;$select=id,displayName,description,visibility&amp;$filter=resourceProvisioningOptions/Any(x:x eq 'Team')</code></p> <pre><code>{\n\"Content-Type\": \"application/json;odata=verbose\",\n\"Accept\": \"application/json\",\n\"ConsistencyLevel\": \"eventual\"\n}\n</code></pre> <ul> <li>User.Read</li> <li>GroupMember.Read.All (to list owners and members in the team panel)</li> <li>Channel.ReadBasic.All (to list channels in the team panel)</li> </ul> <p>All Microsoft 365 groups (with or without Teams, public/private)</p> URLHTTP HeadersPermissions <p><code>https://graph.microsoft.com/v1.0/groups</code></p> <pre><code>{\n\"Content-Type\": \"application/json;odata=verbose\",\n\"Accept\": \"application/json\",\n{\n\"ConsistencyLevel\": \"eventual\"\n}\n}\n</code></pre> <ul> <li>GroupRead.All</li> <li>GroupMember.Read.All (to list owners and members in the team panel)</li> <li>Channel.ReadBasic.All (to list channels in the team panel)</li> </ul> <p>These URLs can also be enhanced using adaptive expressions to build a dynamic query depending the context (ex: selected filters, search box keywords, etc.). </p> <p>Groups with a display name or description that contains with a keyword from the search box including a count of returned objects</p> URLHTTP HeadersPermissions <p><code>https://graph.microsoft.com/v1.0/groups?${if(empty(\"{inputQueryText}\"),'','&amp;$search=\"displayName:{inputQueryText}\" OR \"description:{inputQueryText}\"')}&amp;$count=true&amp;$top={itemsCountPerPage}&amp;$orderby=displayName</code></p> <pre><code>{\n\"Content-Type\": \"application/json;odata=verbose\",\n\"Accept\": \"application/json\",\n\"ConsistencyLevel\": \"eventual\"\n}\n</code></pre> <ul> <li>GroupRead.All</li> <li>GroupMember.Read.All (to list owners and members in the team panel)</li> <li>Channel.ReadBasic.All (to list channels in the team panel)      </li> </ul> <p>See also the \"Build a teams search app using aequos MDV, Microsoft Graph extensions and SharePoint taxonomy\" on how you can leverage this capability with SharePoint taxonomy filters.</p> <p>This URL require the <code>\"ConsistencyLevel\": \"eventual\"</code> HTTP header to be set in the OData data source configuration:</p> <p></p> <p>This layout uses the following data source slots by defaut:</p> <p></p> Setting Description Default value <code>TeamId</code> The Microsoft 365 or Microsoft Teams team id. This information is used by the layout to get additional information about the team (ex: channels, member, owners) <code>id</code> <code>TeamVisibility</code> The team visiblity (public/private). Leave this field empty if you don't want to display visibility <code>visiblity</code> <p>This layout displays now the information about archive status of a Team. The information is visible with this icon </p> <p></p>"},{"location":"usage/data-visualizer/layouts/templating/","title":"Templating","text":""},{"location":"usage/data-visualizer/layouts/templating/#preview-behavior","title":"Preview behavior","text":""},{"location":"usage/data-visualizer/layouts/templating/#light-updates","title":"Light updates","text":""},{"location":"usage/data-visualizer/layouts/templating/#advanced-updates","title":"Advanced updates","text":""},{"location":"usage/group-metadata-editor/","title":"Group Metadata Editor","text":"<p>This Web Part is available since the <code>1.4.0</code> version.</p> <p>The 'Group/Team metadata editor' Web Part allows you to tag a specific Microsoft 365 group or team using a custom Microsoft Graph schema extension. This Web Part can be used in a regular SharePoint page or as a team tab in Microsoft Teams with the provided application (see Installation for more information). </p> <p>Although it can be used alone, we designed this Web Part to fully complete the search experience and provide an end-to-end solution with other MDV components when used to build a team search center in Microsoft Teams. See this tutorial to know how you can leverage this component at its full potential.</p> <p></p> <p></p> <p>Note</p> <ul> <li>This Web Part can only be used in a SharePoint team site connected to a Microsoft 365 group and/or in a tab in a Microsoft Teams team. A warning message will be displayed otherwise: </li> </ul> <p></p> <ul> <li>Only an owner of the underlying  Microsoft 365 group can configure schema extension properties.</li> </ul>"},{"location":"usage/group-metadata-editor/#configuration","title":"Configuration","text":"<p>The Microsoft Graph schema extension must be created before using this Web Part. As a tenant administrator, you can use Microsoft Graph explorer and this procedure to create an extension. </p> <p>The Web Part supports the following property data types:</p> <ul> <li><code>String</code></li> <li><code>Integer</code></li> <li><code>DateTime</code></li> <li><code>Boolean</code></li> </ul>"},{"location":"usage/group-metadata-editor/#usage-in-a-sharepoint-site","title":"Usage in a SharePoint site","text":"<ol> <li> <p>In a SharePoint team site connected to a Microsoft 365 group, open or create a new page.</p> </li> <li> <p>Add the \"aequos - Group metadata editor\" Web Part on the page and set the schema extension name.</p> <p></p> </li> </ol>"},{"location":"usage/group-metadata-editor/#usage-in-a-team-in-microsoft-teams","title":"Usage in a team in Microsoft Teams","text":"<ol> <li> <p>On a team channel, add a new tab and click on \"More apps\". If correctly deployed by your administrator, you should see the \"aequos - Team metadata editor\" application listed in your organization applications.</p> <p></p> <p></p> </li> <li> <p>Go through the process to add the application as tab:</p> <p></p> <p></p> <p></p> </li> <li> <p>Configure the component settings the same way as the SharePoint Web Part:</p> <p></p> </li> </ol>"},{"location":"usage/search-box/","title":"Search box Web Part","text":"<p>The 'Search box' Web Part allows users to enter free text search queries connected to a 'Data Visualizer' Web Part.</p> <p></p> <p></p>"},{"location":"usage/search-box/#configuration","title":"Configuration","text":""},{"location":"usage/search-box/#search-box-settings","title":"Search box settings","text":"Setting Description Default value Placeholde text The placeholder text to display in the search box. \"Enter your search terms...\" Send the query to a new page Sends the search query text to a new page. From here you can select the page URL, the open behavior and send method (URL fragment '#' or a query string parameter). The input value can be transformed before sending it to another page. {inputQueryText} is replaced with the value from the search box and other tokens are also supported. False"},{"location":"usage/search-box/#query-suggestions","title":"Query suggestions","text":"<p>The query suggestions allows users to easily find relevant query keywords based on their entry:</p> <p></p> Setting Description Default value Enable query suggestions Enable or disable query suggestions. False Configure available providers Enable or disable the suggestions providers available for this Web Part. By default, only the \"SharePoint Static search suggestions\" is available (disabled by default). <p></p> To add values for this provider, refer to the following documentation (caution: it can take up to 24h for changes to take effect). Multiple providers can be enabled at once. Number of suggestions to show per group The number of suggestions to show per group. 10"},{"location":"usage/search-box/#connections","title":"Connections","text":"<p>Optionally, you can set a default query text coming from an other dynamic data source on the page. For instance, connect the search box to a page environment variable like a query string parameter. The value retrieved from a connected data source will be displayed automatically at page load in the text box if present and broadcasted to any other Web Parts connected to the search box Web Part (ex: a 'Data Visualizer' Web Part) resulting to a cascading effect.</p>"}]}